<!-- index.html -->
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>RTQ – Maths Paper Solution Viewer (Prototype)</title>
  <style>
    :root{
      --bg: #f7f7f7;
      --paper: #ffffff;
      --ink: #111111;
      --muted: #444444;
      --line: #bdbdbd;
      --line-strong: #8f8f8f;
      --shadow: rgba(0,0,0,0.08);
      --focus: #000000;
      --radius: 10px;
      --gap: 16px;
    }

    *{ box-sizing: border-box; }
    html{ scroll-behavior: smooth; }
    body{
      margin: 0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color: var(--ink);
      background: var(--bg);
      line-height: 1.4;
    }

    /* Focus in grayscale */
    :focus-visible{
      outline: 3px solid var(--focus);
      outline-offset: 2px;
    }

    /* Top bar (tablet/mobile) */
    .topbar{
      position: sticky;
      top: 0;
      z-index: 40;
      background: #efefef;
      border-bottom: 1px solid var(--line);
      padding: 10px 12px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .topbar .title{
      font-weight: 700;
      font-size: 14px;
      letter-spacing: 0.2px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .iconbtn{
      appearance: none;
      border: 1px solid var(--line-strong);
      background: #ffffff;
      color: var(--ink);
      border-radius: 8px;
      padding: 8px 10px;
      font-weight: 650;
      cursor: pointer;
    }
    .iconbtn:active{ transform: translateY(1px); }

    /* Layout */
    .app{
      display: block;
      padding: 14px 12px 60px;
      max-width: 1100px;
      margin: 0 auto;
    }

    .layout{
      display: block;
    }

    /* Desktop rail */
    .rail{
      display: none;
    }

    /* Paper */
    .paper{
      background: var(--paper);
      border: 1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: 0 2px 10px var(--shadow);
      padding: 16px;
      overflow: visible; /* ensure no nested scroll */
    }

    .paper-header{
      border-bottom: 1px solid var(--line);
      padding-bottom: 10px;
      margin-bottom: 14px;
    }
    .paper-header h1{
      margin: 0;
      font-size: 18px;
    }
    .paper-header p{
      margin: 6px 0 0;
      color: var(--muted);
      font-size: 13px;
    }

    /* Question blocks */
    .q{
      border: 1px solid var(--line);
      border-radius: var(--radius);
      padding: 14px;
      margin: 14px 0;
      background: #fbfbfb;
    }
    .q .qhead{
      display: flex;
      align-items: baseline;
      justify-content: space-between;
      gap: 10px;
      margin-bottom: 10px;
    }
    .q .qhead h2{
      margin: 0;
      font-size: 16px;
    }
    .q .qmeta{
      color: var(--muted);
      font-size: 12px;
      white-space: nowrap;
    }

    .block{
      border: 1px dashed var(--line-strong);
      border-radius: 10px;
      padding: 12px;
      margin: 10px 0;
      background: #ffffff;
    }
    .block-title{
      margin: 0 0 8px;
      font-weight: 750;
      font-size: 13px;
      letter-spacing: 0.2px;
    }
    .block p{
      margin: 0 0 8px;
    }
    .block p:last-child{ margin-bottom: 0; }

    .answer{
      border-style: solid;
      border-color: var(--line);
    }

    .working{
      border-style: solid;
      border-color: var(--line);
      background: #fdfdfd;
    }

    /* Working toggle row */
    .toggle-row{
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      margin: 0 0 8px;
    }
    .toggle-row .block-title{
      margin: 0;
    }
    .toggle{
      appearance: none;
      border: 1px solid var(--line-strong);
      background: #ffffff;
      color: var(--ink);
      border-radius: 999px;
      padding: 8px 12px;
      font-weight: 700;
      cursor: pointer;
      flex: 0 0 auto;
    }

    /* Collapsed working */
    .working-content[hidden]{ display: none; }
    .working-preview{
      color: var(--muted);
      font-size: 12.5px;
      margin: 0;
    }
    .mathline{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
      font-size: 13px;
      border: 1px solid var(--line);
      border-radius: 8px;
      padding: 8px 10px;
      background: #f3f3f3;
      margin: 6px 0;
      overflow-wrap: anywhere;
    }

    /* Sub-questions */
    .subq{
      border: 1px solid var(--line);
      border-radius: var(--radius);
      padding: 12px;
      margin: 12px 0;
      background: #ffffff;
    }
    .subq h3{
      margin: 0 0 8px;
      font-size: 14px;
    }

    /* Drawer (tablet/mobile nav) */
    .drawer-backdrop{
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.35);
      z-index: 60;
      display: none;
    }
    .drawer-backdrop.open{ display: block; }
    .drawer{
      position: fixed;
      top: 0;
      left: 0;
      width: min(320px, 92vw);
      height: 100%;
      background: #ffffff;
      border-right: 1px solid var(--line);
      box-shadow: 6px 0 18px var(--shadow);
      padding: 12px;
    }
    .drawer h2{
      margin: 6px 0 10px;
      font-size: 14px;
    }
    .drawer .row{
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
    }
    .drawer .close{
      appearance: none;
      border: 1px solid var(--line-strong);
      background: #ffffff;
      border-radius: 8px;
      padding: 7px 10px;
      font-weight: 700;
      cursor: pointer;
    }
    nav ul{
      list-style: none;
      padding: 0;
      margin: 10px 0 0;
      display: grid;
      gap: 6px;
    }
    nav a{
      display: block;
      padding: 10px 10px;
      border: 1px solid var(--line);
      border-radius: 10px;
      text-decoration: none;
      color: var(--ink);
      background: #f7f7f7;
      font-weight: 700;
    }
    nav a:active{ transform: translateY(1px); }
    nav a small{
      display: block;
      color: var(--muted);
      font-weight: 600;
      font-size: 11.5px;
      margin-top: 2px;
    }

    /* Desktop responsive */
    @media (min-width: 900px){
      .topbar{ display: none; }
      .layout{
        display: grid;
        grid-template-columns: 240px 1fr;
        gap: var(--gap);
        align-items: start;
      }
      .rail{
        display: block;
        position: sticky;
        top: 14px;
        align-self: start;
        background: #ffffff;
        border: 1px solid var(--line);
        border-radius: var(--radius);
        box-shadow: 0 2px 10px var(--shadow);
        padding: 12px;
      }
      .rail h2{
        margin: 4px 0 10px;
        font-size: 14px;
      }
      .rail nav a{ background: #ffffff; }
      .drawer-backdrop{ display: none !important; }
    }
  </style>
</head>
<body>
  <!-- Drawer (tablet/mobile) -->
  <div class="drawer-backdrop" id="drawerBackdrop" aria-hidden="true">
    <div class="drawer" role="dialog" aria-modal="true" aria-label="Question navigation">
      <div class="row">
        <h2>Navigation</h2>
        <button class="close" id="drawerClose" type="button">Close</button>
      </div>
      <nav aria-label="Questions (drawer)">
        <ul>
          <li><a href="#q1">Q1 <small>Single part</small></a></li>
          <li><a href="#q2">Q2 <small>Single part</small></a></li>
          <li><a href="#q3">Q3 <small>Multi-part (a–c)</small></a></li>
          <li><a href="#q3a">Q3(a) <small>Sub-question</small></a></li>
          <li><a href="#q3b">Q3(b) <small>Sub-question</small></a></li>
          <li><a href="#q3c">Q3(c) <small>Sub-question (long working)</small></a></li>
          <li><a href="#q4">Q4 <small>Single part</small></a></li>
          <li><a href="#q5">Q5 <small>Single part</small></a></li>
        </ul>
      </nav>
    </div>
  </div>

  <!-- Top bar (tablet/mobile) -->
  <header class="topbar" aria-label="Paper header">
    <button class="iconbtn" id="navToggle" type="button" aria-haspopup="dialog" aria-controls="drawerBackdrop" aria-expanded="false">
      Menu
    </button>
    <div class="title">RTQ – Maths Paper (Continuous Scroll)</div>
  </header>

  <main class="app">
    <div class="layout">
      <!-- Desktop rail -->
      <aside class="rail" aria-label="Question navigation (rail)">
        <h2>Navigation</h2>
        <nav aria-label="Questions (rail)">
          <ul>
            <li><a href="#q1">Q1 <small>Single part</small></a></li>
            <li><a href="#q2">Q2 <small>Single part</small></a></li>
            <li><a href="#q3">Q3 <small>Multi-part (a–c)</small></a></li>
            <li><a href="#q3a">Q3(a) <small>Sub-question</small></a></li>
            <li><a href="#q3b">Q3(b) <small>Sub-question</small></a></li>
            <li><a href="#q3c">Q3(c) <small>Sub-question (long working)</small></a></li>
            <li><a href="#q4">Q4 <small>Single part</small></a></li>
            <li><a href="#q5">Q5 <small>Single part</small></a></li>
          </ul>
        </nav>
      </aside>

      <!-- Paper (single continuous document) -->
      <section class="paper" aria-label="Paper content">
        <div class="paper-header">
          <h1>RTQ – Maths Paper</h1>
          <p>Single continuous document. Question is always visible. Answer is visible by default. Working is collapsed by default.</p>
        </div>

        <!-- Q1 -->
        <article class="q" id="q1" aria-label="Question 1">
          <div class="qhead">
            <h2>Question 1</h2>
            <div class="qmeta">Q1</div>
          </div>

          <div class="block question">
            <p class="block-title">Question</p>
            <p>A toy costs £3. How much do 4 toys cost?</p>
          </div>

          <div class="block answer">
            <p class="block-title">Answer</p>
            <p>£12</p>
          </div>

          <div class="block working">
            <div class="toggle-row">
              <p class="block-title">Working</p>
              <button class="toggle js-working-toggle" type="button"
                aria-expanded="false"
                data-target="q1-working">
                Show working
              </button>
            </div>
            <p class="working-preview">Working is hidden. Use “Show working” to expand inline.</p>
            <div class="working-content" id="q1-working" hidden>
              <p>4 toys × £3 each</p>
              <div class="mathline">KaTeX: \(4 \times 3 = 12\)</div>
              <p>So the total cost is £12.</p>
            </div>
          </div>
        </article>

        <!-- Q2 -->
        <article class="q" id="q2" aria-label="Question 2">
          <div class="qhead">
            <h2>Question 2</h2>
            <div class="qmeta">Q2</div>
          </div>

          <div class="block question">
            <p class="block-title">Question</p>
            <p>Write the next two numbers in the sequence:</p>
            <div class="mathline">5, 10, 15, 20, ___, ___</div>
          </div>

          <div class="block answer">
            <p class="block-title">Answer</p>
            <div class="mathline">25, 30</div>
          </div>

          <div class="block working">
            <div class="toggle-row">
              <p class="block-title">Working</p>
              <button class="toggle js-working-toggle" type="button"
                aria-expanded="false"
                data-target="q2-working">
                Show working
              </button>
            </div>
            <p class="working-preview">Working is hidden. Use “Show working” to expand inline.</p>
            <div class="working-content" id="q2-working" hidden>
              <p>The sequence increases by 5 each time.</p>
              <div class="mathline">KaTeX: \(20 + 5 = 25\)</div>
              <div class="mathline">KaTeX: \(25 + 5 = 30\)</div>
            </div>
          </div>
        </article>

        <!-- Q3 (multi-part) -->
        <article class="q" id="q3" aria-label="Question 3">
          <div class="qhead">
            <h2>Question 3</h2>
            <div class="qmeta">Q3</div>
          </div>

          <div class="block question">
            <p class="block-title">Question</p>
            <p>In this question, you will work with the expression below:</p>
            <div class="mathline">KaTeX: \(2x + 6\)</div>
            <p>(If the original paper has no parent prompt, this area may be empty.)</p>
          </div>

          <!-- Q3(a) -->
          <section class="subq" id="q3a" aria-label="Question 3a">
            <h3>Sub-question 3(a)</h3>

            <div class="block question">
              <p class="block-title">Question</p>
              <p>Find the value of the expression when <span class="mathline" style="display:inline-block;margin:0;padding:2px 6px;">KaTeX: \(x = 4\)</span>.</p>
            </div>

            <div class="block answer">
              <p class="block-title">Answer</p>
              <div class="mathline">KaTeX: \(2(4) + 6 = 14\)</div>
            </div>

            <div class="block working">
              <div class="toggle-row">
                <p class="block-title">Working</p>
                <button class="toggle js-working-toggle" type="button"
                  aria-expanded="false"
                  data-target="q3a-working">
                  Show working
                </button>
              </div>
              <p class="working-preview">Working is hidden. Use “Show working” to expand inline.</p>
              <div class="working-content" id="q3a-working" hidden>
                <div class="mathline">KaTeX: \(2x + 6\)</div>
                <div class="mathline">KaTeX: \(2(4) + 6\)</div>
                <div class="mathline">KaTeX: \(8 + 6 = 14\)</div>
              </div>
            </div>
          </section>

          <!-- Q3(b) -->
          <section class="subq" id="q3b" aria-label="Question 3b">
            <h3>Sub-question 3(b)</h3>

            <div class="block question">
              <p class="block-title">Question</p>
              <p>Simplify the expression:</p>
              <div class="mathline">KaTeX: \(3x + 2x + 6\)</div>
            </div>

            <div class="block answer">
              <p class="block-title">Answer</p>
              <div class="mathline">KaTeX: \(5x + 6\)</div>
            </div>

            <div class="block working">
              <div class="toggle-row">
                <p class="block-title">Working</p>
                <button class="toggle js-working-toggle" type="button"
                  aria-expanded="false"
                  data-target="q3b-working">
                  Show working
                </button>
              </div>
              <p class="working-preview">Working is hidden. Use “Show working” to expand inline.</p>
              <div class="working-content" id="q3b-working" hidden>
                <p>Collect like terms:</p>
                <div class="mathline">KaTeX: \(3x + 2x = 5x\)</div>
                <div class="mathline">KaTeX: \(5x + 6\)</div>
              </div>
            </div>
          </section>

          <!-- Q3(c) (long working example) -->
          <section class="subq" id="q3c" aria-label="Question 3c">
            <h3>Sub-question 3(c)</h3>

            <div class="block question">
              <p class="block-title">Question</p>
              <p>Expand and simplify:</p>
              <div class="mathline">KaTeX: \((x + 3)(x + 3)\)</div>
            </div>

            <div class="block answer">
              <p class="block-title">Answer</p>
              <div class="mathline">KaTeX: \(x^2 + 6x + 9\)</div>
            </div>

            <div class="block working">
              <div class="toggle-row">
                <p class="block-title">Working</p>
                <button class="toggle js-working-toggle" type="button"
                  aria-expanded="false"
                  data-target="q3c-working">
                  Show working
                </button>
              </div>
              <p class="working-preview">Working is hidden (long). Use “Show working” to expand inline.</p>

              <div class="working-content" id="q3c-working" hidden>
                <p>Use expansion (FOIL) and then simplify.</p>

                <!-- Multiple placeholder KaTeX lines (long working) -->
                <div class="mathline">KaTeX: \((x + 3)(x + 3)\)</div>
                <div class="mathline">KaTeX: \(= x(x+3) + 3(x+3)\)</div>
                <div class="mathline">KaTeX: \(= x^2 + 3x + 3x + 9\)</div>
                <div class="mathline">KaTeX: \(= x^2 + 6x + 9\)</div>

                <div class="mathline">KaTeX: (placeholder) \(x^2 + 6x + 9\)</div>
                <div class="mathline">KaTeX: (placeholder) \(\frac{(x+3)^2}{1}\)</div>
                <div class="mathline">KaTeX: (placeholder) \(x^2 + 2\cdot x \cdot 3 + 3^2\)</div>
                <div class="mathline">KaTeX: (placeholder) \(x^2 + 6x + 9\)</div>
                <div class="mathline">KaTeX: (placeholder) \(x^2 + 6x + 9\)</div>

                <p>Final simplified expression matches the answer.</p>
              </div>
            </div>
          </section>
        </article>

        <!-- Q4 -->
        <article class="q" id="q4" aria-label="Question 4">
          <div class="qhead">
            <h2>Question 4</h2>
            <div class="qmeta">Q4</div>
          </div>

          <div class="block question">
            <p class="block-title">Question</p>
            <p>A rectangle has length 8 cm and width 3 cm. Find its area.</p>
          </div>

          <div class="block answer">
            <p class="block-title">Answer</p>
            <div class="mathline">KaTeX: \(8 \times 3 = 24\)</div>
            <p>24 cm²</p>
          </div>

          <div class="block working">
            <div class="toggle-row">
              <p class="block-title">Working</p>
              <button class="toggle js-working-toggle" type="button"
                aria-expanded="false"
                data-target="q4-working">
                Show working
              </button>
            </div>
            <p class="working-preview">Working is hidden. Use “Show working” to expand inline.</p>
            <div class="working-content" id="q4-working" hidden>
              <p>Area = length × width</p>
              <div class="mathline">KaTeX: \(A = 8 \times 3\)</div>
              <div class="mathline">KaTeX: \(A = 24\)</div>
              <p>So the area is 24 cm².</p>
            </div>
          </div>
        </article>

        <!-- Q5 -->
        <article class="q" id="q5" aria-label="Question 5">
          <div class="qhead">
            <h2>Question 5</h2>
            <div class="qmeta">Q5</div>
          </div>

          <div class="block question">
            <p class="block-title">Question</p>
            <p>A bag contains 3 red balls and 2 blue balls. How many balls are there in total?</p>
          </div>

          <div class="block answer">
            <p class="block-title">Answer</p>
            <div class="mathline">KaTeX: \(3 + 2 = 5\)</div>
            <p>5 balls</p>
          </div>

          <div class="block working">
            <div class="toggle-row">
              <p class="block-title">Working</p>
              <button class="toggle js-working-toggle" type="button"
                aria-expanded="false"
                data-target="q5-working">
                Show working
              </button>
            </div>
            <p class="working-preview">Working is hidden. Use “Show working” to expand inline.</p>
            <div class="working-content" id="q5-working" hidden>
              <p>Add the number of red balls and blue balls.</p>
              <div class="mathline">KaTeX: \(3 + 2 = 5\)</div>
            </div>
          </div>
        </article>

      </section>
    </div>
  </main>

  <script>
    (function(){
      const toggles = document.querySelectorAll('.js-working-toggle');
      toggles.forEach(btn => {
        const targetId = btn.getAttribute('data-target');
        const panel = document.getElementById(targetId);
        if (!panel) return;

        // Ensure default is collapsed
        btn.setAttribute('aria-expanded', 'false');
        panel.hidden = true;
        btn.textContent = 'Show working';

        btn.addEventListener('click', () => {
          const expanded = btn.getAttribute('aria-expanded') === 'true';
          const next = !expanded;
          btn.setAttribute('aria-expanded', String(next));
          panel.hidden = !next;
          btn.textContent = next ? 'Hide working' : 'Show working';
        });
      });

      // Drawer behavior (tablet/mobile)
      const navToggle = document.getElementById('navToggle');
      const backdrop = document.getElementById('drawerBackdrop');
      const closeBtn = document.getElementById('drawerClose');

      function openDrawer(){
        if (!backdrop) return;
        backdrop.classList.add('open');
        backdrop.setAttribute('aria-hidden', 'false');
        navToggle && navToggle.setAttribute('aria-expanded', 'true');

        // Move focus into the dialog for accessibility
        closeBtn && closeBtn.focus();
      }

      function closeDrawer(){
        if (!backdrop) return;
        backdrop.classList.remove('open');
        backdrop.setAttribute('aria-hidden', 'true');
        navToggle && navToggle.setAttribute('aria-expanded', 'false');

        // Return focus to the toggle
        navToggle && navToggle.focus();
      }

      navToggle && navToggle.addEventListener('click', () => {
        const isOpen = backdrop.classList.contains('open');
        if (isOpen) closeDrawer(); else openDrawer();
      });

      closeBtn && closeBtn.addEventListener('click', closeDrawer);

      // Click outside drawer to close
      backdrop && backdrop.addEventListener('click', (e) => {
        if (e.target === backdrop) closeDrawer();
      });

      // Close drawer on nav item click (do not alter expanded/collapsed states)
      const drawerLinks = backdrop ? backdrop.querySelectorAll('a[href^="#"]') : [];
      drawerLinks.forEach(a => {
        a.addEventListener('click', () => closeDrawer());
      });

      // Escape key closes drawer
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && backdrop && backdrop.classList.contains('open')) {
          closeDrawer();
        }
      });
    })();
  </script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
  <!-- RTQ_RUN {"generator":"rtq-prototype-batch","model":"gemini-3-pro-preview","prefix":"gemini.stage-12.1","variant":"ABC","indexWithinVariant":"16","totalWithinVariant":"320","hueFamily":"red","intensityMode":"deep_theme","timestamp":"2026-01-07T10:07:03.171Z"} -->
  <meta name="rtq-run" content='{&quot;generator&quot;:&quot;rtq-prototype-batch&quot;,&quot;model&quot;:&quot;gemini-3-pro-preview&quot;,&quot;prefix&quot;:&quot;gemini.stage-12.1&quot;,&quot;variant&quot;:&quot;ABC&quot;,&quot;indexWithinVariant&quot;:&quot;16&quot;,&quot;totalWithinVariant&quot;:&quot;320&quot;,&quot;hueFamily&quot;:&quot;red&quot;,&quot;intensityMode&quot;:&quot;deep_theme&quot;,&quot;timestamp&quot;:&quot;2026-01-07T10:07:03.171Z&quot;}'>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RTQ Maths Paper Solution Viewer</title>

    <!-- Tailwind CSS (CDN) -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- KaTeX CSS (CDN - No Integrity/SRI per Stage 6) -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">

    <!-- KaTeX JS (CDN - No Integrity/SRI per Stage 6) -->
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>

    <!-- Markdown-it (CDN) -->
    <script src="https://cdn.jsdelivr.net/npm/markdown-it@14.0.0/dist/markdown-it.min.js"></script>

    <!-- Lucide Icons (CDN) -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <script>
        // Tailwind Config for ColorLab C: deep_theme + ColorLab B: RED
        // Hue = 25 (Red)
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        // Semantic Roles mapped to OKLCH values per ColorLab C "deep_theme"
                        page: 'oklch(0.95 0.02 25)',       // L ~0.95, C ~0.02
                        frame: 'oklch(0.93 0.03 25)',      // L ~0.93, C ~0.03 (distinct from page)
                        paper: 'oklch(0.98 0.01 25)',      // L ~0.98, C ~0.01 (lightest)
                        
                        txt: {
                            primary: 'oklch(0.20 0.015 25)',   // L ~0.20
                            secondary: 'oklch(0.35 0.02 25)',  // L ~0.35
                            tertiary: 'oklch(0.50 0.02 25)',   // For very quiet UI
                        },

                        accent: {
                            DEFAULT: 'oklch(0.55 0.22 25)', // L ~0.55, C ~0.22 (Red Accent)
                            hover: 'oklch(0.50 0.22 25)',
                        },

                        divider: 'oklch(0.85 0.02 25)',
                        
                        wash: {
                            solution: 'oklch(0.96 0.03 25)', // Distinct wash for solution details
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                    },
                    spacing: {
                        'rhythm-lg': '3rem',  // Top level question gap
                        'rhythm-md': '1.5rem', // Parent to child
                        'rhythm-sm': '1rem',   // Internal block
                        'rhythm-xs': '0.5rem', // Tight grouping
                    }
                }
            }
        }
    </script>

    <style>
        /* Base Reset & Typography */
        body {
            @apply bg-page text-txt-primary font-sans antialiased;
            overflow-y: scroll; /* Force vertical scrollbar to avoid layout shift */
        }

        /* Focus Styles (Custom per Stage 5.5.2) */
        :focus-visible {
            outline: 2px solid theme('colors.accent.DEFAULT');
            outline-offset: 2px;
        }

        /* Scrollbar Hiding for Navigation */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        /* KaTeX Containment Invariant (Stage 3/6) */
        .katex-display {
            overflow-x: auto;
            overflow-y: hidden;
            max-width: 100%;
            padding-bottom: 4px; /* Space for scrollbar if needed */
            -webkit-overflow-scrolling: touch;
        }
        
        /* Inline KaTeX background rule (Stage 5.8.4) */
        .katex {
            background-color: transparent !important;
        }
        
        /* Markdown Content Styling */
        .md-content p {
            margin-bottom: 0.75em;
            line-height: 1.6;
        }
        .md-content p:last-child {
            margin-bottom: 0;
        }
        /* Tables (Stage 5.8.5) */
        .md-content table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 1em;
            font-size: 0.95em;
        }
        .md-content th, .md-content td {
            border: 1px solid theme('colors.divider');
            padding: 0.5em;
            text-align: left;
        }
        .md-content th {
            font-weight: 600;
            color: theme('colors.txt.primary');
        }
        /* Lists */
        .md-content ul {
            list-style-type: disc;
            padding-left: 1.25em;
            margin-bottom: 0.75em;
        }
        .md-content ol {
            list-style-type: decimal;
            padding-left: 1.25em;
            margin-bottom: 0.75em;
        }

        /* Sticky Nav Desktop */
        .sticky-nav-rail {
            position: sticky;
            top: 0;
            height: 100vh;
            overflow-y: auto;
        }
    </style>
</head>
<body class="bg-page min-h-screen flex flex-col items-center">

    <!-- STAGE 0 CONSTANTS RUNTIME -->
    <script>
        const RTQ_PAPERS_PAYLOAD_PATH = "../../../payload/rtq.papers.payload.v2.json";
        const RTQ_SHADCN_TOKEN_PROFILES_PATH = "../../../payload/rtq.shadcn.token.profiles.v1.json";
        
        // ColorLab Parameters
        const RTQ_COLORLAB_FORCE_HUE_FAMILY = "red";
        const RTQ_COLORLAB_INTENSITY_MODE = "deep_theme";
    </script>

    <!-- APP ROOT -->
    <div id="app" class="w-full max-w-[1200px] flex flex-col md:bg-frame min-h-screen shadow-sm transition-colors duration-300">
        
        <!-- TOP CONTROLS REGION -->
        <header class="w-full px-4 py-3 md:px-8 flex justify-between items-center border-b border-divider bg-frame z-20">
            <div class="flex items-center gap-4">
                <div id="paper-selector-container">
                    <!-- Paper Selector injected here -->
                </div>
            </div>
            
            <!-- Mobile Jump To Trigger -->
            <button id="mobile-jump-trigger" class="md:hidden text-accent font-medium text-sm flex items-center gap-1 p-2 rounded hover:bg-black/5 transition-colors">
                <i data-lucide="menu" class="w-4 h-4"></i>
                <span>Jump to</span>
            </button>
        </header>

        <!-- DOCUMENT FRAME SHELL -->
        <div class="flex flex-1 relative">
            
            <!-- LEFT COLUMN: NAVIGATION RAIL (Desktop) -->
            <aside class="hidden md:block w-64 flex-shrink-0 border-r border-divider bg-frame sticky-nav-rail no-scrollbar py-6 pl-6 pr-2">
                <nav id="desktop-nav-list" class="flex flex-col gap-1" aria-label="Question navigation">
                    <!-- Nav items injected here -->
                </nav>
            </aside>

            <!-- RIGHT COLUMN: PAPER CONTENT -->
            <main id="paper-region" class="flex-1 bg-paper px-4 py-8 md:px-12 md:py-12 min-h-[80vh]">
                <!-- Paper content injected here -->
                <div id="loading-state" class="text-txt-secondary text-center mt-12">Loading paper...</div>
                <div id="error-state" class="hidden text-txt-secondary text-center mt-12 font-medium">PAPERS PAYLOAD MISSING</div>
                <div id="questions-container" class="flex flex-col gap-rhythm-lg"></div>
            </main>

        </div>
    </div>

    <!-- MOBILE DRAWER (Overlay) -->
    <div id="mobile-drawer" class="fixed inset-0 z-50 transform translate-x-full transition-transform duration-300 flex justify-end" aria-hidden="true">
        <!-- Scrim -->
        <div id="drawer-scrim" class="absolute inset-0 bg-black/20 opacity-0 transition-opacity duration-300" aria-hidden="true"></div>
        
        <!-- Drawer Panel -->
        <div class="relative w-64 h-full bg-frame border-l border-divider shadow-xl flex flex-col">
            <div class="p-4 border-b border-divider flex justify-between items-center bg-frame">
                <span class="font-bold text-txt-primary">Jump to</span>
                <button id="drawer-close" class="text-txt-secondary hover:text-txt-primary p-2">
                    <i data-lucide="x" class="w-5 h-5"></i>
                </button>
            </div>
            <nav id="mobile-nav-list" class="flex-1 overflow-y-auto p-4 flex flex-col gap-1">
                <!-- Mobile Nav items injected here -->
            </nav>
        </div>
    </div>

    <!-- MAIN LOGIC -->
    <script>
        // --- Markdown renderer (authoritative config per Stage 6) ---
        const md = window.markdownit
          ? window.markdownit({
              html: true, // allow inline SVG
              linkify: true,
              breaks: false, // MUST stay false
            })
          : null;

        if (md) {
            md.inline.ruler.disable(["escape"]); // Preserve TeX backslashes
        }

        // --- State ---
        const state = {
            papers: [],
            currentPaperId: null,
            expandedMap: {}, // key: questionId, value: boolean
            activeQuestionId: null, // for navigation highlighting
            isLoading: true,
            hasError: false
        };

        // --- DOM Elements ---
        const els = {
            paperSelector: document.getElementById('paper-selector-container'),
            questionsContainer: document.getElementById('questions-container'),
            desktopNav: document.getElementById('desktop-nav-list'),
            mobileNav: document.getElementById('mobile-nav-list'),
            loading: document.getElementById('loading-state'),
            error: document.getElementById('error-state'),
            mobileDrawer: document.getElementById('mobile-drawer'),
            drawerScrim: document.getElementById('drawer-scrim'),
            jumpTrigger: document.getElementById('mobile-jump-trigger'),
            drawerClose: document.getElementById('drawer-close'),
            app: document.getElementById('app')
        };

        // --- Fetch Payload ---
        async function init() {
            try {
                const response = await fetch(RTQ_PAPERS_PAYLOAD_PATH);
                if (!response.ok) throw new Error("Payload missing");
                const data = await response.json();
                
                if (!data.papers || !Array.isArray(data.papers)) throw new Error("Invalid payload");
                
                state.papers = data.papers;
                state.isLoading = false;
                
                // Set initial paper
                if (state.papers.length > 0) {
                    loadPaper(state.papers[0].key);
                }
                
                renderSelectors();
                
            } catch (err) {
                console.error(err);
                state.isLoading = false;
                state.hasError = true;
                renderError();
            }
        }

        function renderError() {
            els.loading.classList.add('hidden');
            els.error.classList.remove('hidden');
            els.paperSelector.innerHTML = "";
            els.desktopNav.innerHTML = "";
        }

        function renderSelectors() {
            // Paper Selector
            const select = document.createElement('select');
            select.className = "bg-transparent text-sm font-medium text-txt-primary border-none focus:ring-2 focus:ring-accent rounded p-1 cursor-pointer";
            select.ariaLabel = "Select Paper";
            
            state.papers.forEach(p => {
                const opt = document.createElement('option');
                opt.value = p.key;
                opt.textContent = p.label || p.key;
                select.appendChild(opt);
            });

            select.value = state.currentPaperId;
            select.addEventListener('change', (e) => loadPaper(e.target.value));
            
            els.paperSelector.innerHTML = '';
            els.paperSelector.appendChild(select);
        }

        function loadPaper(paperId) {
            state.currentPaperId = paperId;
            const paper = state.papers.find(p => p.key === paperId);
            if (!paper) return;

            // Reset expansion state based on defaults
            const defaultExpanded = paper.defaults?.expandedAll ?? true;
            state.expandedMap = {}; // Reset map. If id not in map, use defaultExpanded.

            renderPaperContent(paper);
            renderNavigation(paper);
            
            // Re-run icons
            lucide.createIcons();
            
            // Setup intersection observer for scrollspy
            setupScrollSpy(paper);
        }

        // --- Rendering Logic ---

        function renderPaperContent(paper) {
            els.loading.classList.add('hidden');
            els.error.classList.add('hidden');
            els.questionsContainer.innerHTML = '';

            const defaultExpanded = paper.defaults?.expandedAll ?? true;

            // Helper to get question list (handles sectioned vs flat)
            let renderList = [];
            if (paper.sections) {
                paper.sections.forEach(section => {
                    // Render Section Header if label present
                    if (section.label && section.label.trim() !== "") {
                        const sectionHeader = document.createElement('div');
                        sectionHeader.className = "text-txt-secondary font-bold text-lg pt-4 pb-2 border-b border-divider mb-6";
                        sectionHeader.textContent = section.label;
                        els.questionsContainer.appendChild(sectionHeader);
                    }
                    
                    section.questions.forEach(q => renderQuestionNode(q, els.questionsContainer, 0, defaultExpanded));
                });
            } else if (paper.questions) {
                paper.questions.forEach(q => renderQuestionNode(q, els.questionsContainer, 0, defaultExpanded));
            }

            // After DOM injection, trigger KaTeX
            renderMathInElement(els.questionsContainer, {
                delimiters: [
                    {left: '$$', right: '$$', display: true},
                    {left: '$', right: '$', display: false}
                ],
                throwOnError: false
            });
        }

        function renderQuestionNode(question, container, depth, defaultExpanded) {
            const node = document.createElement('div');
            node.className = `flex flex-col w-full relative group scroll-mt-24`; // scroll-mt for sticky header clearance
            node.id = `q-${question.id}`;
            
            // Styling based on depth (rhythm)
            const isTopLevel = depth === 0;
            if (isTopLevel) {
                node.classList.add('mb-rhythm-lg'); 
                // Stage 3 option: Top level separation via spacing + optional hairline if needed.
                // Using spacing as primary.
            } else {
                node.classList.add('mt-rhythm-md');
            }

            // Question Surface (Optional per Stage 3, keeping clean/transparent for now per Stage 5)
            
            // --- 1. Question Body ---
            const qBody = document.createElement('div');
            qBody.className = "flex flex-col gap-2 mb-4";
            
            const qHeader = document.createElement('div');
            qHeader.className = "flex items-baseline gap-3";
            
            // Identifier
            const qId = document.createElement('span');
            qId.className = "text-txt-secondary font-semibold text-sm select-none flex-shrink-0";
            qId.textContent = question.id;
            
            // Prompt
            const qPrompt = document.createElement('div');
            qPrompt.className = "text-txt-primary font-medium text-lg leading-relaxed md-content";
            qPrompt.innerHTML = md ? md.render(question.question || "") : (question.question || "");
            
            qHeader.appendChild(qId);
            qHeader.appendChild(qPrompt);
            qBody.appendChild(qHeader);
            node.appendChild(qBody);

            // --- 2. Solution Block (Optional) ---
            if (question.solutionBlock) {
                const sb = question.solutionBlock;
                const wrapper = document.createElement('div');
                wrapper.className = "pl-0 md:pl-8 flex flex-col gap-4"; // Indent on desktop for rhythm

                // Answer
                if (sb.answer) {
                    const ansDiv = document.createElement('div');
                    ansDiv.className = "flex flex-col gap-1";
                    
                    const ansLabel = document.createElement('span');
                    ansLabel.className = "text-xs font-bold uppercase tracking-wider text-accent";
                    ansLabel.textContent = "Answer";
                    
                    const ansContent = document.createElement('div');
                    ansContent.className = "text-txt-primary md-content";
                    ansContent.innerHTML = md ? md.render(sb.answer) : sb.answer;

                    ansDiv.appendChild(ansLabel);
                    ansDiv.appendChild(ansContent);
                    wrapper.appendChild(ansDiv);
                }

                // Solution Details
                if (sb.solutionDetails) {
                    const details = sb.solutionDetails;
                    const isExpanded = state.expandedMap[question.id] !== undefined 
                        ? state.expandedMap[question.id] 
                        : defaultExpanded;

                    // Disclosure Control
                    const toggleBtn = document.createElement('button');
                    toggleBtn.className = "flex items-center gap-2 text-sm font-medium text-accent hover:text-accent-hover transition-colors focus:outline-none focus-visible";
                    toggleBtn.onclick = () => toggleSolution(question.id, paper => paper.defaults?.expandedAll ?? true);
                    
                    const icon = document.createElement('i');
                    icon.setAttribute('data-lucide', isExpanded ? "chevron-down" : "chevron-right");
                    icon.className = "w-4 h-4";
                    
                    const label = document.createElement('span');
                    label.textContent = isExpanded ? "Hide working" : "Show working";
                    
                    toggleBtn.appendChild(icon);
                    toggleBtn.appendChild(label);
                    wrapper.appendChild(toggleBtn);

                    // Expandable Region
                    if (isExpanded) {
                        const region = document.createElement('div');
                        region.className = "flex flex-col gap-6 p-4 bg-wash-solution rounded-sm border-l-2 border-accent/20 animate-in fade-in zoom-in-95 duration-200";
                        // Stage 5.6.4: Order: Keep in mind -> Formulas -> Working -> Alternative

                        // Keep in mind
                        if (details.keepInMind) {
                            region.appendChild(renderSubBlock("Keep in mind", details.keepInMind, "lightbulb"));
                        }
                        // Formulas used
                        if (details.formulasUsed) {
                            region.appendChild(renderSubBlock("Formulas used", details.formulasUsed));
                        }
                        // Working
                        if (details.working) {
                            region.appendChild(renderSubBlock("Working", details.working));
                        }
                        // Alternative Working (Array)
                        if (details.alternativeWorking && Array.isArray(details.alternativeWorking)) {
                            details.alternativeWorking.forEach((alt, idx) => {
                                region.appendChild(renderSubBlock("Alternative working", alt));
                            });
                        }

                        wrapper.appendChild(region);
                    }
                }

                node.appendChild(wrapper);
            }

            // --- 3. Children ---
            if (question.children && question.children.length > 0) {
                const childContainer = document.createElement('div');
                childContainer.className = "pl-4 md:pl-6 border-l border-divider mt-4";
                question.children.forEach(child => {
                    renderQuestionNode(child, childContainer, depth + 1, defaultExpanded);
                });
                node.appendChild(childContainer);
            }

            container.appendChild(node);
        }

        function renderSubBlock(title, contentMarkdown, iconName) {
            const block = document.createElement('div');
            block.className = "flex flex-col gap-2";
            
            const header = document.createElement('div');
            header.className = "flex items-center gap-2 text-xs font-bold uppercase tracking-wider text-txt-secondary";
            
            if (iconName) {
                const icon = document.createElement('i');
                icon.setAttribute('data-lucide', iconName);
                icon.className = "w-3 h-3";
                header.appendChild(icon);
            }
            
            const titleSpan = document.createElement('span');
            titleSpan.textContent = title;
            header.appendChild(titleSpan);
            block.appendChild(header);
            
            const body = document.createElement('div');
            body.className = "text-txt-secondary md-content text-sm";
            body.innerHTML = md ? md.render(contentMarkdown) : contentMarkdown;
            block.appendChild(body);
            
            return block;
        }

        function toggleSolution(qId, getDefault) {
            // Update state
            const currentVal = state.expandedMap[qId] !== undefined 
                ? state.expandedMap[qId] 
                : getDefault(); // need access to paper defaults, simple hack: look at current DOM or re-fetch current paper
            
            // Better: just check the DOM or store current paper ref.
            // Using state.papers lookup
            const paper = state.papers.find(p => p.key === state.currentPaperId);
            const defaultExpanded = paper?.defaults?.expandedAll ?? true;
            
            const isCurrentlyExpanded = state.expandedMap[qId] !== undefined ? state.expandedMap[qId] : defaultExpanded;
            state.expandedMap[qId] = !isCurrentlyExpanded;

            // Re-render
            // Ideally partial re-render, but full re-render is safer for prototype logic
            // Save scroll pos? prototype simplicity: full re-render.
            // To prevent jump, we try to preserve relative scroll but atomic changes are better.
            // For this output, we'll simple re-render.
            const scrollPos = window.scrollY;
            renderPaperContent(paper);
            lucide.createIcons();
            window.scrollTo(0, scrollPos);
        }

        // --- Navigation Rendering ---

        function renderNavigation(paper) {
            // Build linear list of items
            const items = [];
            
            function traverse(nodes) {
                nodes.forEach(q => {
                    items.push({ id: q.id, type: 'question', depth: getDepth(q.id) });
                    if (q.children) traverse(q.children);
                });
            }
            
            // Naive depth heuristic or passed param? 
            // Payload says derived from children structure. 
            // For nav, flat list. We just need identifiers.
            
            // Re-traverse payload to build flat nav structure with section headers
            const navStructure = [];
            
            if (paper.sections) {
                paper.sections.forEach(s => {
                    if (s.label && s.label.trim()) {
                        navStructure.push({ type: 'section', label: s.label });
                    }
                    if (s.questions) {
                        const pushQuestions = (qs, depth) => {
                            qs.forEach(q => {
                                navStructure.push({ type: 'question', id: q.id, depth: depth });
                                if (q.children) pushQuestions(q.children, depth + 1);
                            });
                        };
                        pushQuestions(s.questions, 0);
                    }
                });
            } else if (paper.questions) {
                const pushQuestions = (qs, depth) => {
                    qs.forEach(q => {
                        navStructure.push({ type: 'question', id: q.id, depth: depth });
                        if (q.children) pushQuestions(q.children, depth + 1);
                    });
                };
                pushQuestions(paper.questions, 0);
            }

            // Render function
            const createNavHTML = () => {
                const fragment = document.createDocumentFragment();
                navStructure.forEach(item => {
                    if (item.type === 'section') {
                        const div = document.createElement('div');
                        div.className = "text-xs font-bold text-txt-tertiary uppercase tracking-widest mt-4 mb-2 pl-2 select-none";
                        div.textContent = item.label;
                        fragment.appendChild(div);
                    } else {
                        const btn = document.createElement('button');
                        btn.className = `w-full text-left px-2 py-1 text-sm rounded transition-colors duration-200 nav-item-${item.id}`;
                        
                        // Hierarchy via type scale / quietness (Stage 5.4.5)
                        if (item.depth === 0) {
                            btn.classList.add("text-txt-primary");
                        } else {
                            btn.classList.add("text-txt-secondary", "text-xs");
                        }

                        btn.textContent = item.id;
                        btn.onclick = () => {
                            const target = document.getElementById(`q-${item.id}`);
                            if (target) {
                                // Close drawer if open
                                closeDrawer();
                                // Scroll with offset
                                const headerOffset = 80;
                                const elementPosition = target.getBoundingClientRect().top;
                                const offsetPosition = elementPosition + window.pageYOffset - headerOffset;
                                window.scrollTo({ top: offsetPosition, behavior: "smooth" });
                            }
                        };
                        fragment.appendChild(btn);
                    }
                });
                return fragment;
            };

            els.desktopNav.innerHTML = "";
            els.desktopNav.appendChild(createNavHTML());

            els.mobileNav.innerHTML = "";
            els.mobileNav.appendChild(createNavHTML());
        }

        // --- Active State Spy ---
        function setupScrollSpy(paper) {
            // Simple intersection observer to mark active nav item
            // We observe all question nodes
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        // This heuristic is simple: the first one intersecting from top is somewhat active.
                        // Better: center of screen.
                        // For prototype, simple is fine.
                        updateActiveNav(entry.target.id.replace('q-', ''));
                    }
                });
            }, { rootMargin: '-10% 0px -80% 0px' }); // bias towards top

            document.querySelectorAll('[id^="q-"]').forEach(el => observer.observe(el));
        }

        function updateActiveNav(id) {
            if (state.activeQuestionId === id) return;
            state.activeQuestionId = id;
            
            // Remove active styles
            document.querySelectorAll('.nav-active').forEach(el => {
                el.classList.remove('nav-active', 'font-bold', 'text-accent', 'bg-accent/5');
            });
            
            // Add active styles (Desktop & Mobile)
            const targets = document.querySelectorAll(`.nav-item-${CSS.escape(id)}`);
            targets.forEach(t => {
                t.classList.add('nav-active', 'font-bold', 'text-accent', 'bg-accent/5');
                // Optional scroll into view for nav list if needed
            });
        }

        // --- Drawer Logic ---
        function openDrawer() {
            els.mobileDrawer.classList.remove('translate-x-full');
            els.drawerScrim.classList.remove('opacity-0');
            els.drawerScrim.classList.remove('pointer-events-none');
        }
        function closeDrawer() {
            els.mobileDrawer.classList.add('translate-x-full');
            els.drawerScrim.classList.add('opacity-0');
            els.drawerScrim.classList.add('pointer-events-none');
        }

        els.jumpTrigger.addEventListener('click', openDrawer);
        els.drawerClose.addEventListener('click', closeDrawer);
        els.drawerScrim.addEventListener('click', closeDrawer);

        // --- Start ---
        init();

    </script>
</body>
</html>

<!DOCTYPE html>
<html lang="en" class="light">
<head>
  <!-- RTQ_RUN {"generator":"rtq-prototype-batch","model":"gemini-3-pro-preview","prefix":"gemini.stage-12.1","variant":"AB","indexWithinVariant":"179","totalWithinVariant":"200","hueFamily":"purple","intensityMode":"","timestamp":"2026-01-07T08:23:53.836Z"} -->
  <meta name="rtq-run" content='{&quot;generator&quot;:&quot;rtq-prototype-batch&quot;,&quot;model&quot;:&quot;gemini-3-pro-preview&quot;,&quot;prefix&quot;:&quot;gemini.stage-12.1&quot;,&quot;variant&quot;:&quot;AB&quot;,&quot;indexWithinVariant&quot;:&quot;179&quot;,&quot;totalWithinVariant&quot;:&quot;200&quot;,&quot;hueFamily&quot;:&quot;purple&quot;,&quot;intensityMode&quot;:&quot;&quot;,&quot;timestamp&quot;:&quot;2026-01-07T08:23:53.836Z&quot;}'>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RTQ Maths Paper Solution Viewer (Stage 6)</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <!-- KaTeX CSS (No SRI/Integrity) -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">

    <!-- KaTeX JS (No SRI/Integrity) -->
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>

    <!-- Markdown-it (No SRI/Integrity) -->
    <script src="https://cdn.jsdelivr.net/npm/markdown-it@14.0.0/dist/markdown-it.min.js"></script>

    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <script>
        tailwind.config = {
            darkMode: 'class', // Forced light mode per ColorLab A
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    colors: {
                        // ColorLab B: Forced Hue Family = PURPLE
                        // Using Tailwind's default purple palette for accents/focus/labels
                        accent: {
                            50: '#faf5ff',
                            100: '#f3e8ff',
                            200: '#e9d5ff',
                            300: '#d8b4fe',
                            400: '#c084fc',
                            500: '#a855f7',
                            600: '#9333ea',
                            700: '#7e22ce',
                            800: '#6b21a8',
                            900: '#581c87',
                        }
                    }
                }
            }
        }
    </script>

    <style>
        /* Base / Reset */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #ffffff; /* Light mode hard lock */
            color: #18181b; /* Zinc 900 */
            -webkit-font-smoothing: antialiased;
        }

        /* Hide scrollbars for Nav but keep functionality (Add-on) */
        .no-scrollbar {
            -ms-overflow-style: none;  /* IE and Edge */
            scrollbar-width: none;  /* Firefox */
        }
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }

        /* KaTeX Containment Invariant */
        .katex-display {
            overflow-x: auto;
            overflow-y: hidden;
            max-width: 100%;
            -webkit-overflow-scrolling: touch;
            padding-bottom: 4px; /* Space for scrollbar if needed */
        }
        
        /* Markdown Tables */
        table {
            border-collapse: collapse;
            width: 100%;
            margin-bottom: 1rem;
            font-size: 0.95em;
        }
        th, td {
            border: 1px solid #e4e4e7; /* Zinc 200 */
            padding: 0.5rem;
            text-align: left;
        }
        th {
            font-weight: 600;
            background-color: #fafafa; /* Zinc 50 */
        }
        /* Mobile table scroll wrapper handled in render logic */

        /* Focus Styles (Accessibility) */
        *:focus-visible {
            outline: 2px solid #a855f7; /* Purple 500 */
            outline-offset: 2px;
        }

        /* Typography Hierarchy */
        h1, h2, h3, h4, h5, h6 {
            font-weight: 600;
            color: #18181b;
        }
        
        /* Markdown Content Styling */
        .md-content p {
            margin-bottom: 0.75em;
            line-height: 1.6;
        }
        .md-content ul {
            list-style-type: disc;
            padding-left: 1.5em;
            margin-bottom: 0.75em;
        }
        .md-content ol {
            list-style-type: decimal;
            padding-left: 1.5em;
            margin-bottom: 0.75em;
        }
        .md-content code {
            background-color: #f4f4f5; /* Zinc 100 */
            padding: 0.1em 0.3em;
            border-radius: 0.25em;
            font-size: 0.875em;
        }

        /* Utility */
        .interactive-hover:hover {
            color: #7e22ce; /* Purple 700 */
        }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <!-- Top Controls Region -->
    <header class="sticky top-0 z-30 bg-white/95 backdrop-blur border-b border-zinc-200">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-14 flex items-center justify-between">
            <div class="flex items-center gap-4">
                <!-- Mobile "Jump to" Trigger -->
                <button id="mobile-nav-trigger" class="lg:hidden p-2 -ml-2 text-zinc-600 hover:text-accent-700 hover:bg-accent-50 rounded-md transition-colors" aria-label="Jump to question">
                    <i data-lucide="menu" class="w-5 h-5"></i>
                </button>
                <div class="font-semibold text-zinc-900 tracking-tight">RTQ Viewer <span class="text-xs font-normal text-zinc-500 ml-1">v11.2</span></div>
            </div>

            <!-- Paper Selector -->
            <div class="flex items-center">
                <label for="paper-select" class="sr-only">Select Paper</label>
                <select id="paper-select" class="form-select block w-full pl-3 pr-10 py-1.5 text-sm border-zinc-300 focus:outline-none focus:ring-accent-500 focus:border-accent-500 sm:text-sm rounded-md shadow-sm bg-white text-zinc-900 cursor-pointer hover:border-accent-300 transition-colors">
                    <option value="" disabled selected>Loading papers...</option>
                </select>
            </div>
        </div>
    </header>

    <!-- DocumentFrameShell -->
    <div class="flex-1 max-w-7xl mx-auto w-full px-4 sm:px-6 lg:px-8 py-8 grid lg:grid-cols-[240px_1fr] gap-8 relative">
        
        <!-- Navigation Rail (Desktop) -->
        <nav class="hidden lg:block h-[calc(100vh-8rem)] sticky top-24 overflow-y-auto no-scrollbar pr-4 border-r border-transparent" aria-label="Paper navigation">
            <ul id="desktop-nav-list" class="space-y-1">
                <!-- Nav items generated here -->
            </ul>
        </nav>

        <!-- Paper Document Column -->
        <main id="paper-content" class="min-w-0 pb-32">
            <!-- Paper content generated here -->
            <div class="text-center text-zinc-500 mt-12">
                <i data-lucide="loader-2" class="w-6 h-6 animate-spin mx-auto mb-2"></i>
                <p>Initializing...</p>
            </div>
        </main>

    </div>

    <!-- Mobile Navigation Drawer -->
    <div id="mobile-drawer-backdrop" class="fixed inset-0 bg-zinc-900/20 backdrop-blur-sm z-40 hidden transition-opacity opacity-0" aria-hidden="true"></div>
    <div id="mobile-drawer" class="fixed inset-y-0 left-0 w-72 bg-white shadow-xl z-50 transform -translate-x-full transition-transform duration-300 ease-in-out flex flex-col" aria-modal="true" role="dialog">
        <div class="flex items-center justify-between p-4 border-b border-zinc-100">
            <h2 class="text-lg font-semibold text-zinc-900">Jump to</h2>
            <button id="mobile-drawer-close" class="p-2 -mr-2 text-zinc-500 hover:text-zinc-900 rounded-md">
                <i data-lucide="x" class="w-5 h-5"></i>
            </button>
        </div>
        <div class="flex-1 overflow-y-auto no-scrollbar p-4">
            <ul id="mobile-nav-list" class="space-y-1">
                <!-- Mobile nav items generated here -->
            </ul>
        </div>
    </div>

    <script>
        // --- CONSTANTS ---
        const RTQ_PAPERS_PAYLOAD_PATH = "../../../payload/rtq.papers.payload.v2.json";
        const RTQ_SHADCN_TOKEN_PROFILES_PATH = "../../../payload/rtq.shadcn.token.profiles.v1.json";
        const RTQ_COLORLAB_FORCE_HUE_FAMILY = "purple"; // ColorLab B

        // --- STATE ---
        let state = {
            papers: [],
            currentPaperId: null,
            expandedDetails: new Set(), // Set of question IDs with expanded details
            loading: true,
            error: null
        };

        // --- MARKDOWN SETUP (Authoritative Config) ---
        const md = window.markdownit ? window.markdownit({
            html: true, // Allow inline SVG
            linkify: true,
            breaks: false // MUST be false to preserve TeX structure
        }) : null;

        if (md) {
            // Disable escape rule to preserve TeX backslashes
            md.inline.ruler.disable(['escape']);
        }

        // --- UTILS ---
        
        // Fetch Payload
        async function loadPayload() {
            try {
                const response = await fetch(RTQ_PAPERS_PAYLOAD_PATH);
                if (!response.ok) throw new Error("Failed to load payload");
                const data = await response.json();
                state.papers = data.papers || [];
                state.loading = false;
                initApp();
            } catch (err) {
                console.error(err);
                state.error = "PAPERS PAYLOAD MISSING";
                state.loading = false;
                renderError();
            }
        }

        // --- RENDER LOGIC ---

        function initApp() {
            renderPaperSelector();
            if (state.papers.length > 0) {
                switchPaper(state.papers[0].key);
            } else {
                renderError("No papers found in payload.");
            }
        }

        function renderError(msg = "PAPERS PAYLOAD MISSING") {
            const container = document.getElementById('paper-content');
            container.innerHTML = `
                <div class="rounded-md bg-red-50 p-4 border border-red-100 text-center">
                    <p class="text-red-800 font-medium">${msg}</p>
                </div>
            `;
            // Hide selector if critical failure
            if(msg === "PAPERS PAYLOAD MISSING") {
                document.getElementById('paper-select').disabled = true;
            }
        }

        function renderPaperSelector() {
            const selector = document.getElementById('paper-select');
            selector.innerHTML = state.papers.map(p => 
                `<option value="${p.key}">${p.label}</option>`
            ).join('');
            
            selector.addEventListener('change', (e) => {
                switchPaper(e.target.value);
            });
        }

        function switchPaper(paperKey) {
            state.currentPaperId = paperKey;
            const paper = state.papers.find(p => p.key === paperKey);
            
            // Handle defaults
            state.expandedDetails.clear();
            const expandAll = paper.defaults?.expandedAll !== false; // Default to true unless strictly false
            
            // Recursively collect IDs that have solution details to set default state
            function setDefaults(questions) {
                questions.forEach(q => {
                    if (q.solutionBlock?.solutionDetails && expandAll) {
                        state.expandedDetails.add(q.id);
                    }
                    if (q.children) setDefaults(q.children);
                });
            }

            if (paper.questions) {
                setDefaults(paper.questions);
            } else if (paper.sections) {
                paper.sections.forEach(s => setDefaults(s.questions));
            }

            renderContent(paper);
            renderNavigation(paper);
            lucide.createIcons();
            
            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'auto' });
        }

        // --- NAVIGATION RENDERING ---

        function renderNavigation(paper) {
            const desktopList = document.getElementById('desktop-nav-list');
            const mobileList = document.getElementById('mobile-nav-list');
            
            const generateNavItems = (items) => {
                let html = '';
                
                // Helper to render a question item
                const renderItem = (q, isSection = false) => {
                    // Stage 5.4.5: Flat list, hierarchy via type scale/quietness
                    // Derived nesting depth logic required for visual styling if strictly flattened
                    // However, we just render identifiers flatly.
                    // We'll use classes to subtly indicate depth if needed, but specification says "flat list".
                    
                    return `
                        <li>
                            <a href="#q-${q.id}" 
                               class="block py-1.5 px-3 rounded-md text-sm text-zinc-500 hover:text-accent-700 hover:bg-accent-50 transition-colors focus:outline-none focus:ring-2 focus:ring-accent-400 focus:ring-offset-1 nav-item"
                               data-id="${q.id}"
                               onclick="handleNavClick(event, 'q-${q.id}')">
                               ${q.id}
                            </a>
                        </li>
                    `;
                };

                // Helper to recursively flatten structure for nav
                const flattenQuestions = (questions) => {
                    let navHtml = '';
                    questions.forEach(q => {
                        navHtml += renderItem(q);
                        if (q.children) {
                            navHtml += flattenQuestions(q.children);
                        }
                    });
                    return navHtml;
                };

                if (paper.sections) {
                    paper.sections.forEach(section => {
                        if (section.label && section.label.trim() !== "") {
                            // Section Label (Non-clickable signpost)
                            html += `
                                <li class="pt-4 pb-1 px-3">
                                    <span class="text-xs font-bold text-zinc-400 uppercase tracking-wider">${section.label}</span>
                                </li>
                            `;
                        }
                        html += flattenQuestions(section.questions);
                    });
                } else if (paper.questions) {
                    html += flattenQuestions(paper.questions);
                }
                
                return html;
            };

            const navHtml = generateNavItems();
            desktopList.innerHTML = navHtml;
            mobileList.innerHTML = navHtml;

            setupScrollSpy();
        }

        // --- CONTENT RENDERING ---

        function renderContent(paper) {
            const container = document.getElementById('paper-content');
            let html = '';

            // Render Markdown wrapper
            const renderMd = (content) => {
                if (!content || !md) return content || '';
                return md.render(content);
            };

            // Recursive Question Renderer
            const renderQuestionNode = (q, depth = 0, parentId = null) => {
                const isExpanded = state.expandedDetails.has(q.id);
                const hasSolutionBlock = !!q.solutionBlock;
                const hasAnswer = hasSolutionBlock && !!q.solutionBlock.answer;
                const hasDetails = hasSolutionBlock && !!q.solutionBlock.solutionDetails;
                
                // Nesting depth separation (Stage 5.1 Rules)
                // Top-level gets largest spacing. Children get less.
                const mtClass = depth === 0 ? 'mt-12 first:mt-0' : 'mt-6';
                // Indentation logic (Stage 3) - spacing only
                const plClass = depth > 0 ? 'pl-4 sm:pl-8 border-l border-transparent' : ''; // Transparent border preserves alignment

                // Question Prompt
                let nodeHtml = `
                    <article id="q-${q.id}" class="question-node group ${mtClass} ${plClass} scroll-mt-24">
                        <!-- Question Body -->
                        <div class="mb-4">
                            <div class="flex items-baseline gap-3">
                                <span class="text-sm font-semibold text-zinc-500 shrink-0 select-none">${q.id}</span>
                                <div class="text-zinc-900 font-medium text-lg leading-relaxed md-content max-w-none">
                                    ${renderMd(q.question)}
                                </div>
                            </div>
                        </div>
                `;

                // Solution Block (Optional)
                if (hasSolutionBlock && (hasAnswer || hasDetails)) {
                    nodeHtml += `<div class="ml-0 sm:ml-8 lg:ml-10 space-y-4">`; // Indent supporting material

                    // 1. Answer (Visible by default if present)
                    if (hasAnswer) {
                        nodeHtml += `
                            <div class="relative">
                                <div class="text-sm font-bold text-accent-700 mb-1">Answer</div>
                                <div class="text-zinc-900 md-content">
                                    ${renderMd(q.solutionBlock.answer)}
                                </div>
                            </div>
                        `;
                    }

                    // 2. Disclosure Control (If Details exist)
                    if (hasDetails) {
                        const btnLabel = isExpanded ? "Hide working" : "Show working";
                        const iconRot = isExpanded ? "rotate-180" : "";
                        
                        // Separator logic: Spacing required. Optional hairline logic handled via border-t if needed, 
                        // but Stage 5 prefers spacing/rhythm.
                        const sepClass = hasAnswer ? "mt-4" : "mt-0";

                        nodeHtml += `
                            <div class="${sepClass}">
                                <button 
                                    class="group/btn flex items-center gap-2 text-sm font-medium text-accent-600 hover:text-accent-700 transition-colors focus:outline-none focus:ring-2 focus:ring-accent-400 rounded px-1 -ml-1 py-1"
                                    onclick="toggleWorking('${q.id}')"
                                    aria-expanded="${isExpanded}"
                                    aria-controls="details-${q.id}"
                                >
                                    <span>${btnLabel}</span>
                                    <i data-lucide="chevron-down" class="w-4 h-4 transition-transform duration-200 ${iconRot}"></i>
                                </button>
                            </div>
                        `;

                        // 3. Expanded Solution Details
                        if (isExpanded) {
                            const details = q.solutionBlock.solutionDetails;
                            
                            nodeHtml += `
                                <div id="details-${q.id}" class="mt-4 pt-2 animate-in fade-in slide-in-from-top-1 duration-200 origin-top">
                                    <!-- Keep in mind -->
                                    ${details.keepInMind ? `
                                        <div class="mb-6 text-zinc-600">
                                            <div class="flex items-center gap-2 mb-2">
                                                <span class="text-xs font-bold text-zinc-500 uppercase tracking-wide">Keep in mind</span>
                                            </div>
                                            <div class="md-content text-sm">
                                                ${renderMd(details.keepInMind)}
                                            </div>
                                        </div>
                                    ` : ''}

                                    <!-- Formulas Used -->
                                    ${details.formulasUsed ? `
                                        <div class="mb-6">
                                            <div class="text-xs font-bold text-zinc-500 uppercase tracking-wide mb-2">Formulas used</div>
                                            <div class="md-content text-sm text-zinc-700">
                                                ${renderMd(details.formulasUsed)}
                                            </div>
                                        </div>
                                    ` : ''}

                                    <!-- Working (Primary) -->
                                    ${details.working ? `
                                        <div class="mb-8">
                                            <div class="text-xs font-bold text-accent-700 uppercase tracking-wide mb-3">Working</div>
                                            <div class="md-content text-zinc-800">
                                                ${renderMd(details.working)}
                                            </div>
                                        </div>
                                    ` : ''}

                                    <!-- Alternative Workings -->
                                    ${details.alternativeWorking && Array.isArray(details.alternativeWorking) ? details.alternativeWorking.map((alt, idx) => `
                                        <div class="mt-8 pt-6 border-t border-zinc-100">
                                            <div class="text-xs font-bold text-zinc-400 uppercase tracking-wide mb-3">Alternative working ${details.alternativeWorking.length > 1 ? idx + 1 : ''}</div>
                                            <div class="md-content text-zinc-700">
                                                ${renderMd(alt)}
                                            </div>
                                        </div>
                                    `).join('') : ''}
                                </div>
                            `;
                        }
                    }

                    nodeHtml += `</div>`; // End Solution Block Wrapper
                }

                // Children Container
                if (q.children && q.children.length > 0) {
                    nodeHtml += `<div class="mt-4 w-full">`;
                    q.children.forEach(child => {
                        nodeHtml += renderQuestionNode(child, depth + 1, q.id);
                    });
                    nodeHtml += `</div>`;
                }

                nodeHtml += `</article>`;
                
                // Top-level separator (Stage 3 option: Hairline allowed but Spacing required)
                // Using spacing via margin-bottom on article logic above. 
                // Adding a subtle divider between TOP LEVEL questions only if it's not the last one.
                // Since this is recursive, hard to know "last one" easily without index. 
                // We rely on spacing `mt-12` for separation.

                return nodeHtml;
            };

            if (paper.sections) {
                paper.sections.forEach((section, sIdx) => {
                    // Section Header (Stage 3: A/B/C)
                    if (section.label && section.label.trim() !== "") {
                        html += `
                            <div class="mt-16 mb-8 border-b border-zinc-200 pb-2">
                                <h2 class="text-xl font-bold text-zinc-900">${section.label}</h2>
                            </div>
                        `;
                    }
                    section.questions.forEach(q => {
                        html += renderQuestionNode(q, 0);
                        // Add divider between top level questions? 
                        // Prompt allows "Inter-question spacing (required baseline)".
                        // Divider is optional. Let's stick to clean spacing.
                        html += `<div class="h-px bg-transparent w-full my-8"></div>`; 
                    });
                });
            } else if (paper.questions) {
                paper.questions.forEach(q => {
                    html += renderQuestionNode(q, 0);
                    html += `<div class="h-px bg-transparent w-full my-12"></div>`;
                });
            }

            container.innerHTML = html;
            
            // Post-render: Typeset Math
            if (window.renderMathInElement) {
                renderMathInElement(container, {
                    delimiters: [
                        {left: '$$', right: '$$', display: true},
                        {left: '$', right: '$', display: false},
                        {left: '\\(', right: '\\)', display: false},
                        {left: '\\[', right: '\\]', display: true}
                    ],
                    throwOnError: false
                });
            }
        }

        // --- INTERACTIONS ---

        window.toggleWorking = function(id) {
            if (state.expandedDetails.has(id)) {
                state.expandedDetails.delete(id);
            } else {
                state.expandedDetails.add(id);
            }
            // Re-render efficiently? 
            // For this prototype, re-rendering the whole paper ensures consistency of state logic 
            // but might lose scroll position if not careful.
            // Better to re-render just the specific node or preserve scroll.
            // Since we use ID anchors, let's just re-render content and restore scroll position conceptually.
            // Actually, re-rendering the whole page is jarring.
            // Let's cheat slightly and find the specific paper object and re-render JUST that question node?
            // Or simpler: Full re-render but maintain scroll.
            const scrollY = window.scrollY;
            const currentPaper = state.papers.find(p => p.key === state.currentPaperId);
            renderContent(currentPaper);
            lucide.createIcons();
            // Restore scroll
            window.scrollTo(0, scrollY);
        }

        window.handleNavClick = function(e, targetId) {
            e.preventDefault();
            const el = document.getElementById(targetId);
            if (el) {
                // Smooth scroll offset for header
                const headerOffset = 100;
                const elementPosition = el.getBoundingClientRect().top;
                const offsetPosition = elementPosition + window.scrollY - headerOffset;
                
                window.scrollTo({
                    top: offsetPosition,
                    behavior: "smooth"
                });

                // Update URL hash without jump?
                // history.pushState(null, null, '#' + targetId);
                
                // Mobile: Close drawer
                closeMobileDrawer();
            }
        }

        // --- MOBILE DRAWER LOGIC ---
        const drawer = document.getElementById('mobile-drawer');
        const backdrop = document.getElementById('mobile-drawer-backdrop');
        const trigger = document.getElementById('mobile-nav-trigger');
        const closeBtn = document.getElementById('mobile-drawer-close');

        function openMobileDrawer() {
            backdrop.classList.remove('hidden');
            // small delay to allow display:block to apply before opacity transition
            setTimeout(() => {
                backdrop.classList.remove('opacity-0');
                drawer.classList.remove('-translate-x-full');
            }, 10);
        }

        function closeMobileDrawer() {
            drawer.classList.add('-translate-x-full');
            backdrop.classList.add('opacity-0');
            setTimeout(() => {
                backdrop.classList.add('hidden');
            }, 300);
        }

        trigger.addEventListener('click', openMobileDrawer);
        closeBtn.addEventListener('click', closeMobileDrawer);
        backdrop.addEventListener('click', closeMobileDrawer);

        // --- SCROLL SPY (Active Nav State) ---
        function setupScrollSpy() {
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const id = entry.target.id.replace('q-', '');
                        updateActiveNav(id);
                    }
                });
            }, {
                rootMargin: '-15% 0px -80% 0px' // Trigger when element is near top
            });

            document.querySelectorAll('article[id^="q-"]').forEach((section) => {
                observer.observe(section);
            });
        }

        function updateActiveNav(id) {
            // Remove active class from all
            document.querySelectorAll('.nav-item').forEach(link => {
                link.classList.remove('text-accent-700', 'bg-accent-50', 'font-semibold', 'border-l-2', 'border-accent-600');
                link.classList.add('text-zinc-500');
            });
            
            // Add to current
            const activeLink = document.querySelector(`.nav-item[data-id="${id}"]`);
            if (activeLink) {
                activeLink.classList.remove('text-zinc-500');
                activeLink.classList.add('text-accent-700', 'bg-accent-50', 'font-semibold');
                // Optional left border per ColorLab/Design intent for active state
                // activeLink.classList.add('border-l-2', 'border-accent-600'); 
            }
        }

        // --- INIT ---
        window.addEventListener('DOMContentLoaded', () => {
            loadPayload();
            lucide.createIcons();
        });

    </script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
  <!-- RTQ_RUN {"generator":"rtq-prototype-batch","model":"gemini-3-pro-preview","prefix":"gemini.stage-12.1","variant":"ABC","indexWithinVariant":"62","totalWithinVariant":"320","hueFamily":"pink","intensityMode":"tinted_neutrals","timestamp":"2026-01-07T12:15:11.196Z"} -->
  <meta name="rtq-run" content='{&quot;generator&quot;:&quot;rtq-prototype-batch&quot;,&quot;model&quot;:&quot;gemini-3-pro-preview&quot;,&quot;prefix&quot;:&quot;gemini.stage-12.1&quot;,&quot;variant&quot;:&quot;ABC&quot;,&quot;indexWithinVariant&quot;:&quot;62&quot;,&quot;totalWithinVariant&quot;:&quot;320&quot;,&quot;hueFamily&quot;:&quot;pink&quot;,&quot;intensityMode&quot;:&quot;tinted_neutrals&quot;,&quot;timestamp&quot;:&quot;2026-01-07T12:15:11.196Z&quot;}'>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RTQ Maths Paper Solution Viewer</title>
    
    <!-- KaTeX CSS (No integrity, SRI disabled per Stage 6) -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    
    <!-- Scripts (No integrity) -->
    <script src="https://cdn.jsdelivr.net/npm/markdown-it@14.0.0/dist/markdown-it.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>

    <style>
        /* 
         * STAGE 6 ADD-ON: COLORLAB C (Tinted Neutrals - Pink)
         * Hue: 350 (Pink)
         * Intensity Mode: tinted_neutrals
         * Light Mode Only
         */
        :root {
            /* Palette Variables (OKLCH) */
            --hue: 350; /* Pink */
            
            /* Core Surfaces (C in 0.015 .. 0.035) */
            --color-page-bg: oklch(0.96 0.02 var(--hue));
            --color-frame-bg: oklch(0.96 0.02 var(--hue)); /* Navigation shares this context */
            --color-paper-bg: oklch(0.99 0.015 var(--hue));
            
            /* Wash Surfaces (C in 0.025 .. 0.045) */
            --color-solution-wash: oklch(0.97 0.03 var(--hue));
            --color-keep-mind-wash: oklch(0.975 0.03 var(--hue));
            
            /* Text (Primary C <= 0.010, Secondary C <= 0.012) */
            --color-text-primary: oklch(0.20 0.01 var(--hue));
            --color-text-secondary: oklch(0.45 0.012 var(--hue));
            --color-text-quiet: oklch(0.60 0.012 var(--hue));

            /* Accent (C in 0.10 .. 0.16) - Links, Focus, Active Nav Marker */
            --color-accent: oklch(0.60 0.14 var(--hue));
            --color-focus-ring: oklch(0.60 0.14 var(--hue));

            /* Dividers/Hairlines */
            --color-divider: oklch(0.90 0.02 var(--hue));
            --color-table-border: oklch(0.92 0.015 var(--hue));

            /* Spacing Units */
            --space-xs: 0.25rem;
            --space-s: 0.5rem;
            --space-m: 1rem;
            --space-l: 1.5rem;
            --space-xl: 2.5rem; /* Largest unit: Between top-level questions */
            
            /* Typography */
            --font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
        }

        /* Reset & Base */
        *, *::before, *::after { box-sizing: border-box; }
        body {
            margin: 0;
            padding: 0;
            background-color: var(--color-page-bg);
            color: var(--color-text-primary);
            font-family: var(--font-family);
            line-height: 1.5;
            -webkit-font-smoothing: antialiased;
        }

        /* Utility: Accessibility */
        .sr-only {
            position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px;
            overflow: hidden; clip: rect(0, 0, 0, 0); white-space: nowrap; border-width: 0;
        }

        /* Focus States (Stage 5.5.2) */
        :focus-visible {
            outline: 2px solid var(--color-focus-ring);
            outline-offset: 2px;
            border-radius: 2px;
        }

        /* 
         * LAYOUT ARCHITECTURE (Stage 3)
         * DocumentFrameShell with Top Controls + Sibling Columns
         */
        
        .app-shell {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            max-width: 1200px;
            margin: 0 auto;
            background-color: var(--color-frame-bg);
        }

        /* Top Controls Region */
        .top-controls {
            padding: var(--space-m) var(--space-l);
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--color-divider); /* Optional Hairline */
            position: sticky;
            top: 0;
            z-index: 10;
            background-color: var(--color-frame-bg); /* Match shell */
        }

        .paper-selector {
            font-family: inherit;
            font-size: 0.95rem;
            padding: var(--space-s);
            border: 1px solid var(--color-divider);
            border-radius: 4px;
            background-color: var(--color-paper-bg);
            color: var(--color-text-primary);
        }

        .jump-to-trigger {
            display: none; /* Hidden on desktop */
            background: none;
            border: 1px solid var(--color-divider);
            border-radius: 4px;
            padding: var(--space-s) var(--space-m);
            font-size: 0.9rem;
            color: var(--color-text-primary);
            cursor: pointer;
        }

        /* Main Content Grid (Desktop: Nav + Paper) */
        .main-content {
            display: grid;
            grid-template-columns: 240px 1fr; /* Nav Rail | Paper */
            flex: 1;
            align-items: start;
        }

        /* Navigation Rail (Desktop) */
        .nav-rail {
            position: sticky;
            top: 60px; /* Offset for top controls */
            height: calc(100vh - 60px);
            overflow-y: auto;
            padding: var(--space-l) var(--space-m) var(--space-l) var(--space-l);
            font-size: 0.9rem;
            /* Scrollbar hiding logic */
            scrollbar-width: none;
            -ms-overflow-style: none;
        }
        .nav-rail::-webkit-scrollbar { display: none; }

        /* Mobile Drawer Handling */
        .nav-drawer-overlay {
            display: none;
            position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.2);
            z-index: 50;
        }
        .nav-drawer {
            position: fixed; top: 0; left: 0; bottom: 0;
            width: 280px;
            background: var(--color-paper-bg);
            z-index: 51;
            transform: translateX(-100%);
            transition: transform 0.2s ease;
            display: flex;
            flex-direction: column;
            border-right: 1px solid var(--color-divider);
        }
        .nav-drawer.open { transform: translateX(0); }
        .nav-drawer-header {
            padding: var(--space-m);
            display: flex; justify-content: space-between; align-items: center;
            border-bottom: 1px solid var(--color-divider);
        }
        .nav-drawer-content {
            flex: 1; overflow-y: auto; padding: var(--space-m);
        }

        /* Navigation List Styles (Shared) */
        .nav-list { list-style: none; padding: 0; margin: 0; }
        .nav-section-label {
            font-weight: 600;
            font-size: 0.85rem;
            color: var(--color-text-primary);
            margin-top: var(--space-m);
            margin-bottom: var(--space-s);
            padding-left: var(--space-s);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        .nav-item {
            display: block;
            padding: var(--space-xs) var(--space-s);
            color: var(--color-text-secondary);
            text-decoration: none;
            cursor: pointer;
            border-left: 2px solid transparent;
            /* Flat list, hierarchy via type scale handled in JS rendering classes */
        }
        .nav-item:hover {
            color: var(--color-text-primary);
            background-color: rgba(0,0,0,0.02); /* Minimal hover */
        }
        .nav-item.active {
            font-weight: 600;
            color: var(--color-text-primary);
            border-left-color: var(--color-accent); /* Accent used only for marker per Override */
        }
        /* Hierarchy via type scale */
        .nav-item.depth-0 { font-size: 0.95rem; }
        .nav-item.depth-1 { font-size: 0.85rem; }
        .nav-item.depth-2 { font-size: 0.8rem; }

        /* Paper Region */
        .paper-column {
            background-color: var(--color-paper-bg);
            min-height: 100%;
            padding: var(--space-xl) var(--space-xl) var(--space-xl) var(--space-l); /* Right padding larger for balance */
            /* Single continuous scroll provided by window/body */
        }

        .paper-section-header {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--color-text-primary);
            margin-top: var(--space-xl);
            margin-bottom: var(--space-l);
            padding-bottom: var(--space-s);
            border-bottom: 1px solid var(--color-divider);
        }

        /* Question Node Structure */
        .question-node {
            /* Vertical separation */
            margin-bottom: var(--space-xl);
        }
        .question-node.child-node {
            margin-bottom: var(--space-m);
            margin-top: var(--space-m);
            /* Indentation for children */
            margin-left: var(--space-m); 
            border-left: 1px solid transparent; /* Optional alignment aid, keeping invisible per spec */
        }

        /* Question Body */
        .question-body {
            display: flex;
            align-items: baseline;
            gap: var(--space-s);
            margin-bottom: var(--space-m);
        }
        .q-id {
            font-weight: 700;
            color: var(--color-text-secondary);
            min-width: 2rem;
            flex-shrink: 0;
        }
        .q-content {
            color: var(--color-text-primary);
            font-size: 1.05rem;
            max-width: 65ch; /* Comfortable reading length */
        }

        /* Solution Block */
        .solution-block {
            margin-left: 2.5rem; /* Align with content, typically */
            border-top: 1px solid transparent; /* Placeholder for separation if needed */
        }

        /* Answer */
        .answer-region {
            margin-bottom: var(--space-m);
        }
        .answer-label {
            font-size: 0.85rem;
            font-weight: 700;
            color: var(--color-text-secondary);
            display: block;
            margin-bottom: var(--space-xs);
        }
        .answer-content {
            font-size: 1rem;
            color: var(--color-text-primary);
        }

        /* Solution Details Control */
        .sd-control {
            background: none;
            border: none;
            padding: 0;
            font-size: 0.9rem;
            font-weight: 500;
            color: var(--color-accent);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: var(--space-xs);
            margin-bottom: var(--space-s);
        }
        .sd-control:hover {
            text-decoration: underline;
        }
        .sd-chevron {
            width: 1em; height: 1em;
            transition: transform 0.2s;
        }
        .sd-control[aria-expanded="true"] .sd-chevron {
            transform: rotate(90deg);
        }

        /* Solution Details Region */
        .solution-details {
            display: none;
            background-color: var(--color-solution-wash);
            padding: var(--space-m);
            border-radius: 2px; /* Minimal, not card-like */
            margin-top: var(--space-s);
            /* Boundary clarity via wash + spacing */
        }
        .solution-details.expanded {
            display: block;
            animation: reveal 0.2s ease-out;
        }

        @keyframes reveal {
            from { opacity: 0; transform: translateY(-5px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Internal Solution Details Components */
        .sd-section {
            margin-bottom: var(--space-m);
        }
        .sd-section:last-child { margin-bottom: 0; }
        
        .sd-label {
            font-size: 0.8rem;
            font-weight: 700;
            color: var(--color-text-secondary);
            margin-bottom: var(--space-xs);
            text-transform: uppercase;
            letter-spacing: 0.03em;
            display: flex;
            align-items: center;
            gap: var(--space-s);
        }

        /* Keep In Mind */
        .keep-in-mind {
            /* Slightly distinct background optional, staying plain per "tinted_neutrals" wash logic */
            /* border-left: 2px solid var(--color-divider); padding-left: var(--space-s); */
        }
        
        /* Working / Alt Working */
        .working-body {
            font-size: 0.95rem;
            color: var(--color-text-primary);
        }

        /* Markdown Content Styles */
        .md-content p { margin-top: 0; margin-bottom: 0.75em; }
        .md-content p:last-child { margin-bottom: 0; }
        
        /* Tables (Minimal) */
        .md-content table {
            border-collapse: collapse;
            width: 100%;
            margin-bottom: 1em;
            font-size: 0.9rem;
        }
        .md-content th, .md-content td {
            border: 1px solid var(--color-table-border);
            padding: var(--space-s);
            text-align: left;
        }
        .md-content th {
            font-weight: 600;
            background-color: rgba(0,0,0,0.02);
        }

        /* KaTeX Containment Invariant (Stage 6.0.8) */
        .katex-display {
            overflow-x: auto;
            overflow-y: hidden;
            max-width: 100%;
            -webkit-overflow-scrolling: touch;
            padding: 0.5em 0;
            /* Underlay rule for display math only */
            background-color: rgba(255,255,255,0.4); /* Very subtle lighten/wash on top of solution wash */
            border-radius: 2px;
        }
        /* No background for inline */
        .katex { font-size: 1.1em; } 

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            .nav-rail {
                display: none; /* Moved to drawer */
            }
            .jump-to-trigger {
                display: inline-block;
            }
            .paper-column {
                padding: var(--space-l) var(--space-m);
            }
            .question-node.child-node {
                margin-left: var(--space-s); /* Reduce indent on mobile */
            }
            .solution-block {
                margin-left: 0; /* Align left on mobile for space */
                padding-left: var(--space-s);
                border-left: 2px solid var(--color-divider); /* Visual anchor since indent removed */
            }
        }
    </style>
</head>
<body>

<div id="app" class="app-shell">
    <!-- Top Controls -->
    <header class="top-controls">
        <select id="paperSelector" class="paper-selector" aria-label="Select paper">
            <option>Loading papers...</option>
        </select>
        <button id="jumpToTrigger" class="jump-to-trigger">
            Jump to...
        </button>
    </header>

    <div class="main-content">
        <!-- Desktop Nav Rail -->
        <nav class="nav-rail" aria-label="Document navigation">
            <div id="navRailContent"></div>
        </nav>

        <!-- Paper Content -->
        <main class="paper-column" id="paperContent">
            <div style="padding: 2rem; color: var(--color-text-secondary);">
                Loading payload...
            </div>
        </main>
    </div>

    <!-- Mobile Drawer -->
    <div id="navDrawerOverlay" class="nav-drawer-overlay"></div>
    <aside id="navDrawer" class="nav-drawer" aria-label="Navigation drawer">
        <div class="nav-drawer-header">
            <span style="font-weight:700;">Jump to</span>
            <button id="navDrawerClose" class="sd-control" style="font-size:1.5rem; line-height:1;">&times;</button>
        </div>
        <div class="nav-drawer-content" id="navDrawerListContainer">
            <!-- Cloned content -->
        </div>
    </aside>
</div>

<script>
/**
 * STAGE 0: CONSTANTS (Canonical)
 */
const RTQ_PAPERS_PAYLOAD_PATH = "../../../payload/rtq.papers.payload.v2.json";
const RTQ_SHADCN_TOKEN_PROFILES_PATH = "../../../payload/rtq.shadcn.token.profiles.v1.json";

/**
 * MARKDOWN SETUP (Stage 6 Add-on)
 */
const md = window.markdownit ? window.markdownit({
    html: true,
    linkify: true,
    breaks: false // Critical: prevent <br> in math
}) : null;

if (md) {
    md.inline.ruler.disable(['escape']); // Preserve TeX backslashes
}

/**
 * STATE
 */
let papersData = [];
let currentPaper = null;

/**
 * INITIALIZATION
 */
async function init() {
    try {
        const response = await fetch(RTQ_PAPERS_PAYLOAD_PATH);
        if (!response.ok) throw new Error("Payload missing");
        const payload = await response.json();
        papersData = payload.papers || [];
        
        if (papersData.length === 0) {
            renderError("No papers found in payload.");
            return;
        }

        setupPaperSelector();
        loadPaper(papersData[0].key);

    } catch (e) {
        console.error(e);
        renderError("PAPERS PAYLOAD MISSING");
    }
    
    setupMobileDrawer();
}

function renderError(msg) {
    document.getElementById('paperContent').innerHTML = 
        `<div style="display:flex; justify-content:center; align-items:center; height:50vh; font-weight:700; color:var(--color-text-secondary); text-transform:uppercase;">${msg}</div>`;
    document.getElementById('paperSelector').style.display = 'none';
}

/**
 * PAPER LOADING
 */
function setupPaperSelector() {
    const selector = document.getElementById('paperSelector');
    selector.innerHTML = '';
    papersData.forEach(p => {
        const opt = document.createElement('option');
        opt.value = p.key;
        opt.textContent = p.label;
        selector.appendChild(opt);
    });

    selector.addEventListener('change', (e) => {
        loadPaper(e.target.value);
    });
}

function loadPaper(key) {
    currentPaper = papersData.find(p => p.key === key);
    if (!currentPaper) return;

    // Render Navigation
    const navHTML = generateNavigation(currentPaper);
    document.getElementById('navRailContent').innerHTML = navHTML;
    document.getElementById('navDrawerListContainer').innerHTML = navHTML;

    // Render Content
    const contentContainer = document.getElementById('paperContent');
    contentContainer.innerHTML = generatePaperContent(currentPaper);

    // Render Math
    renderMathInElement(contentContainer, {
        delimiters: [
            {left: '$$', right: '$$', display: true},
            {left: '$', right: '$', display: false}
        ],
        throwOnError: false
    });
    
    // Attach Nav Events
    attachNavEvents();
    
    // Attach Disclosure Events
    attachDisclosureEvents();
    
    // Scroll to top
    window.scrollTo(0, 0);
}

/**
 * GENERATORS (HTML String Builders)
 */

/* Navigation */
function generateNavigation(paper) {
    let html = '<ul class="nav-list">';
    
    if (paper.sections && paper.sections.length > 0) {
        // Sectioned Paper
        paper.sections.forEach(section => {
            if (section.label && section.label.trim() !== "") {
                html += `<li class="nav-section-label">${section.label}</li>`;
            }
            if (section.questions) {
                section.questions.forEach(q => {
                    html += generateNavNodes(q, 0);
                });
            }
        });
    } else if (paper.questions) {
        // Flat Paper
        paper.questions.forEach(q => {
            html += generateNavNodes(q, 0);
        });
    }
    
    html += '</ul>';
    return html;
}

function generateNavNodes(node, depth) {
    let html = `<li><a class="nav-item depth-${Math.min(depth, 2)}" data-target="${node.id}">${node.id}</a></li>`;
    if (node.children && node.children.length > 0) {
        node.children.forEach(child => {
            html += generateNavNodes(child, depth + 1);
        });
    }
    return html;
}

/* Content */
function generatePaperContent(paper) {
    let html = '';
    
    if (paper.sections && paper.sections.length > 0) {
        paper.sections.forEach(section => {
            if (section.label && section.label.trim() !== "") {
                html += `<div class="paper-section-header">${section.label}</div>`;
            }
            if (section.questions) {
                section.questions.forEach(q => {
                    html += generateQuestionNode(q, 0);
                });
            }
        });
    } else if (paper.questions) {
        paper.questions.forEach(q => {
            html += generateQuestionNode(q, 0);
        });
    }
    
    return html;
}

function generateQuestionNode(node, depth) {
    const isChild = depth > 0;
    const nodeClass = isChild ? 'question-node child-node' : 'question-node';
    const indentStyle = ''; // handled by CSS class
    
    let html = `<div id="q-${node.id}" class="${nodeClass}">`;
    
    // Question Body
    html += `<div class="question-body">
                <div class="q-id">${node.id}</div>
                <div class="q-content md-content">${md ? md.render(node.question || '') : node.question}</div>
             </div>`;
             
    // Solution Block (Optional)
    if (node.solutionBlock) {
        html += `<div class="solution-block">`;
        
        // Answer (Optional)
        if (node.solutionBlock.answer) {
            html += `<div class="answer-region">
                        <span class="answer-label">Answer</span>
                        <div class="answer-content md-content">${md ? md.render(node.solutionBlock.answer) : node.solutionBlock.answer}</div>
                     </div>`;
        }
        
        // Solution Details (Optional)
        const details = node.solutionBlock.solutionDetails;
        if (details) {
            const defaults = currentPaper.defaults || {};
            const expanded = defaults.expandedAll !== false; // Default true unless false
            const displayStyle = expanded ? 'block' : 'none';
            const ariaExpanded = expanded ? 'true' : 'false';
            const chevronRot = expanded ? 'transform: rotate(90deg);' : '';
            const btnText = expanded ? 'Hide working' : 'Show working';

            html += `
                <button class="sd-control" aria-expanded="${ariaExpanded}" onclick="toggleDetails(this)">
                    <svg class="sd-chevron" style="${chevronRot}" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6"></polyline></svg>
                    <span class="sd-text">${btnText}</span>
                </button>
                <div class="solution-details ${expanded ? 'expanded' : ''}" style="display:${displayStyle}">
            `;
            
            // Subsections
            if (details.keepInMind) {
                html += `<div class="sd-section keep-in-mind">
                            <div class="sd-label">
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12.01" y2="8"></line></svg>
                                Keep in mind
                            </div>
                            <div class="md-content">${md ? md.render(details.keepInMind) : details.keepInMind}</div>
                         </div>`;
            }
            
            if (details.formulasUsed) {
                html += `<div class="sd-section">
                            <div class="sd-label">Formulas used</div>
                            <div class="md-content">${md ? md.render(details.formulasUsed) : details.formulasUsed}</div>
                         </div>`;
            }
            
            if (details.working) {
                html += `<div class="sd-section">
                            <div class="sd-label">Working</div>
                            <div class="working-body md-content">${md ? md.render(details.working) : details.working}</div>
                         </div>`;
            }
            
            if (details.alternativeWorking && Array.isArray(details.alternativeWorking)) {
                details.alternativeWorking.forEach(alt => {
                    html += `<div class="sd-section">
                                <div class="sd-label">Alternative working</div>
                                <div class="working-body md-content">${md ? md.render(alt) : alt}</div>
                             </div>`;
                });
            }
            
            html += `</div>`; // End solution-details
        }
        
        html += `</div>`; // End solution-block
    }

    // Children Recurse
    if (node.children && node.children.length > 0) {
        node.children.forEach(child => {
            html += generateQuestionNode(child, depth + 1);
        });
    }

    html += `</div>`; // End question-node
    return html;
}

/**
 * INTERACTIONS
 */

/* Nav Scroll */
function attachNavEvents() {
    const links = document.querySelectorAll('.nav-item');
    links.forEach(link => {
        link.addEventListener('click', (e) => {
            e.preventDefault();
            const targetId = link.getAttribute('data-target');
            const el = document.getElementById('q-' + targetId);
            if (el) {
                // Scroll with offset for header
                const headerOffset = 70;
                const elementPosition = el.getBoundingClientRect().top;
                const offsetPosition = elementPosition + window.pageYOffset - headerOffset;
                
                window.scrollTo({
                    top: offsetPosition,
                    behavior: "smooth"
                });

                // Update Active State
                document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
                document.querySelectorAll(`.nav-item[data-target="${targetId}"]`).forEach(i => i.classList.add('active'));
                
                // Close drawer if open
                closeDrawer();
            }
        });
    });
}

/* Disclosure Toggle */
window.toggleDetails = function(btn) {
    const isExpanded = btn.getAttribute('aria-expanded') === 'true';
    const container = btn.nextElementSibling;
    const textSpan = btn.querySelector('.sd-text');
    const chevron = btn.querySelector('.sd-chevron');

    if (isExpanded) {
        // Collapse
        btn.setAttribute('aria-expanded', 'false');
        container.style.display = 'none';
        container.classList.remove('expanded');
        textSpan.textContent = 'Show working';
        chevron.style.transform = '';
    } else {
        // Expand
        btn.setAttribute('aria-expanded', 'true');
        container.style.display = 'block';
        requestAnimationFrame(() => container.classList.add('expanded'));
        textSpan.textContent = 'Hide working';
        chevron.style.transform = 'rotate(90deg)';
    }
};

/* Mobile Drawer */
function setupMobileDrawer() {
    const trigger = document.getElementById('jumpToTrigger');
    const drawer = document.getElementById('navDrawer');
    const overlay = document.getElementById('navDrawerOverlay');
    const closeBtn = document.getElementById('navDrawerClose');

    function open() {
        drawer.classList.add('open');
        overlay.style.display = 'block';
        document.body.style.overflow = 'hidden'; // Lock scroll
    }

    window.closeDrawer = function() {
        drawer.classList.remove('open');
        overlay.style.display = 'none';
        document.body.style.overflow = '';
    }

    trigger.addEventListener('click', open);
    closeBtn.addEventListener('click', closeDrawer);
    overlay.addEventListener('click', closeDrawer);
}

// Start
init();

</script>
</body>
</html>

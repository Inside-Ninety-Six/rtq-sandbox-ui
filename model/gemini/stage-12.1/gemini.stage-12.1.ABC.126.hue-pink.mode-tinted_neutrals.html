<!DOCTYPE html>
<html lang="en">
<head>
  <!-- RTQ_RUN {"generator":"rtq-prototype-batch","model":"gemini-3-pro-preview","prefix":"gemini.stage-12.1","variant":"ABC","indexWithinVariant":"126","totalWithinVariant":"320","hueFamily":"pink","intensityMode":"tinted_neutrals","timestamp":"2026-01-07T15:18:49.310Z"} -->
  <meta name="rtq-run" content='{&quot;generator&quot;:&quot;rtq-prototype-batch&quot;,&quot;model&quot;:&quot;gemini-3-pro-preview&quot;,&quot;prefix&quot;:&quot;gemini.stage-12.1&quot;,&quot;variant&quot;:&quot;ABC&quot;,&quot;indexWithinVariant&quot;:&quot;126&quot;,&quot;totalWithinVariant&quot;:&quot;320&quot;,&quot;hueFamily&quot;:&quot;pink&quot;,&quot;intensityMode&quot;:&quot;tinted_neutrals&quot;,&quot;timestamp&quot;:&quot;2026-01-07T15:18:49.310Z&quot;}'>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RTQ Maths Paper Solution Viewer (Stage 6 Baseline)</title>

    <!-- 
      STAGE 0 & STAGE 6 CONSTANTS 
      These values are authoritative.
    -->
    <script>
        // CANONICAL CONSTANT — PAPERS PAYLOAD PATH (v1.0)
        // Single source of truth for payload location.
        const RTQ_PAPERS_PAYLOAD_PATH = "../../../payload/rtq.papers.payload.v2.json";

        // CANONICAL CONSTANT — SHADCN TOKEN PROFILES PATH (v1.0)
        const RTQ_SHADCN_TOKEN_PROFILES_PATH = "../../../payload/rtq.shadcn.token.profiles.v1.json";

        // STAGE 6 ADD-ON: COLORLAB B (Forced Hue)
        const RTQ_COLORLAB_FORCE_HUE_FAMILY = "pink";

        // STAGE 6 ADD-ON: COLORLAB C (Intensity Mode)
        const RTQ_COLORLAB_INTENSITY_MODE = "tinted_neutrals";
    </script>

    <!-- FONTS -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">

    <!-- ICONS (Phosphor) -->
    <script src="https://unpkg.com/@phosphor-icons/web"></script>

    <!-- MARKDOWN-IT (No integrity) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/markdown-it/13.0.1/markdown-it.min.js"></script>

    <!-- KATEX (No integrity) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/contrib/auto-render.min.js"></script>

    <!-- TAILWIND CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- TAILWIND CONFIG & CSS VARIABLES -->
    <script>
        // OKLCH Palette Calculation for 'pink' + 'tinted_neutrals' (Add-on C Mode 2)
        // Mode 2 Rules: 
        // - Surfaces: C in [0.015 .. 0.035]
        // - Wash: C in [0.025 .. 0.045]
        // - Text: Primary C <= 0.010, Secondary C <= 0.012
        // - Accent: C in [0.10 .. 0.16]
        // Hue Family: Pink (~350)
        
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    colors: {
                        // Semantic Palette mapped to CSS variables
                        page: 'var(--bg-page)',
                        frame: 'var(--bg-frame)',
                        paper: 'var(--bg-paper)',
                        wash: 'var(--bg-wash)',
                        primary: 'var(--text-primary)',
                        secondary: 'var(--text-secondary)',
                        hairline: 'var(--border-hairline)',
                        accent: 'var(--color-accent)',
                        focus: 'var(--ring-focus)',
                    }
                }
            }
        }
    </script>

    <style>
        :root {
            /* COLORLAB C: tinted_neutrals / pink (H=350) */
            
            /* Page/Frame: Light pink tint */
            --bg-page: oklch(0.97 0.02 350);
            --bg-frame: oklch(0.97 0.02 350); /* Shared surface context on desktop */
            
            /* Paper: Slightly lighter/cleaner */
            --bg-paper: oklch(0.99 0.015 350);
            
            /* Wash (Solution Details): Slightly deeper tint */
            --bg-wash: oklch(0.96 0.035 350);
            
            /* Text: Near neutral, very low chroma */
            --text-primary: oklch(0.25 0.01 350);
            --text-secondary: oklch(0.45 0.012 350);
            
            /* Hairline: Subtle divider */
            --border-hairline: oklch(0.90 0.02 350);
            
            /* Accent: Pink, moderate chroma (Add-on C rule: [0.10 .. 0.16]) */
            --color-accent: oklch(0.60 0.14 350);
            
            /* Focus: Same as accent */
            --ring-focus: oklch(0.60 0.14 350);
        }

        body {
            background-color: var(--bg-page);
            color: var(--text-primary);
            -webkit-font-smoothing: antialiased;
        }

        /* 
           KATEX CONTAINMENT INVARIANT (Stage 6.0.8)
           - Never allow page-level horizontal scroll.
           - Horizontal scrolling permitted only inside block-level math containers.
        */
        .katex-display {
            overflow-x: auto;
            overflow-y: hidden;
            max-width: 100%;
            padding-block: 0.5em;
            /* Scrollbar hiding for cleaner look, functional on touch/wheel */
            scrollbar-width: thin; 
            scrollbar-color: var(--border-hairline) transparent;
        }
        
        /* Inline KaTeX background rule (Stage 5.8.4): Transparent only */
        .katex {
            background-color: transparent !important;
        }

        /* Nav Scrollbar hiding (Stage 6.0.9) */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        /* Focus Styles (Stage 5.5.2) */
        :focus-visible {
            outline: 2px solid var(--ring-focus);
            outline-offset: 2px;
            border-radius: 2px;
        }

        /* Markdown Table Minimal Styling */
        table {
            border-collapse: collapse;
            width: 100%;
            margin-bottom: 1rem;
            font-size: 0.95em;
        }
        th, td {
            border: 1px solid var(--border-hairline);
            padding: 0.5rem;
            text-align: left;
        }
        th {
            font-weight: 600;
        }
        
        /* Markdown Image/SVG sizing */
        img, svg {
            max-width: 100%;
            height: auto;
        }
    </style>
</head>
<body class="flex flex-col min-h-screen">

    <!-- TOP CONTROLS REGION -->
    <!-- Aligned to shell gutters via container -->
    <div class="sticky top-0 z-20 bg-frame border-b border-hairline/50 backdrop-blur-sm">
        <div class="max-w-[1200px] mx-auto px-4 md:px-8 h-14 flex items-center justify-between">
            <!-- Paper Selector -->
            <div class="flex items-center gap-2">
                <label for="paper-select" class="text-sm font-medium text-secondary sr-only">Select Paper</label>
                <select id="paper-select" class="bg-paper border border-hairline rounded px-2 py-1 text-sm text-primary focus:border-accent outline-none">
                    <option value="" disabled selected>Loading papers...</option>
                </select>
            </div>

            <!-- Mobile Jump To Trigger -->
            <button id="mobile-jump-trigger" class="md:hidden text-sm font-medium text-accent flex items-center gap-1 px-2 py-1 hover:bg-paper rounded transition-colors">
                <span>Jump to</span>
                <i class="ph ph-list text-lg"></i>
            </button>
        </div>
    </div>

    <!-- DOCUMENT FRAME SHELL -->
    <!-- Desktop: Two sibling columns (Nav + Paper) -->
    <div class="flex-1 max-w-[1200px] w-full mx-auto md:grid md:grid-cols-[240px_1fr] md:gap-8 px-4 md:px-8 py-8 relative">
        
        <!-- NAVIGATION RAIL (Desktop) -->
        <!-- Sticky, scrollable if long, no visual scrollbar -->
        <nav id="desktop-nav" class="hidden md:block sticky top-20 h-[calc(100vh-6rem)] overflow-y-auto no-scrollbar pr-4 border-r border-transparent">
            <!-- Content injected by JS -->
        </nav>

        <!-- PAPER CONTENT COLUMN -->
        <main id="paper-content" class="min-w-0 pb-32">
            <!-- Loading State -->
            <div id="loading-message" class="text-secondary text-sm pt-8">Loading paper content...</div>
        </main>
    </div>

    <!-- MOBILE NAVIGATION DRAWER -->
    <div id="mobile-drawer-backdrop" class="fixed inset-0 bg-black/20 z-40 hidden transition-opacity opacity-0" aria-hidden="true"></div>
    <div id="mobile-drawer" class="fixed inset-y-0 right-0 w-64 bg-paper z-50 transform translate-x-full transition-transform duration-300 shadow-xl flex flex-col" aria-hidden="true">
        <div class="flex items-center justify-between p-4 border-b border-hairline">
            <h2 class="text-sm font-semibold text-primary">Jump to</h2>
            <button id="drawer-close" class="text-secondary hover:text-primary p-1">
                <i class="ph ph-x text-lg"></i>
            </button>
        </div>
        <div class="flex-1 overflow-y-auto p-4" id="mobile-nav-list">
            <!-- Content injected by JS -->
        </div>
    </div>

    <!-- JAVASCRIPT LOGIC -->
    <script>
        // --- STATE ---
        let payload = null;
        let currentPaperKey = null;
        // Expanded state map: { [questionNodeId]: boolean }
        // Default determined by paper.defaults.expandedAll (true if undefined)
        const expandedState = new Map();

        // --- MARKDOWN INIT ---
        // Stage 6 Add-on: Markdown-it configuration
        const md = window.markdownit ? window.markdownit({
            html: true,    // Allow inline SVG
            linkify: true,
            breaks: false, // Must be false to preserve math
        }) : null;

        if (md) {
            // Disable escape rule to preserve TeX backslashes
            md.inline.ruler.disable(['escape']);
        }

        // --- DOM ELEMENTS ---
        const paperSelect = document.getElementById('paper-select');
        const paperContent = document.getElementById('paper-content');
        const desktopNav = document.getElementById('desktop-nav');
        const mobileNavList = document.getElementById('mobile-nav-list');
        const mobileDrawer = document.getElementById('mobile-drawer');
        const mobileDrawerBackdrop = document.getElementById('mobile-drawer-backdrop');
        const mobileJumpTrigger = document.getElementById('mobile-jump-trigger');
        const drawerClose = document.getElementById('drawer-close');

        // --- INIT ---
        async function init() {
            try {
                // Determine Payload Path
                const response = await fetch(RTQ_PAPERS_PAYLOAD_PATH);
                if (!response.ok) throw new Error("Fetch failed");
                payload = await response.json();
                
                populatePaperSelector();
                
                // Load first paper by default
                if (payload.papers && payload.papers.length > 0) {
                    loadPaper(payload.papers[0].key);
                }
            } catch (e) {
                console.error(e);
                renderError();
            }
        }

        function renderError() {
            paperContent.innerHTML = `<div class="p-8 border border-hairline rounded bg-paper text-center text-primary font-medium">PAPERS PAYLOAD MISSING</div>`;
            paperSelect.innerHTML = `<option>Error</option>`;
            paperSelect.disabled = true;
        }

        function populatePaperSelector() {
            paperSelect.innerHTML = '';
            payload.papers.forEach(p => {
                const opt = document.createElement('option');
                opt.value = p.key;
                opt.textContent = p.label;
                paperSelect.appendChild(opt);
            });
            paperSelect.addEventListener('change', (e) => {
                loadPaper(e.target.value);
            });
        }

        // --- PAPER LOADING ---
        function loadPaper(key) {
            currentPaperKey = key;
            const paper = payload.papers.find(p => p.key === key);
            if (!paper) return;

            // Reset Expanded State based on defaults
            expandedState.clear();
            // Default expandedAll is true unless explicitly false
            const defaultExpanded = paper.defaults?.expandedAll !== false;
            
            // Helper to recursively set default state for questions with solutionDetails
            const initNodes = (nodes) => {
                nodes.forEach(node => {
                    if (node.solutionBlock?.solutionDetails) {
                        expandedState.set(node.id, defaultExpanded);
                    }
                    if (node.children) initNodes(node.children);
                });
            };

            if (paper.questions) initNodes(paper.questions);
            if (paper.sections) paper.sections.forEach(s => initNodes(s.questions));

            // Render
            renderPaperContent(paper);
            renderNavigation(paper);

            // Post-Render: KaTeX
            renderMathInElement(document.body, {
                delimiters: [
                    {left: '$$', right: '$$', display: true},
                    {left: '$', right: '$', display: false}
                ],
                throwOnError: false
            });
        }

        // --- RENDERING: CONTENT ---
        function renderPaperContent(paper) {
            paperContent.innerHTML = '';
            
            // Container for the paper surface
            const paperSurface = document.createElement('div');
            paperSurface.className = "bg-paper rounded-sm shadow-sm border border-hairline/50 p-6 md:p-12 min-h-[600px]";
            
            // Header if needed (Paper Label is in selector, but maybe useful on page? Brief says "Paper as a single linear document". Brief doesn't mandate a title on the page, just content.)
            // We will stick to rendering the questions/sections structure.

            if (paper.sections) {
                paper.sections.forEach((section, index) => {
                    // Section Header (only if label is present)
                    if (section.label && section.label.trim().length > 0) {
                        const header = document.createElement('div');
                        header.className = "text-xl font-medium text-primary mb-8 border-b border-hairline pb-2";
                        header.textContent = `Section ${section.label}`;
                        if (index > 0) header.className += " mt-12";
                        paperSurface.appendChild(header);
                    }
                    // Questions List
                    const list = document.createElement('div');
                    list.className = "space-y-12"; // Top-level inter-question spacing
                    section.questions.forEach(q => {
                        list.appendChild(renderQuestionNode(q, 0));
                    });
                    paperSurface.appendChild(list);
                });
            } else if (paper.questions) {
                const list = document.createElement('div');
                list.className = "space-y-12"; // Top-level inter-question spacing
                paper.questions.forEach(q => {
                    list.appendChild(renderQuestionNode(q, 0));
                });
                paperSurface.appendChild(list);
            }

            paperContent.appendChild(paperSurface);
        }

        function renderQuestionNode(node, depth) {
            const container = document.createElement('div');
            container.id = `q-${node.id}`;
            container.className = "group"; // For potential hover hooks

            // 1. Question Body (Identifier + Prompt)
            const body = document.createElement('div');
            body.className = "flex flex-col gap-2";

            const identifier = document.createElement('div');
            identifier.className = "text-secondary font-medium text-sm";
            identifier.textContent = node.id;
            
            const prompt = document.createElement('div');
            prompt.className = "text-primary text-base md:text-lg leading-relaxed max-w-none prose prose-p:my-2 prose-ul:my-2 prose-table:my-2";
            prompt.innerHTML = renderMarkdown(node.question);

            body.appendChild(identifier);
            body.appendChild(prompt);
            container.appendChild(body);

            // 2. Solution Block (Optional)
            if (node.solutionBlock) {
                const sb = node.solutionBlock;
                const blockContainer = document.createElement('div');
                blockContainer.className = "mt-6 border-l-2 border-hairline pl-4 md:pl-6";

                // A. Answer (Optional)
                if (sb.answer) {
                    const answerDiv = document.createElement('div');
                    answerDiv.className = "mb-4";
                    
                    const label = document.createElement('div');
                    label.className = "text-xs font-bold text-accent uppercase tracking-wide mb-1";
                    label.textContent = "Answer";
                    
                    const content = document.createElement('div');
                    content.className = "text-primary font-medium text-lg prose";
                    content.innerHTML = renderMarkdown(sb.answer);

                    answerDiv.appendChild(label);
                    answerDiv.appendChild(content);
                    blockContainer.appendChild(answerDiv);
                }

                // B. Solution Details (Optional)
                if (sb.solutionDetails) {
                    const sd = sb.solutionDetails;
                    const isExpanded = expandedState.get(node.id);

                    // Toggle Control
                    const toggleBtn = document.createElement('button');
                    toggleBtn.className = "flex items-center gap-2 text-sm font-medium text-accent hover:text-primary transition-colors focus:outline-none mb-2";
                    toggleBtn.innerHTML = `
                        <span>${isExpanded ? 'Hide working' : 'Show working'}</span>
                        <i class="ph ph-caret-${isExpanded ? 'up' : 'down'} text-base"></i>
                    `;
                    toggleBtn.onclick = () => {
                        const newState = !expandedState.get(node.id);
                        expandedState.set(node.id, newState);
                        // Re-render this specific question node wrapper content would be expensive.
                        // Instead, efficient toggle implementation:
                        // Find the region and toggle hidden class, update text.
                        const region = blockContainer.querySelector('.sd-region');
                        if (newState) {
                            region.classList.remove('hidden');
                            toggleBtn.querySelector('span').textContent = 'Hide working';
                            toggleBtn.querySelector('i').className = 'ph ph-caret-up text-base';
                        } else {
                            region.classList.add('hidden');
                            toggleBtn.querySelector('span').textContent = 'Show working';
                            toggleBtn.querySelector('i').className = 'ph ph-caret-down text-base';
                        }
                    };
                    blockContainer.appendChild(toggleBtn);

                    // Details Region
                    const region = document.createElement('div');
                    region.className = `sd-region mt-2 bg-wash rounded p-4 md:p-6 space-y-6 ${isExpanded ? '' : 'hidden'}`;

                    // i. Keep in Mind (Optional)
                    if (sd.keepInMind) {
                        const section = document.createElement('div');
                        section.className = "space-y-2";
                        const hdr = document.createElement('div');
                        hdr.className = "flex items-center gap-2 text-sm font-bold text-secondary";
                        hdr.innerHTML = `<i class="ph ph-lightbulb"></i> <span>Keep in mind</span>`;
                        const bdy = document.createElement('div');
                        bdy.className = "text-sm text-secondary prose prose-sm leading-relaxed";
                        bdy.innerHTML = renderMarkdown(sd.keepInMind);
                        section.appendChild(hdr);
                        section.appendChild(bdy);
                        region.appendChild(section);
                    }

                    // ii. Formulas Used (Optional)
                    if (sd.formulasUsed) {
                        const section = document.createElement('div');
                        section.className = "space-y-2";
                        const hdr = document.createElement('div');
                        hdr.className = "text-sm font-bold text-secondary";
                        hdr.textContent = "Formulas used";
                        const bdy = document.createElement('div');
                        bdy.className = "text-sm text-secondary font-mono bg-white/50 p-2 rounded border border-hairline/50 prose prose-sm";
                        bdy.innerHTML = renderMarkdown(sd.formulasUsed);
                        section.appendChild(hdr);
                        section.appendChild(bdy);
                        region.appendChild(section);
                    }

                    // iii. Working (Optional)
                    if (sd.working) {
                        const section = document.createElement('div');
                        section.className = "space-y-2";
                        const hdr = document.createElement('div');
                        hdr.className = "text-sm font-bold text-secondary";
                        hdr.textContent = "Working";
                        const bdy = document.createElement('div');
                        bdy.className = "text-base text-primary prose prose-p:my-2 leading-relaxed";
                        bdy.innerHTML = renderMarkdown(sd.working);
                        section.appendChild(hdr);
                        section.appendChild(bdy);
                        region.appendChild(section);
                    }

                    // iv. Alternative Working (Optional Array)
                    if (sd.alternativeWorking && Array.isArray(sd.alternativeWorking)) {
                        sd.alternativeWorking.forEach((aw, idx) => {
                            // Separator if following other content
                            const sep = document.createElement('div');
                            sep.className = "border-t border-hairline my-4";
                            region.appendChild(sep);

                            const section = document.createElement('div');
                            section.className = "space-y-2";
                            const hdr = document.createElement('div');
                            hdr.className = "text-sm font-bold text-secondary";
                            hdr.textContent = "Alternative working";
                            const bdy = document.createElement('div');
                            bdy.className = "text-base text-primary prose prose-p:my-2 leading-relaxed";
                            bdy.innerHTML = renderMarkdown(aw);
                            section.appendChild(hdr);
                            section.appendChild(bdy);
                            region.appendChild(section);
                        });
                    }

                    blockContainer.appendChild(region);
                }
                
                container.appendChild(blockContainer);
            }

            // 3. Children (Recursive)
            if (node.children && node.children.length > 0) {
                const childrenContainer = document.createElement('div');
                // Vertical separation, optional indentation handled by adaptive padding
                childrenContainer.className = "mt-6 space-y-6 md:pl-4 lg:pl-8"; 
                node.children.forEach(child => {
                    childrenContainer.appendChild(renderQuestionNode(child, depth + 1));
                });
                container.appendChild(childrenContainer);
            }

            return container;
        }

        function renderMarkdown(text) {
            if (!text) return '';
            if (!md) return text; // Fallback
            return md.render(text);
        }

        // --- RENDERING: NAVIGATION ---
        function renderNavigation(paper) {
            // Clear existing
            desktopNav.innerHTML = '';
            mobileNavList.innerHTML = '';

            const navItems = [];

            // Helper to build flat list
            const processNodes = (nodes, sectionLabel = null) => {
                if(sectionLabel) {
                    navItems.push({ type: 'section', label: sectionLabel });
                }
                const traverse = (list, depth) => {
                    list.forEach(q => {
                        navItems.push({ type: 'question', id: q.id, depth: depth });
                        if (q.children) traverse(q.children, depth + 1);
                    });
                };
                traverse(nodes, 0);
            };

            if (paper.sections) {
                paper.sections.forEach(s => {
                    processNodes(s.questions, s.label);
                });
            } else if (paper.questions) {
                processNodes(paper.questions);
            }

            // Render List
            const listEl = document.createElement('ul');
            listEl.className = "space-y-1";

            navItems.forEach(item => {
                const li = document.createElement('li');
                
                if (item.type === 'section') {
                    // Non-clickable section label
                    // Only render if label exists (brief says omit if empty)
                    if (item.label && item.label.trim()) {
                        li.className = "mt-4 mb-2 text-xs font-bold text-secondary uppercase tracking-wider pl-0";
                        li.textContent = item.label;
                    } else {
                        return; // skip empty li
                    }
                } else {
                    // Question Link
                    const a = document.createElement('a');
                    a.href = `#q-${item.id}`;
                    // Hierarchy via type scale/quietness (Stage 5.4.5)
                    // Top level: normal weight. Nested: lighter/smaller.
                    // Flat alignment (pl-0).
                    const isTop = item.depth === 0;
                    a.className = `block py-1 text-sm transition-colors hover:text-accent focus:outline-none focus:text-accent
                        ${isTop ? 'text-primary font-medium' : 'text-secondary font-normal text-xs'}`;
                    
                    // Simple Active State Logic (Click driven for prototype simplicity, could be intersection observer)
                    a.onclick = (e) => {
                        // Reset all actives
                        document.querySelectorAll('nav a').forEach(el => el.classList.remove('text-accent', 'font-bold'));
                        e.target.classList.add('text-accent'); 
                        if(isTop) e.target.classList.add('font-bold');
                        
                        // Close drawer on mobile
                        closeMobileDrawer();
                    };

                    a.textContent = item.id;
                    li.appendChild(a);
                }
                listEl.appendChild(li);
            });

            // Clone for both views
            desktopNav.appendChild(listEl.cloneNode(true));
            mobileNavList.appendChild(listEl.cloneNode(true));

            // Setup active state listeners for the newly added elements
            // (Simple implementation: highlight clicked)
            const setupLinks = (root) => {
                root.querySelectorAll('a').forEach(a => {
                    a.addEventListener('click', (e) => {
                        // Visual update
                        const allLinks = document.querySelectorAll('nav a');
                        allLinks.forEach(l => {
                            l.classList.remove('text-accent', 'font-bold');
                            // reset to base classes
                            const d = l.getAttribute('data-depth'); // Not stored, relying on class reset is tricky without rebuild.
                            // Simplification: Just remove active util classes, base classes remain.
                        });
                        e.target.classList.add('text-accent');
                        closeMobileDrawer();
                    });
                });
            };
            setupLinks(desktopNav);
            setupLinks(mobileNavList);
        }

        // --- MOBILE DRAWER ---
        function openMobileDrawer() {
            mobileDrawerBackdrop.classList.remove('hidden');
            // Trigger reflow
            void mobileDrawerBackdrop.offsetWidth;
            mobileDrawerBackdrop.classList.remove('opacity-0');
            
            mobileDrawer.classList.remove('translate-x-full');
        }

        function closeMobileDrawer() {
            mobileDrawer.classList.add('translate-x-full');
            mobileDrawerBackdrop.classList.add('opacity-0');
            setTimeout(() => {
                mobileDrawerBackdrop.classList.add('hidden');
            }, 300);
        }

        mobileJumpTrigger.addEventListener('click', openMobileDrawer);
        drawerClose.addEventListener('click', closeMobileDrawer);
        mobileDrawerBackdrop.addEventListener('click', closeMobileDrawer);

        // --- RUN ---
        init();

    </script>
</body>
</html>

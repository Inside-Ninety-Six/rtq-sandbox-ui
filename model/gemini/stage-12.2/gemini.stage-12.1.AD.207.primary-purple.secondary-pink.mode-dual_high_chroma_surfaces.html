<!DOCTYPE html>
<html lang="en">
<head>
  <!-- RTQ_RUN {"generator":"rtq-prototype-batch","model":"gemini-3-pro-preview","prefix":"gemini.stage-12.1","variant":"AD","indexWithinVariant":"207","totalWithinVariant":"440","hueFamily":"","intensityMode":"","primaryHueFamily":"purple","secondaryHueFamily":"pink","dualIntensityMode":"dual_high_chroma_surfaces","timestamp":"2026-01-10T11:14:17.621Z"} -->
  <meta name="rtq-run" content='{&quot;generator&quot;:&quot;rtq-prototype-batch&quot;,&quot;model&quot;:&quot;gemini-3-pro-preview&quot;,&quot;prefix&quot;:&quot;gemini.stage-12.1&quot;,&quot;variant&quot;:&quot;AD&quot;,&quot;indexWithinVariant&quot;:&quot;207&quot;,&quot;totalWithinVariant&quot;:&quot;440&quot;,&quot;hueFamily&quot;:&quot;&quot;,&quot;intensityMode&quot;:&quot;&quot;,&quot;primaryHueFamily&quot;:&quot;purple&quot;,&quot;secondaryHueFamily&quot;:&quot;pink&quot;,&quot;dualIntensityMode&quot;:&quot;dual_high_chroma_surfaces&quot;,&quot;timestamp&quot;:&quot;2026-01-10T11:14:17.621Z&quot;}'>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RTQ Maths Paper Solution Viewer</title>

    <!-- Tailwind CSS (via CDN for prototyping speed & utility constraints) -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- KaTeX CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <!-- KaTeX JS -->
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>

    <!-- Markdown-it -->
    <script src="https://cdn.jsdelivr.net/npm/markdown-it@14.0.0/dist/markdown-it.min.js"></script>

    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <script>
        // --- STAGE 6 ADD-ON: ColorLab D (Dual-Accent Palette) Configuration ---
        // Mode 3: dual_high_chroma_surfaces (Blue Primary / Amber Secondary)
        // Primary Hue: Blue (250)
        // Secondary Hue: Amber (85)
        
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        // Surfaces (Mode 3: High Chroma surfaces derived from Primary Hue)
                        page: 'oklch(0.94 0.06 250)',   // Chromatic Page
                        frame: 'oklch(0.92 0.07 250)',  // Chromatic Frame (Nav)
                        paper: 'oklch(0.98 0.03 250)',  // Remaining Major Surface (Paper - cleaner)
                        
                        // Text (Mode 3: Neutral-ish)
                        primary: 'oklch(0.20 0.015 250)',
                        secondary: 'oklch(0.45 0.015 250)',
                        
                        // Accents (Mode 3: Primary C 0.12-0.20, Secondary C 0.10-0.18)
                        accent: {
                            DEFAULT: 'oklch(0.55 0.18 250)', // Primary (Blue)
                            secondary: 'oklch(0.65 0.16 85)', // Secondary (Amber)
                        },
                        
                        // Wash (Mode 3: C 0.05-0.10, Primary derived)
                        wash: 'oklch(0.95 0.06 250)',
                        
                        // Borders
                        hairline: 'oklch(0.85 0.04 250)',
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                    }
                }
            }
        }
    </script>

    <style>
        /* Base Reset & Typography */
        body {
            background-color: theme('colors.page');
            color: theme('colors.primary');
            font-family: theme('fontFamily.sans');
            -webkit-font-smoothing: antialiased;
            overflow-y: scroll; /* Force scrollbar stability */
        }

        /* --- KaTeX Containment Invariant --- */
        /* Never allow horizontal scroll on the page */
        html, body {
            overflow-x: hidden; 
        }

        /* Allow scroll ONLY within math blocks */
        .katex-display {
            overflow-x: auto;
            overflow-y: hidden;
            padding-block: 0.5rem;
            max-width: 100%;
            /* Scrollbar hiding for math */
            scrollbar-width: thin;
            scrollbar-color: theme('colors.hairline') transparent;
        }

        /* Inline math background rule: Transparent */
        .katex {
            background-color: transparent !important;
        }

        /* Block math underlay (optional/subtle) */
        .katex-display {
            /* No heavy background, just standard spacing */
        }

        /* --- Scrollbar Hiding for Navigation --- */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        /* --- Layout Utilities --- */
        .paper-shadow {
            /* Minimal depth, mostly rely on surface difference */
            box-shadow: 0 1px 3px 0 rgb(0 0 0 / 0.05);
        }

        /* Markdown Content Styling */
        .prose p {
            margin-bottom: 0.75em;
            line-height: 1.6;
        }
        .prose ul {
            list-style-type: disc;
            padding-left: 1.25em;
            margin-bottom: 0.75em;
        }
        .prose ol {
            list-style-type: decimal;
            padding-left: 1.25em;
            margin-bottom: 0.75em;
        }
        /* Minimal tables */
        .prose table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 1em;
            font-size: 0.95em;
        }
        .prose th, .prose td {
            border: 1px solid theme('colors.hairline');
            padding: 0.5em;
            text-align: left;
        }
        .prose th {
            font-weight: 600;
            color: theme('colors.primary');
        }

        /* Focus Visibility (Primary Accent) */
        :focus-visible {
            outline: 2px solid theme('colors.accent.DEFAULT');
            outline-offset: 2px;
        }

        /* Drawer Transition */
        .drawer-overlay {
            transition: opacity 0.2s ease-in-out;
        }
        .drawer-content {
            transition: transform 0.3s cubic-bezier(0.16, 1, 0.3, 1);
        }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center">

    <!-- Top Controls (Aligned to Shell) -->
    <header class="w-full max-w-[1200px] px-4 md:px-8 py-4 flex items-center justify-between shrink-0 z-20">
        <!-- Paper Selector -->
        <div class="flex items-center gap-3">
            <label for="paper-select" class="text-sm font-medium text-secondary">Paper:</label>
            <select id="paper-select" class="bg-paper border border-hairline rounded px-3 py-1.5 text-sm font-medium text-primary focus:border-accent hover:border-accent-secondary transition-colors cursor-pointer min-w-[200px]">
                <option value="" disabled selected>Loading papers...</option>
            </select>
        </div>

        <!-- Mobile Jump To Trigger -->
        <button id="mobile-jump-trigger" class="md:hidden flex items-center gap-2 text-sm font-medium text-accent hover:text-accent-secondary transition-colors">
            <span class="mr-1">Jump to</span>
            <i data-lucide="list" class="w-5 h-5"></i>
        </button>
    </header>

    <!-- DocumentFrameShell -->
    <div class="flex-1 w-full max-w-[1200px] grid grid-cols-1 md:grid-cols-[240px_1fr] gap-0 md:gap-12 px-4 md:px-8 pb-20 relative">

        <!-- Navigation Rail (Desktop) -->
        <aside class="hidden md:block relative">
            <div class="sticky top-8 max-h-[calc(100vh-4rem)] overflow-y-auto no-scrollbar py-2" id="desktop-nav-container">
                <!-- Nav Content Generated Here -->
            </div>
        </aside>

        <!-- Paper Content Column -->
        <main id="paper-region" class="w-full min-w-0">
            <!-- Paper Surface -->
            <div id="paper-surface" class="bg-paper rounded-sm min-h-[500px] px-6 py-10 md:px-12 md:py-16 paper-shadow relative">
                <div id="paper-content-root">
                    <!-- Questions Injected Here -->
                    <div class="flex items-center justify-center h-40 text-secondary">
                        Loading content...
                    </div>
                </div>
            </div>
        </main>

    </div>

    <!-- Mobile Navigation Drawer -->
    <div id="mobile-drawer" class="fixed inset-0 z-50 hidden" aria-hidden="true">
        <!-- Scrim -->
        <div id="drawer-scrim" class="absolute inset-0 bg-primary/20 backdrop-blur-[1px] opacity-0 drawer-overlay"></div>
        <!-- Drawer Panel -->
        <div id="drawer-panel" class="absolute right-0 top-0 bottom-0 w-[280px] bg-paper shadow-xl transform translate-x-full drawer-content flex flex-col">
            <div class="flex items-center justify-between p-4 border-b border-hairline">
                <h2 class="text-lg font-medium text-primary">Jump to</h2>
                <button id="drawer-close" class="p-2 text-secondary hover:text-primary">
                    <i data-lucide="x" class="w-5 h-5"></i>
                </button>
            </div>
            <div class="flex-1 overflow-y-auto p-4" id="mobile-nav-list">
                <!-- Mobile Nav Items -->
            </div>
        </div>
    </div>

    <!-- MAIN SCRIPT -->
    <script>
        // --- STAGE 0: CONSTANTS ---
        const RTQ_PAPERS_PAYLOAD_PATH = "../../../payload/rtq.papers.payload.v2.json";
        const RTQ_SHADCN_TOKEN_PROFILES_PATH = "../../../payload/rtq.shadcn.token.profiles.v1.json";

        // --- STATE ---
        let state = {
            papers: [],
            currentPaperId: null,
            expandedWorkings: new Set() // Stores IDs of questions with expanded workings
        };

        // --- MARKDOWN SETUP ---
        const md = window.markdownit ? window.markdownit({
            html: true,
            linkify: true,
            breaks: false, // Invariant: Must be false for KaTeX
        }) : null;

        if (md) {
            md.inline.ruler.disable(['escape']); // Invariant: Preserve backslashes for KaTeX
        }

        // --- INITIALIZATION ---
        document.addEventListener('DOMContentLoaded', async () => {
            lucide.createIcons();
            await loadPayload();
            setupMobileDrawer();
        });

        async function loadPayload() {
            try {
                const response = await fetch(RTQ_PAPERS_PAYLOAD_PATH);
                if (!response.ok) throw new Error("Payload not found");
                const data = await response.json();
                
                state.papers = data.papers || [];
                
                if (state.papers.length === 0) {
                    renderError("NO PAPERS FOUND IN PAYLOAD");
                    return;
                }

                initPaperSelector();
                
                // Load first paper by default
                switchPaper(state.papers[0].key);

            } catch (e) {
                console.error(e);
                renderError("PAPERS PAYLOAD MISSING");
            }
        }

        function renderError(msg) {
            const root = document.getElementById('paper-content-root');
            root.innerHTML = `<div class="text-center p-10 font-medium text-secondary tracking-widest">${msg}</div>`;
            document.getElementById('paper-select').innerHTML = `<option disabled selected>Error</option>`;
        }

        function initPaperSelector() {
            const selector = document.getElementById('paper-select');
            selector.innerHTML = '';
            state.papers.forEach(p => {
                const opt = document.createElement('option');
                opt.value = p.key;
                opt.textContent = p.label || p.key;
                selector.appendChild(opt);
            });

            selector.addEventListener('change', (e) => {
                switchPaper(e.target.value);
            });
        }

        function switchPaper(paperKey) {
            state.currentPaperId = paperKey;
            const paper = state.papers.find(p => p.key === paperKey);
            if (!paper) return;

            // Reset state
            state.expandedWorkings.clear();
            const defaultExpand = paper.defaults?.expandedAll !== false;

            // Render Content
            const root = document.getElementById('paper-content-root');
            root.innerHTML = '';

            // Handle Sectioned vs Flat
            let allQuestions = []; // Flattened list for navigation generation

            if (paper.sections && paper.sections.length > 0) {
                paper.sections.forEach((section, index) => {
                    // Render Section Header if label exists
                    if (section.label && section.label.trim().length > 0) {
                        const secHeader = document.createElement('div');
                        secHeader.className = "text-secondary font-medium text-lg mb-6 border-b border-hairline pb-2 mt-8 first:mt-0";
                        secHeader.textContent = `Section ${section.label}`;
                        root.appendChild(secHeader);
                    }
                    
                    // Recursive render of questions in section
                    renderQuestionList(section.questions, root, defaultExpand);
                    
                    // Add to flattened list for nav with section context
                    allQuestions.push({ type: 'section', label: section.label });
                    allQuestions = allQuestions.concat(flattenQuestions(section.questions));
                });
            } else if (paper.questions) {
                renderQuestionList(paper.questions, root, defaultExpand);
                allQuestions = flattenQuestions(paper.questions);
            }

            // Render Math
            renderMathInElement(root, {
                delimiters: [
                    {left: '$$', right: '$$', display: true},
                    {left: '$', right: '$', display: false}
                ],
                throwOnError: false
            });

            // Rebuild Navigation
            renderNavigation(allQuestions);
            
            // Re-init icons
            lucide.createIcons();
        }

        function flattenQuestions(questions) {
            let flat = [];
            if (!questions) return flat;
            questions.forEach(q => {
                flat.push({ type: 'question', id: q.id, displayId: q.id });
                if (q.children) {
                    flat = flat.concat(flattenQuestions(q.children));
                }
            });
            return flat;
        }

        // --- CONTENT RENDERING ---

        function renderQuestionList(questions, container, defaultExpand) {
            if (!questions) return;
            questions.forEach(q => {
                container.appendChild(createQuestionNode(q, defaultExpand));
            });
        }

        function createQuestionNode(q, defaultExpand) {
            const node = document.createElement('div');
            node.className = "mb-10 last:mb-0 relative group"; // Top-level spacing
            node.id = `q-${sanitizeId(q.id)}`;

            // 1. Question Body
            const qBody = document.createElement('div');
            qBody.className = "mb-4"; // Space between question and solution block

            // Identifier
            const qId = document.createElement('div');
            qId.className = "text-secondary text-sm font-semibold mb-1";
            qId.textContent = q.id;
            qBody.appendChild(qId);

            // Prompt
            const qPrompt = document.createElement('div');
            qPrompt.className = "prose text-primary max-w-none text-base md:text-lg leading-relaxed";
            qPrompt.innerHTML = renderMarkdown(q.question);
            qBody.appendChild(qPrompt);

            node.appendChild(qBody);

            // 2. Solution Block (Optional)
            if (q.solutionBlock) {
                const solBlock = document.createElement('div');
                solBlock.className = "pl-0 md:pl-4 border-l-0 md:border-l-2 border-transparent md:group-hover:border-hairline transition-colors"; // Alignment aid

                // A. Answer (Visible by default if present)
                if (q.solutionBlock.answer) {
                    const answerDiv = document.createElement('div');
                    answerDiv.className = "mb-4";
                    
                    const ansLabel = document.createElement('div');
                    ansLabel.className = "text-xs font-bold text-accent-secondary uppercase tracking-wider mb-1";
                    ansLabel.textContent = "Answer";
                    answerDiv.appendChild(ansLabel);

                    const ansContent = document.createElement('div');
                    ansContent.className = "prose text-primary font-medium";
                    ansContent.innerHTML = renderMarkdown(q.solutionBlock.answer);
                    answerDiv.appendChild(ansContent);

                    solBlock.appendChild(answerDiv);
                }

                // B. Solution Details (Expandable)
                if (q.solutionBlock.solutionDetails) {
                    const details = q.solutionBlock.solutionDetails;
                    const hasContent = details.working || details.alternativeWorking || details.keepInMind || details.formulasUsed;
                    
                    if (hasContent) {
                        const isExpanded = defaultExpand;
                        if (isExpanded) state.expandedWorkings.add(q.id);

                        // Disclosure Control
                        const toggleBtn = document.createElement('button');
                        toggleBtn.className = "flex items-center gap-2 text-sm font-medium text-accent hover:text-accent font-semibold transition-colors focus:outline-none focus-visible:ring-2 ring-accent rounded px-1 -ml-1 py-1";
                        toggleBtn.innerHTML = `
                            <span class="btn-text">${isExpanded ? "Hide working" : "Show working"}</span>
                            <i data-lucide="chevron-down" class="w-4 h-4 transition-transform duration-200 ${isExpanded ? 'rotate-180' : ''}"></i>
                        `;
                        
                        // Expanded Region
                        const region = document.createElement('div');
                        region.className = `mt-3 bg-wash rounded-md overflow-hidden transition-all duration-300 ease-in-out ${isExpanded ? 'opacity-100 max-h-[5000px] p-4 md:p-6' : 'opacity-0 max-h-0 py-0 px-0'}`;
                        
                        // Internal Structure
                        const contentWrapper = document.createElement('div');
                        contentWrapper.className = "flex flex-col gap-6";

                        // Keep In Mind
                        if (details.keepInMind) {
                            const block = createDetailBlock("Keep in mind", details.keepInMind, "list-prose", true); // Pass icon flag logic if needed, simplify here
                            contentWrapper.appendChild(block);
                        }

                        // Formulas Used
                        if (details.formulasUsed) {
                            const block = createDetailBlock("Formulas used", details.formulasUsed, "text-sm");
                            contentWrapper.appendChild(block);
                        }

                        // Working (Primary)
                        if (details.working) {
                            const block = createDetailBlock("Working", details.working);
                            contentWrapper.appendChild(block);
                        }

                        // Alternative Working (Array)
                        if (details.alternativeWorking && Array.isArray(details.alternativeWorking)) {
                            details.alternativeWorking.forEach((alt, idx) => {
                                const block = createDetailBlock("Alternative working", alt);
                                // Separator for Alt working
                                block.classList.add("border-t", "border-hairline", "pt-6");
                                contentWrapper.appendChild(block);
                            });
                        } else if (details.alternativeWorking && typeof details.alternativeWorking === 'string') {
                             const block = createDetailBlock("Alternative working", details.alternativeWorking);
                             block.classList.add("border-t", "border-hairline", "pt-6");
                             contentWrapper.appendChild(block);
                        }

                        region.appendChild(contentWrapper);

                        // Interaction
                        toggleBtn.onclick = () => {
                            const expanding = !state.expandedWorkings.has(q.id);
                            if (expanding) {
                                state.expandedWorkings.add(q.id);
                                toggleBtn.querySelector('.btn-text').textContent = "Hide working";
                                toggleBtn.querySelector('i').classList.add('rotate-180');
                                region.classList.remove('opacity-0', 'max-h-0', 'py-0', 'px-0');
                                region.classList.add('opacity-100', 'max-h-[5000px]', 'p-4', 'md:p-6');
                            } else {
                                state.expandedWorkings.delete(q.id);
                                toggleBtn.querySelector('.btn-text').textContent = "Show working";
                                toggleBtn.querySelector('i').classList.remove('rotate-180');
                                region.classList.remove('opacity-100', 'max-h-[5000px]', 'p-4', 'md:p-6');
                                region.classList.add('opacity-0', 'max-h-0', 'py-0', 'px-0');
                            }
                        };

                        solBlock.appendChild(toggleBtn);
                        solBlock.appendChild(region);
                    }
                }
                node.appendChild(solBlock);
            }

            // 3. Children (Recursion)
            if (q.children && q.children.length > 0) {
                const childContainer = document.createElement('div');
                childContainer.className = "mt-6 ml-0 md:ml-6 pl-0 border-l-0 border-transparent"; // Indentation logic
                renderQuestionList(q.children, childContainer, defaultExpand);
                node.appendChild(childContainer);
            }

            return node;
        }

        function createDetailBlock(label, contentMarkdown, extraClasses = "", keepInMind = false) {
            const block = document.createElement('div');
            
            const header = document.createElement('div');
            header.className = "text-xs font-bold text-secondary uppercase tracking-wider mb-2 flex items-center gap-2";
            header.textContent = label;
            
            if (keepInMind) {
                const icon = document.createElement('i');
                icon.dataset.lucide = "lightbulb"; // Neutral icon
                icon.className = "w-3 h-3 text-secondary";
                header.prepend(icon);
            }

            block.appendChild(header);

            const body = document.createElement('div');
            body.className = `prose text-secondary ${extraClasses}`;
            // Anti-faded guardrail: ensure readability. Using text-secondary (oklch 0.45) which is readable against wash.
            body.innerHTML = renderMarkdown(contentMarkdown);
            block.appendChild(body);

            return block;
        }

        function renderMarkdown(text) {
            if (!text || !md) return text || "";
            return md.render(text);
        }

        function sanitizeId(id) {
            return id.replace(/[^a-zA-Z0-9-_]/g, '_');
        }

        // --- NAVIGATION ---

        function renderNavigation(flatList) {
            const desktopNav = document.getElementById('desktop-nav-container');
            const mobileNav = document.getElementById('mobile-nav-list');
            
            const navHTML = generateNavHTML(flatList);
            
            desktopNav.innerHTML = navHTML;
            mobileNav.innerHTML = navHTML;

            // Add Click Listeners
            const links = document.querySelectorAll('.nav-link');
            links.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const targetId = link.getAttribute('href').substring(1);
                    const el = document.getElementById(targetId);
                    if (el) {
                        // Smooth scroll
                        const offset = 80; // Header height
                        const bodyRect = document.body.getBoundingClientRect().top;
                        const elementRect = el.getBoundingClientRect().top;
                        const elementPosition = elementRect - bodyRect;
                        const offsetPosition = elementPosition - offset;

                        window.scrollTo({
                            top: offsetPosition,
                            behavior: "smooth"
                        });

                        // Update Active State
                        updateActiveNav(targetId);
                        
                        // Close drawer on mobile
                        closeMobileDrawer();
                    }
                });
            });
            
            // Intersection Observer for scroll tracking
            initScrollSpy(flatList);
        }

        function generateNavHTML(flatList) {
            let html = '<nav class="flex flex-col gap-1 text-sm">';
            
            flatList.forEach(item => {
                if (item.type === 'section') {
                    if (item.label && item.label.trim()) {
                        html += `
                            <div class="mt-4 mb-2 pt-2 border-t border-hairline first:mt-0 first:border-0">
                                <span class="px-2 text-xs font-bold text-secondary uppercase tracking-widest opacity-70 cursor-default">Section ${item.label}</span>
                            </div>
                        `;
                    } else {
                         // Empty section label - spacing only
                         html += `<div class="mt-2"></div>`;
                    }
                } else if (item.type === 'question') {
                    // Visual hierarchy via font size/opacity, flat indent
                    const isSub = item.id.length > 2 || item.id.includes('('); 
                    const classes = isSub 
                        ? "text-secondary font-normal text-xs py-1" 
                        : "text-primary font-medium text-sm py-1.5";
                        
                    html += `
                        <a href="#q-${sanitizeId(item.id)}" 
                           class="nav-link block px-2 rounded hover:bg-black/5 transition-colors ${classes}"
                           data-target="q-${sanitizeId(item.id)}">
                            ${item.displayId}
                        </a>
                    `;
                }
            });
            
            html += '</nav>';
            return html;
        }

        function updateActiveNav(targetId) {
            document.querySelectorAll('.nav-link').forEach(l => {
                l.classList.remove('font-bold', 'text-accent');
                if (l.dataset.target === targetId) {
                    l.classList.add('font-bold', 'text-accent'); // Weight + Color (Accent allowed in nav per override)
                }
            });
        }

        function initScrollSpy(flatList) {
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        updateActiveNav(entry.target.id);
                    }
                });
            }, { rootMargin: '-10% 0px -80% 0px' });

            flatList.forEach(item => {
                if (item.type === 'question') {
                    const el = document.getElementById(`q-${sanitizeId(item.id)}`);
                    if (el) observer.observe(el);
                }
            });
        }

        // --- MOBILE DRAWER ---
        function setupMobileDrawer() {
            const trigger = document.getElementById('mobile-jump-trigger');
            const drawer = document.getElementById('mobile-drawer');
            const closeBtn = document.getElementById('drawer-close');
            const scrim = document.getElementById('drawer-scrim');
            const panel = document.getElementById('drawer-panel');

            function open() {
                drawer.classList.remove('hidden');
                // Force reflow
                void drawer.offsetWidth;
                scrim.classList.remove('opacity-0');
                panel.classList.remove('translate-x-full');
            }

            function close() {
                scrim.classList.add('opacity-0');
                panel.classList.add('translate-x-full');
                setTimeout(() => {
                    drawer.classList.add('hidden');
                }, 300);
            }

            trigger.onclick = open;
            closeBtn.onclick = close;
            scrim.onclick = close;
            
            window.closeMobileDrawer = close;
        }

    </script>
</body>
</html>

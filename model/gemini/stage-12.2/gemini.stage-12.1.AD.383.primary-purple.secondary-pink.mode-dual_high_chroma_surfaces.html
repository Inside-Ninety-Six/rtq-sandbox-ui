<!DOCTYPE html>
<html lang="en">
<head>
  <!-- RTQ_RUN {"generator":"rtq-prototype-batch","model":"gemini-3-pro-preview","prefix":"gemini.stage-12.1","variant":"AD","indexWithinVariant":"383","totalWithinVariant":"440","hueFamily":"","intensityMode":"","primaryHueFamily":"purple","secondaryHueFamily":"pink","dualIntensityMode":"dual_high_chroma_surfaces","timestamp":"2026-01-10T23:39:58.469Z"} -->
  <meta name="rtq-run" content='{&quot;generator&quot;:&quot;rtq-prototype-batch&quot;,&quot;model&quot;:&quot;gemini-3-pro-preview&quot;,&quot;prefix&quot;:&quot;gemini.stage-12.1&quot;,&quot;variant&quot;:&quot;AD&quot;,&quot;indexWithinVariant&quot;:&quot;383&quot;,&quot;totalWithinVariant&quot;:&quot;440&quot;,&quot;hueFamily&quot;:&quot;&quot;,&quot;intensityMode&quot;:&quot;&quot;,&quot;primaryHueFamily&quot;:&quot;purple&quot;,&quot;secondaryHueFamily&quot;:&quot;pink&quot;,&quot;dualIntensityMode&quot;:&quot;dual_high_chroma_surfaces&quot;,&quot;timestamp&quot;:&quot;2026-01-10T23:39:58.469Z&quot;}'>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RTQ Maths Paper Solution Viewer</title>

<!-- Fonts -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">

<!-- KaTeX CSS (No SRI/Integrity per Stage 6 instructions) -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">

<!-- Markdown-it (No SRI/Integrity) -->
<script src="https://cdn.jsdelivr.net/npm/markdown-it@14.0.0/dist/markdown-it.min.js"></script>
<!-- KaTeX JS (No SRI/Integrity) -->
<script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>

<style>
/* 
    COLORLAB D: DUAL-ACCENT PALETTE (QUANTIFIED, LIGHT-ONLY)
    Mode: dual_high_chroma_surfaces
    Primary Hue: Blue (250)
    Secondary Hue: Amber (85)
*/
:root {
    /* Base Hues */
    --hue-pri: 250;
    --hue-sec: 85;

    /* 
       Surfaces (High Chroma Mode Requirements)
       Rule: At least 2 major surfaces C in [0.06..0.12], remaining in [0.03..0.07]
    */
    --color-page-bg: oklch(0.94 0.06 250);  /* Chromatic */
    --color-frame-bg: oklch(0.92 0.07 250); /* Chromatic */
    --color-paper-bg: oklch(0.98 0.03 250); /* Quieter but compliant */
    
    /* Wash Surface: C in [0.05..0.10] */
    --color-wash-bg: oklch(0.96 0.06 250);

    /* Text: Mostly neutral, primary C <= 0.015 */
    --color-text-pri: oklch(0.20 0.015 250);
    --color-text-sec: oklch(0.45 0.020 250);
    --color-text-quiet: oklch(0.55 0.020 250);

    /* Accents */
    /* Primary: C in [0.12..0.20] */
    --color-accent-pri: oklch(0.55 0.18 250); 
    
    /* Secondary: C in [0.10..0.18] - Restricted single role */
    --color-accent-sec: oklch(0.70 0.16 85);

    /* UI Elements */
    --color-divider: oklch(0.88 0.02 250); /* Quiet hairline */
    --color-focus-ring: var(--color-accent-pri);

    /* Spacing Units */
    --space-xs: 0.25rem;
    --space-sm: 0.5rem;
    --space-md: 1rem;
    --space-lg: 1.5rem;
    --space-xl: 2.5rem; /* Largest unit: between top-level questions */
    
    /* Typography */
    --font-base: 'Inter', system-ui, -apple-system, sans-serif;
}

/* Reset & Base */
*, *::before, *::after { box-sizing: border-box; }
body {
    margin: 0;
    font-family: var(--font-base);
    background-color: var(--color-page-bg);
    color: var(--color-text-pri);
    line-height: 1.5;
    overflow-y: scroll; /* Force scrollbar stability */
    -webkit-font-smoothing: antialiased;
}

button { font-family: inherit; }

/* 
   LAYOUT SHELL 
   Stage 3: DocumentFrameShell
*/
.app-container {
    display: flex;
    flex-direction: column;
    min-height: 100vh;
    align-items: center;
}

/* Top Controls */
.top-controls {
    width: 100%;
    max-width: 1200px; /* Aligned to shell width */
    padding: var(--space-md) var(--space-lg);
    display: flex;
    justify-content: space-between;
    align-items: center;
    position: relative;
    z-index: 10;
}

.paper-selector {
    padding: var(--space-xs) var(--space-sm);
    font-size: 0.95rem;
    border: 1px solid var(--color-divider);
    border-radius: 4px;
    background: var(--color-paper-bg);
    color: var(--color-text-pri);
}

.jump-to-trigger {
    display: none; /* Desktop default */
    padding: var(--space-xs) var(--space-md);
    font-size: 0.9rem;
    font-weight: 500;
    border: none;
    border-radius: 4px;
    background-color: var(--color-accent-sec); /* Secondary Hue Usage */
    color: oklch(0.2 0.05 85);
    cursor: pointer;
}

/* Document Frame Shell */
.document-frame-shell {
    width: 100%;
    max-width: 1200px;
    flex: 1;
    display: flex;
    background-color: var(--color-frame-bg);
    border-left: 1px solid var(--color-divider); /* Subtle definition */
    border-right: 1px solid var(--color-divider);
    position: relative;
}

/* 
   NAVIGATION RAIL (Desktop)
   Sticky, scrollable independently if needed
*/
.nav-rail {
    width: 240px;
    flex-shrink: 0;
    position: sticky;
    top: 0;
    height: 100vh;
    overflow-y: auto;
    padding: var(--space-lg) var(--space-md);
    /* Scrollbar hiding */
    scrollbar-width: none; 
    -ms-overflow-style: none;
    border-right: 1px solid var(--color-divider); /* Optional separator */
}
.nav-rail::-webkit-scrollbar { display: none; }

.nav-list {
    display: flex;
    flex-direction: column;
    gap: 2px;
}

/* Navigation Typography & Hierarchy (Flat List) */
.nav-item {
    display: block;
    text-decoration: none;
    color: var(--color-text-sec);
    padding: 4px 0;
    font-size: 0.9rem;
    cursor: pointer;
    border-radius: 2px;
    /* Focus styles */
    outline: none;
}
.nav-item:focus-visible {
    box-shadow: 0 0 0 2px var(--color-focus-ring);
}
.nav-item:hover {
    color: var(--color-text-pri);
}
.nav-item.active {
    font-weight: 600;
    color: var(--color-accent-pri); /* Primary Hue Usage */
}

/* Sub-question hierarchy via type scale/color only */
.nav-item[data-depth="1"] { font-size: 0.85rem; color: var(--color-text-sec); }
.nav-item[data-depth="2"] { font-size: 0.8rem; color: var(--color-text-quiet); }

/* Section Labels */
.nav-section-label {
    margin-top: var(--space-md);
    margin-bottom: var(--space-xs);
    font-size: 0.75rem;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: var(--color-text-quiet);
    font-weight: 600;
    pointer-events: none;
}
.nav-section-label:first-child { margin-top: 0; }

/* 
   PAPER CONTENT REGION
*/
.paper-column {
    flex: 1;
    min-width: 0; /* Prevent flex overflow */
    padding: var(--space-xl) var(--space-xl) var(--space-xl) var(--space-xl);
}

.paper-surface {
    background-color: var(--color-paper-bg);
    min-height: 80vh;
    padding: var(--space-xl);
    /* No framing effects per Stage 3/5 */
}

/* Section Headers in Paper */
.paper-section-header {
    font-size: 1.1rem;
    font-weight: 600;
    color: var(--color-text-sec);
    margin-top: var(--space-xl);
    margin-bottom: var(--space-lg);
    border-bottom: 1px solid var(--color-divider);
    padding-bottom: var(--space-xs);
}
.paper-section-header:first-child { margin-top: 0; }

/* 
   QUESTION NODE STRUCTURE
*/
.question-node {
    margin-bottom: var(--space-xl); /* Largest spacing unit */
    scroll-margin-top: var(--space-lg);
}

.question-body {
    display: flex;
    gap: var(--space-sm);
    color: var(--color-text-pri);
    font-size: 1.05rem;
    line-height: 1.6;
}

.q-id {
    font-weight: 600;
    color: var(--color-text-sec);
    min-width: 2rem;
    flex-shrink: 0;
}
.q-prompt {
    flex: 1;
}

/* Solution Block */
.solution-block {
    margin-top: var(--space-md);
    margin-left: 2.5rem; /* Align roughly with text */
    display: flex;
    flex-direction: column;
    gap: var(--space-md);
}

/* Answer */
.answer-region {
    display: flex;
    gap: var(--space-sm);
    font-size: 1rem;
    color: var(--color-text-pri);
    align-items: baseline;
}
.answer-label {
    font-weight: 600;
    color: var(--color-text-sec);
    font-size: 0.9rem;
}

/* Solution Details Region */
.solution-details-container {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
}

.disclosure-control {
    background: none;
    border: none;
    padding: 0;
    font-size: 0.9rem;
    color: var(--color-accent-pri);
    cursor: pointer;
    font-weight: 500;
    display: flex;
    align-items: center;
    gap: 4px;
}
.disclosure-control:hover {
    text-decoration: underline;
}
.disclosure-control:focus-visible {
    outline: 2px solid var(--color-focus-ring);
    outline-offset: 2px;
    border-radius: 2px;
}

.solution-details-content {
    width: 100%;
    margin-top: var(--space-sm);
    background-color: var(--color-wash-bg); /* Surface Diff */
    padding: var(--space-md);
    /* No heavy borders/radius per Stage 3 */
    display: none; /* Hidden by default */
}
.solution-details-content.expanded {
    display: block;
    /* Simple transition logic handled via display toggle for robustness, 
       Stage 5 allows explanatory motion but implementation relies on JS class */
}

/* Solution Subsections */
.sd-section {
    margin-bottom: var(--space-md);
}
.sd-section:last-child { margin-bottom: 0; }

.sd-label {
    font-size: 0.85rem;
    font-weight: 600;
    color: var(--color-text-sec);
    margin-bottom: var(--space-xs);
    display: block;
}

.sd-body {
    font-size: 0.95rem;
    color: var(--color-text-pri); /* Readable contrast */
    line-height: 1.5;
}

/* Keep in mind */
.sd-keep-in-mind .sd-body {
    /* Slightly higher contrast per Stage 5.9.2 */
    color: var(--color-text-pri); 
}
.sd-keep-in-mind ul {
    margin: 0;
    padding-left: 1.2em;
}

/* Formulas Used */
.sd-formulas .sd-body {
    /* List of formulas */
}

/* Working / Alt Working */
.sd-working .sd-body, .sd-alt-working .sd-body {
    /* Prose + Math */
}
.sd-alt-working {
    margin-top: var(--space-lg);
    padding-top: var(--space-md);
    border-top: 1px solid var(--color-divider); /* Separator mechanism */
}

/* Child Questions */
.children-container {
    margin-top: var(--space-md);
    padding-left: var(--space-md); /* Indentation per Stage 3 */
}
/* Reduce spacing for nested questions */
.children-container .question-node {
    margin-bottom: var(--space-lg);
}

/* 
   MARKDOWN & KATEX STYLING 
*/
/* Display Math Containment (Invariant) */
.katex-display {
    overflow-x: auto;
    overflow-y: hidden;
    max-width: 100%;
    margin: 0.5em 0;
    padding: 0.25em 0;
    /* Optional: Hide scrollbar */
    scrollbar-width: none;
    -ms-overflow-style: none;
    /* Subtle underlay permitted for BLOCK math only */
    background-color: rgba(0,0,0,0.02); 
}
.katex-display::-webkit-scrollbar { display: none; }

/* Inline Math (Invariant: Transparent BG) */
.katex {
    background-color: transparent !important;
}

/* Tables */
table {
    border-collapse: collapse;
    width: 100%;
    margin: 0.5em 0;
    font-size: 0.95rem;
}
th, td {
    border: 1px solid var(--color-divider);
    padding: 6px 12px;
    text-align: left;
}
th {
    font-weight: 500;
    color: var(--color-text-sec);
}

/* Diagrams (SVG Passthrough) */
svg {
    max-width: 100%;
    height: auto;
    display: block;
    margin: var(--space-sm) 0;
}

/* 
   MOBILE / RESPONSIVE 
*/
/* Mobile Drawer Overlay */
.drawer-backdrop {
    position: fixed;
    top: 0; left: 0; right: 0; bottom: 0;
    background: rgba(0,0,0,0.3);
    z-index: 50;
    display: none;
}
.drawer-backdrop.open { display: block; }

.nav-drawer {
    position: fixed;
    top: 0; left: 0; bottom: 0;
    width: 80%;
    max-width: 300px;
    background: var(--color-paper-bg);
    z-index: 60;
    transform: translateX(-100%);
    transition: transform 0.2s ease-out;
    display: flex;
    flex-direction: column;
    box-shadow: 2px 0 8px rgba(0,0,0,0.1);
}
.nav-drawer.open { transform: translateX(0); }

.drawer-header {
    padding: var(--space-md);
    border-bottom: 1px solid var(--color-divider);
    display: flex;
    justify-content: space-between;
    align-items: center;
}
.drawer-title { font-weight: 600; }
.drawer-close {
    background: none;
    border: none;
    font-size: 1.5rem;
    line-height: 1;
    cursor: pointer;
    padding: 0 var(--space-xs);
}

.drawer-content {
    flex: 1;
    overflow-y: auto;
    padding: var(--space-md);
}

@media (max-width: 768px) {
    .nav-rail { display: none; }
    .jump-to-trigger { display: block; }
    .document-frame-shell {
        flex-direction: column;
        border: none;
    }
    .paper-column {
        padding: var(--space-md);
    }
    .paper-surface {
        padding: var(--space-md) var(--space-sm);
    }
    .solution-block {
        margin-left: 0;
        padding-left: var(--space-sm);
        border-left: 2px solid var(--color-divider); /* Mobile orientation aid */
    }
}
</style>
</head>
<body>

<div class="app-container" id="app">
    <!-- Top Controls -->
    <header class="top-controls">
        <select id="paperSelector" class="paper-selector" aria-label="Select Paper">
            <option>Loading...</option>
        </select>
        <button id="jumpToBtn" class="jump-to-trigger" aria-label="Open Navigation">
            Jump to
        </button>
    </header>

    <!-- Document Frame Shell -->
    <div class="document-frame-shell">
        <!-- Desktop Nav Rail -->
        <nav class="nav-rail" id="desktopNav" aria-label="Paper Navigation">
            <!-- Populated via JS -->
        </nav>

        <!-- Paper Content -->
        <main class="paper-column" id="mainContent">
            <div id="paperSurface" class="paper-surface">
                <!-- Content Populated via JS -->
            </div>
        </main>
    </div>
</div>

<!-- Mobile Drawer -->
<div class="drawer-backdrop" id="drawerBackdrop"></div>
<div class="nav-drawer" id="navDrawer" role="dialog" aria-modal="true" aria-label="Jump to question">
    <div class="drawer-header">
        <span class="drawer-title">Jump to</span>
        <button class="drawer-close" id="drawerClose" aria-label="Close navigation">&times;</button>
    </div>
    <div class="drawer-content" id="drawerNavContent">
        <!-- Clone of Nav -->
    </div>
</div>

<script>
/**
 * CONSTANTS - SINGLE SOURCE OF TRUTH
 */
const RTQ_PAPERS_PAYLOAD_PATH = "../../../payload/rtq.papers.payload.v2.json";
const RTQ_SHADCN_TOKEN_PROFILES_PATH = "../../../payload/rtq.shadcn.token.profiles.v1.json";

/**
 * STATE
 */
let state = {
    papers: [],
    currentPaper: null,
    expandedStates: new Set() // Set of questionIds
};

/**
 * MARKDOWN CONFIGURATION (Authoritative)
 */
const md = window.markdownit
  ? window.markdownit({
      html: true, // Allow inline SVG
      linkify: true,
      breaks: false, // MUST stay false
    })
  : null;

if (md) {
    // Preserve TeX backslashes
    md.inline.ruler.disable(['escape']);
}

/**
 * APP INITIALIZATION
 */
async function init() {
    try {
        const response = await fetch(RTQ_PAPERS_PAYLOAD_PATH);
        if (!response.ok) throw new Error("Payload missing");
        
        const payload = await response.json();
        state.papers = payload.papers || [];

        if (state.papers.length === 0) {
            renderError("NO PAPERS FOUND");
            return;
        }

        renderSelector();
        // Default to first paper
        switchPaper(state.papers[0].key);

    } catch (e) {
        console.error(e);
        renderError("PAPERS PAYLOAD MISSING");
    }
}

function renderError(msg) {
    const surface = document.getElementById('paperSurface');
    surface.innerHTML = `<div style="padding: 2rem; color: var(--color-text-sec); font-weight: 600;">${msg}</div>`;
    document.getElementById('paperSelector').innerHTML = `<option>Error</option>`;
}

function renderSelector() {
    const sel = document.getElementById('paperSelector');
    sel.innerHTML = state.papers.map(p => `<option value="${p.key}">${p.label}</option>`).join('');
    
    sel.addEventListener('change', (e) => {
        switchPaper(e.target.value);
    });
}

function switchPaper(key) {
    const paper = state.papers.find(p => p.key === key);
    if (!paper) return;

    state.currentPaper = paper;
    
    // Reset Expansion State based on paper defaults
    state.expandedStates.clear();
    const defaultExpanded = paper.defaults?.expandedAll !== false; // Default true unless false
    
    // Helper to recurse and set defaults
    const collectIds = (nodes) => {
        nodes.forEach(n => {
            if (n.solutionBlock?.solutionDetails) {
                if (defaultExpanded) state.expandedStates.add(n.id);
            }
            if (n.children) collectIds(n.children);
        });
    }
    
    const rootNodes = paper.questions || (paper.sections ? paper.sections.flatMap(s => s.questions) : []);
    collectIds(rootNodes);

    renderPaperContent();
    renderNavigation();
    
    // Reset scroll
    document.getElementById('mainContent').scrollTop = 0;
    window.scrollTo(0, 0);
}

/**
 * RENDERING CONTENT
 */
function renderPaperContent() {
    const surface = document.getElementById('paperSurface');
    const paper = state.currentPaper;
    let html = '';

    if (paper.sections) {
        paper.sections.forEach(sec => {
            if (sec.label && sec.label.trim() !== '') {
                html += `<div class="paper-section-header">${sec.label}</div>`;
            }
            html += renderQuestionList(sec.questions, 0);
        });
    } else {
        html += renderQuestionList(paper.questions || [], 0);
    }

    surface.innerHTML = html;

    // Post-render: KaTeX
    renderMathInElement(surface, {
        delimiters: [
            {left: '$$', right: '$$', display: true},
            {left: '$', right: '$', display: false}
        ],
        throwOnError: false
    });
    
    // Post-render: Events
    bindEvents(surface);
}

function renderQuestionList(questions, depth) {
    if (!questions || questions.length === 0) return '';
    return questions.map(q => renderQuestionNode(q, depth)).join('');
}

function renderQuestionNode(q, depth) {
    // Determine if Solution Block exists
    const hasSb = !!q.solutionBlock;
    const hasAns = hasSb && !!q.solutionBlock.answer;
    const hasDetails = hasSb && !!q.solutionBlock.solutionDetails;
    const isExpanded = state.expandedStates.has(q.id);

    // Render components
    const questionHtml = md ? md.render(q.question) : q.question;
    
    let answerHtml = '';
    if (hasAns) {
        const ansBody = md ? md.render(q.solutionBlock.answer) : q.solutionBlock.answer;
        answerHtml = `
            <div class="answer-region">
                <span class="answer-label">Answer</span>
                <div class="answer-content">${ansBody}</div>
            </div>`;
    }

    let detailsHtml = '';
    if (hasDetails) {
        const sd = q.solutionBlock.solutionDetails;
        const toggleText = isExpanded ? "Hide working" : "Show working";
        const icon = isExpanded ? "▲" : "▼"; 
        
        let detailsBody = '';
        if (sd.keepInMind) {
            detailsBody += `<div class="sd-section sd-keep-in-mind">
                <span class="sd-label">Keep in mind</span>
                <div class="sd-body">${md.render(sd.keepInMind)}</div>
            </div>`;
        }
        if (sd.formulasUsed) {
            detailsBody += `<div class="sd-section sd-formulas">
                <span class="sd-label">Formulas used</span>
                <div class="sd-body">${md.render(sd.formulasUsed)}</div>
            </div>`;
        }
        if (sd.working) {
            detailsBody += `<div class="sd-section sd-working">
                <span class="sd-label">Working</span>
                <div class="sd-body">${md.render(sd.working)}</div>
            </div>`;
        }
        if (sd.alternativeWorking && Array.isArray(sd.alternativeWorking)) {
            sd.alternativeWorking.forEach((alt, idx) => {
                detailsBody += `<div class="sd-section sd-alt-working">
                    <span class="sd-label">Alternative working</span>
                    <div class="sd-body">${md.render(alt)}</div>
                </div>`;
            });
        }

        detailsHtml = `
            <button class="disclosure-control" data-qid="${q.id}">
                ${toggleText} <span style="font-size: 0.7em;">${icon}</span>
            </button>
            <div class="solution-details-content ${isExpanded ? 'expanded' : ''}">
                ${detailsBody}
            </div>
        `;
    }

    let solutionBlockHtml = '';
    if (hasSb) {
        solutionBlockHtml = `
            <div class="solution-block">
                ${answerHtml}
                ${detailsHtml}
            </div>
        `;
    }

    let childrenHtml = '';
    if (q.children && q.children.length > 0) {
        childrenHtml = `<div class="children-container">
            ${renderQuestionList(q.children, depth + 1)}
        </div>`;
    }

    return `
        <div class="question-node" id="q-${q.id}">
            <div class="question-body">
                <div class="q-id">${q.id}</div>
                <div class="q-prompt">${questionHtml}</div>
            </div>
            ${solutionBlockHtml}
            ${childrenHtml}
        </div>
    `;
}

function bindEvents(root) {
    root.querySelectorAll('.disclosure-control').forEach(btn => {
        btn.addEventListener('click', (e) => {
            const qid = btn.getAttribute('data-qid');
            if (state.expandedStates.has(qid)) {
                state.expandedStates.delete(qid);
            } else {
                state.expandedStates.add(qid);
            }
            // Re-render only could be expensive, in a real app we'd toggle DOM
            // For this prototype, re-rendering whole paper ensures consistency
            // but we must preserve scroll.
            const scrollPos = window.scrollY;
            renderPaperContent();
            renderNavigation(); // Update active states if logic depended on it (it doesn't currently)
            window.scrollTo(0, scrollPos);
        });
    });
}

/**
 * NAVIGATION
 */
function renderNavigation() {
    const paper = state.currentPaper;
    const desktopNav = document.getElementById('desktopNav');
    const drawerContent = document.getElementById('drawerNavContent');

    const generateList = () => {
        let html = '<div class="nav-list">';
        
        const renderItem = (q, depth) => {
            const indentAttr = `data-depth="${Math.min(depth, 2)}"`;
            return `<a class="nav-item" ${indentAttr} onclick="scrollToQuestion('${q.id}')">${q.id}</a>`;
        }
        
        const recurse = (nodes, depth) => {
            return nodes.map(q => {
                let s = renderItem(q, depth);
                if (q.children) s += recurse(q.children, depth + 1);
                return s;
            }).join('');
        };

        if (paper.sections) {
            paper.sections.forEach(sec => {
                if (sec.label && sec.label.trim() !== '') {
                    html += `<div class="nav-section-label">${sec.label}</div>`;
                }
                html += recurse(sec.questions, 0);
            });
        } else {
            html += recurse(paper.questions || [], 0);
        }

        html += '</div>';
        return html;
    };

    const navHtml = generateList();
    desktopNav.innerHTML = navHtml;
    drawerContent.innerHTML = navHtml;
}

window.scrollToQuestion = (id) => {
    const el = document.getElementById(`q-${id}`);
    if (el) {
        el.scrollIntoView({ behavior: 'smooth', block: 'start' });
        
        // Highlight active (simple simulation)
        document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
        // Find nav items with this text content roughly matches
        // In real app, bind ID.
        // For prototype, simply close drawer if open
        closeDrawer();
    }
}

/**
 * MOBILE DRAWER
 */
const drawer = document.getElementById('navDrawer');
const backdrop = document.getElementById('drawerBackdrop');
const jumpBtn = document.getElementById('jumpToBtn');
const closeBtn = document.getElementById('drawerClose');

function openDrawer() {
    drawer.classList.add('open');
    backdrop.classList.add('open');
}
function closeDrawer() {
    drawer.classList.remove('open');
    backdrop.classList.remove('open');
}

jumpBtn.addEventListener('click', openDrawer);
closeBtn.addEventListener('click', closeDrawer);
backdrop.addEventListener('click', closeDrawer);

// BOOT
init();

</script>
</body>
</html>

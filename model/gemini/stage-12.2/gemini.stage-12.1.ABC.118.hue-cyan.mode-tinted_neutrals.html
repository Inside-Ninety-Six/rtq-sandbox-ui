<!DOCTYPE html>
<html lang="en">
<head>
  <!-- RTQ_RUN {"generator":"rtq-prototype-batch","model":"gemini-3-pro-preview","prefix":"gemini.stage-12.1","variant":"ABC","indexWithinVariant":"118","totalWithinVariant":"320","hueFamily":"cyan","intensityMode":"tinted_neutrals","primaryHueFamily":"","secondaryHueFamily":"","dualIntensityMode":"","timestamp":"2026-01-09T15:23:09.842Z"} -->
  <meta name="rtq-run" content='{&quot;generator&quot;:&quot;rtq-prototype-batch&quot;,&quot;model&quot;:&quot;gemini-3-pro-preview&quot;,&quot;prefix&quot;:&quot;gemini.stage-12.1&quot;,&quot;variant&quot;:&quot;ABC&quot;,&quot;indexWithinVariant&quot;:&quot;118&quot;,&quot;totalWithinVariant&quot;:&quot;320&quot;,&quot;hueFamily&quot;:&quot;cyan&quot;,&quot;intensityMode&quot;:&quot;tinted_neutrals&quot;,&quot;primaryHueFamily&quot;:&quot;&quot;,&quot;secondaryHueFamily&quot;:&quot;&quot;,&quot;dualIntensityMode&quot;:&quot;&quot;,&quot;timestamp&quot;:&quot;2026-01-09T15:23:09.842Z&quot;}'>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RTQ Maths Paper Solution Viewer (Stage 6 Baseline)</title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">

    <!-- KaTeX CSS (SRI disabled per Stage 6.0.7b) -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">

    <!-- Tailwind CSS (via CDN) -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- ColorLab C: Tinted Neutrals + Cyan Configuration -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        // ColorLab C: tinted_neutrals (Cyan Hue ~220)
                        // Page/Frame/Paper: C in [0.015 .. 0.035]
                        // SD Wash: C in [0.025 .. 0.045]
                        // Text: Pri C<=0.010, Sec C<=0.012
                        // Accent: C in [0.10 .. 0.16]
                        
                        page: 'oklch(0.97 0.02 220)',      // Tinted page background
                        frame: 'oklch(0.96 0.025 220)',     // Tinted frame base
                        paper: 'oklch(0.99 0.015 220)',     // Slightly lighter paper surface
                        
                        sdWash: 'oklch(0.95 0.035 220)',    // Solution Details wash
                        
                        txtPri: 'oklch(0.20 0.008 220)',    // Primary text (near neutral)
                        txtSec: 'oklch(0.45 0.012 220)',    // Secondary text
                        
                        accent: 'oklch(0.55 0.14 220)',     // Accent (Links, Focus, Controls)
                        
                        hairline: 'oklch(0.88 0.02 220)',   // Dividers
                        focusRing: 'oklch(0.55 0.14 220)',  // Focus ring color
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    spacing: {
                        'qm': '2.5rem', // Question margin (largest)
                        'sm': '1.5rem', // Subsection margin
                        'im': '0.75rem', // Internal margin
                    }
                }
            }
        }
    </script>

    <!-- Global Styles & KaTeX Overflow Protection -->
    <style>
        body {
            background-color: theme('colors.page');
            color: theme('colors.txtPri');
            -webkit-font-smoothing: antialiased;
        }

        /* Focus Management - Stage 5.5.2 */
        :focus-visible {
            outline: 2px solid theme('colors.focusRing');
            outline-offset: 2px;
        }

        /* KaTeX Containment Invariant - Stage 6.0.8 */
        .katex-display {
            overflow-x: auto;
            overflow-y: hidden;
            max-width: 100%;
            padding-bottom: 4px; /* Space for scrollbar */
            -webkit-overflow-scrolling: touch;
        }
        
        /* Scrollbar hiding for Nav (Add-on) */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        /* Markdown Table Minimal Styling */
        table {
            border-collapse: collapse;
            width: 100%;
            margin-bottom: 1rem;
            font-size: 0.95em;
        }
        th, td {
            border: 1px solid theme('colors.hairline');
            padding: 0.5rem;
            text-align: left;
        }
        th {
            font-weight: 600;
            color: theme('colors.txtPri');
        }

        /* Inline SVG Passthrough adjustments */
        svg {
            max-width: 100%;
            height: auto;
        }
        
        /* Drawer animation classes */
        .drawer-enter { transform: translateX(-100%); }
        .drawer-enter-active { transform: translateX(0); transition: transform 0.3s ease-out; }
        .drawer-exit { transform: translateX(0); }
        .drawer-exit-active { transform: translateX(-100%); transition: transform 0.2s ease-in; }
    </style>

    <!-- Libraries -->
    <!-- Markdown-it (SRI disabled) -->
    <script src="https://cdn.jsdelivr.net/npm/markdown-it@13.0.1/dist/markdown-it.min.js"></script>
    <!-- KaTeX JS (SRI disabled) -->
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>
</head>
<body class="min-h-screen flex flex-col text-base selection:bg-accent selection:text-white">

    <!-- Top Controls Region -->
    <div class="sticky top-0 z-30 w-full bg-page border-b border-hairline/50 backdrop-blur-sm bg-opacity-95">
        <div class="max-w-7xl mx-auto px-4 h-14 flex items-center justify-between">
            
            <!-- Paper Selector -->
            <div class="flex items-center gap-3">
                <label for="paper-select" class="text-sm font-medium text-txtSec hidden sm:block">Paper</label>
                <select id="paper-select" class="bg-frame border border-hairline rounded px-2 py-1 text-sm font-medium text-txtPri focus:outline-none focus:border-accent">
                    <option value="" disabled selected>Loading papers...</option>
                </select>
            </div>

            <!-- Mobile Jump To Trigger -->
            <button id="mobile-jump-trigger" class="lg:hidden text-sm font-medium text-accent hover:text-accent/80 transition-colors px-2 py-1 rounded" aria-label="Jump to question">
                Jump to
            </button>
        </div>
    </div>

    <!-- DocumentFrameShell -->
    <div class="flex-1 w-full max-w-7xl mx-auto flex items-start relative">
        
        <!-- Desktop Navigation Rail (Sticky) -->
        <nav class="hidden lg:block w-64 sticky top-14 h-[calc(100vh-3.5rem)] overflow-y-auto no-scrollbar border-r border-hairline/0 pr-6 py-8 mr-8">
            <div id="desktop-nav-list" class="flex flex-col gap-1 pb-10">
                <!-- Nav items generated here -->
            </div>
        </nav>

        <!-- Paper Document Column -->
        <main id="paper-region" class="flex-1 w-full min-w-0 py-8 px-4 sm:px-0">
            <!-- Paper Content Surface -->
            <div class="bg-paper shadow-sm border border-hairline/50 rounded-sm min-h-[50vh] max-w-3xl mx-auto p-8 sm:p-12 relative">
                <div id="content-container">
                    <div class="text-center text-txtSec py-20">Select a paper to begin.</div>
                </div>
            </div>
        </main>

    </div>

    <!-- Mobile Navigation Drawer -->
    <div id="drawer-backdrop" class="fixed inset-0 bg-black/20 z-40 hidden transition-opacity opacity-0" aria-hidden="true"></div>
    <div id="drawer-panel" class="fixed inset-y-0 left-0 w-64 bg-frame z-50 transform -translate-x-full transition-transform duration-300 shadow-lg flex flex-col" aria-hidden="true">
        <div class="h-14 border-b border-hairline flex items-center justify-between px-4 bg-page">
            <span class="font-medium text-txtPri">Jump to</span>
            <button id="drawer-close" class="text-txtSec hover:text-txtPri p-1" aria-label="Close navigation">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
            </button>
        </div>
        <nav class="flex-1 overflow-y-auto p-4">
            <div id="mobile-nav-list" class="flex flex-col gap-1 pb-10">
                <!-- Mobile nav items generated here -->
            </div>
        </nav>
    </div>

    <!-- Logic -->
    <script>
        // --- STAGE 0: CONSTANTS ---
        const RTQ_PAPERS_PAYLOAD_PATH = "../../../payload/rtq.papers.payload.v2.json";
        const RTQ_SHADCN_TOKEN_PROFILES_PATH = "../../../payload/rtq.shadcn.token.profiles.v1.json";

        // --- State ---
        let state = {
            papers: [],
            currentPaperId: null,
            currentPaperData: null,
            expandedMap: {} // { questionId: boolean }
        };

        // --- Markdown Renderer Setup (Stage 6 Add-on) ---
        const md = window.markdownit ? window.markdownit({
            html: true, // Inline SVG passthrough
            linkify: true,
            breaks: false // CRITICAL: prevents <br> inside Math
        }) : null;

        if (md) {
            md.inline.ruler.disable(['escape']); // Preserve TeX backslashes
        }

        // --- DOM Elements ---
        const els = {
            paperSelect: document.getElementById('paper-select'),
            contentContainer: document.getElementById('content-container'),
            desktopNavList: document.getElementById('desktop-nav-list'),
            mobileNavList: document.getElementById('mobile-nav-list'),
            drawerBackdrop: document.getElementById('drawer-backdrop'),
            drawerPanel: document.getElementById('drawer-panel'),
            mobileJumpTrigger: document.getElementById('mobile-jump-trigger'),
            drawerClose: document.getElementById('drawer-close')
        };

        // --- Initialization ---
        async function init() {
            try {
                const response = await fetch(RTQ_PAPERS_PAYLOAD_PATH);
                if (!response.ok) throw new Error('Network response not ok');
                const data = await response.json();
                
                if (!data.papers || !Array.isArray(data.papers)) throw new Error('Invalid payload structure');
                
                state.papers = data.papers;
                renderPaperSelector();
                
                // Select first paper by default if available
                if (state.papers.length > 0) {
                    loadPaper(state.papers[0].key);
                }
            } catch (err) {
                console.error("Payload loading failed:", err);
                renderError();
            }
        }

        function renderError() {
            els.contentContainer.innerHTML = `
                <div class="text-center py-20">
                    <h2 class="text-xl font-semibold text-txtPri mb-2">PAPERS PAYLOAD MISSING</h2>
                    <p class="text-txtSec">Unable to load content from canonical path.</p>
                </div>
            `;
            els.paperSelect.innerHTML = '<option disabled selected>Error loading papers</option>';
        }

        function renderPaperSelector() {
            els.paperSelect.innerHTML = state.papers.map(p => 
                `<option value="${p.key}">${p.label}</option>`
            ).join('');
            
            els.paperSelect.addEventListener('change', (e) => {
                loadPaper(e.target.value);
            });
        }

        // --- Core Content Loading ---
        function loadPaper(paperKey) {
            const paper = state.papers.find(p => p.key === paperKey);
            if (!paper) return;

            state.currentPaperData = paper;
            state.currentPaperId = paperKey;
            
            // Set defaults
            state.expandedMap = {}; // Reset expansion state
            const defaultExpanded = paper.defaults?.expandedAll !== false;
            
            // Build flat list of questions for navigation and expansion init
            const allQuestions = [];
            const traverse = (nodes) => {
                if(!nodes) return;
                nodes.forEach(node => {
                    allQuestions.push(node);
                    // Init expansion state if solution details exist
                    if (node.solutionBlock?.solutionDetails) {
                        state.expandedMap[node.id] = defaultExpanded;
                    }
                    if (node.children) traverse(node.children);
                });
            };

            if (paper.sections) {
                paper.sections.forEach(s => traverse(s.questions));
            } else {
                traverse(paper.questions);
            }

            renderContent();
            renderNavigation();
            
            // Reset scroll
            window.scrollTo(0, 0);
            document.getElementById('desktop-nav-list').parentNode.scrollTop = 0;
        }

        // --- Rendering ---
        function renderContent() {
            const paper = state.currentPaperData;
            let html = '';

            // Optional Section Headers or Flat List
            if (paper.sections) {
                paper.sections.forEach((section, idx) => {
                    // Render Section Header if label exists
                    if (section.label && section.label.trim().length > 0) {
                        html += `
                            <div class="mb-6 mt-10 first:mt-0 border-b border-hairline pb-2">
                                <span class="text-lg font-semibold text-txtPri">${section.label}</span>
                            </div>
                        `;
                    }
                    // Render Questions
                    html += `<div class="space-y-qm">
                        ${renderQuestionList(section.questions, 0)}
                    </div>`;
                    
                    // Spacer between sections if not last
                    if (idx < paper.sections.length - 1) {
                        html += `<div class="h-qm"></div>`; 
                    }
                });
            } else {
                html += `<div class="space-y-qm">
                    ${renderQuestionList(paper.questions, 0)}
                </div>`;
            }

            els.contentContainer.innerHTML = html;
            
            // Post-render: Typeset Math
            if (window.renderMathInElement) {
                renderMathInElement(els.contentContainer, {
                    delimiters: [
                        {left: '$$', right: '$$', display: true},
                        {left: '$', right: '$', display: false}
                    ],
                    throwOnError: false
                });
            }
        }

        function renderQuestionList(questions, depth) {
            if (!questions || questions.length === 0) return '';
            return questions.map(q => renderQuestionNode(q, depth)).join('');
        }

        function renderQuestionNode(node, depth) {
            const hasSolutionBlock = !!node.solutionBlock;
            const hasAnswer = hasSolutionBlock && !!node.solutionBlock.answer;
            const hasSolutionDetails = hasSolutionBlock && !!node.solutionBlock.solutionDetails;
            const isExpanded = state.expandedMap[node.id];

            // Indentation class (visual subordination via spacing, not nesting containers)
            // Note: Stage 3 says "children container... indentation (spacing only)".
            // For depth > 0, we apply left margin.
            const indentClass = depth > 0 ? `ml-4 sm:ml-8 border-l border-hairline pl-4 sm:pl-6` : '';

            // Markdown rendering helper
            const renderMd = (text) => md ? md.render(text || '') : (text || '');

            return `
                <div id="q-${node.id}" class="question-node relative group ${indentClass}">
                    
                    <!-- Question Body -->
                    <div class="mb-sm">
                        <div class="flex items-baseline gap-3">
                            <span class="text-txtSec font-medium text-sm flex-shrink-0 select-none w-8 sm:w-10 text-right">${node.id}</span>
                            <div class="flex-1 text-txtPri leading-relaxed max-w-none prose prose-neutral prose-p:my-2 prose-headings:text-txtPri prose-strong:text-txtPri prose-code:text-accent prose-table:text-sm prose-td:border-hairline prose-th:border-hairline">
                                ${renderMd(node.question)}
                            </div>
                        </div>
                    </div>

                    <!-- Solution Block (Optional) -->
                    ${hasSolutionBlock ? `
                        <div class="ml-11 sm:ml-14">
                            
                            <!-- Answer (Optional) -->
                            ${hasAnswer ? `
                                <div class="mb-im">
                                    <span class="text-xs font-bold uppercase tracking-wider text-txtSec mr-2 select-none">Answer</span>
                                    <div class="inline-block text-txtPri font-medium">
                                        ${renderMd(node.solutionBlock.answer)}
                                    </div>
                                </div>
                            ` : ''}

                            <!-- Solution Details (Optional) -->
                            ${hasSolutionDetails ? `
                                <div>
                                    <!-- Disclosure Control -->
                                    <button 
                                        onclick="toggleSolution('${node.id}')"
                                        class="text-sm font-medium text-accent hover:text-accent/80 focus:outline-none focus-visible:ring-2 focus-visible:ring-focusRing rounded px-1 -ml-1 flex items-center gap-1 transition-colors select-none"
                                        aria-expanded="${isExpanded}"
                                        aria-controls="sd-${node.id}"
                                    >
                                        <span>${isExpanded ? 'Hide working' : 'Show working'}</span>
                                        <svg class="w-4 h-4 transform transition-transform ${isExpanded ? 'rotate-180' : ''}" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                                    </button>

                                    <!-- Expandable Region -->
                                    <div id="sd-${node.id}" class="${isExpanded ? 'block' : 'hidden'} mt-im pt-im pb-sm pr-4 -mr-4 rounded-sm bg-sdWash/50 border-l-2 border-hairline pl-4">
                                        
                                        <!-- Keep in mind -->
                                        ${node.solutionBlock.solutionDetails.keepInMind ? `
                                            <div class="mb-sm text-sm">
                                                <div class="font-bold text-txtSec mb-1 text-xs uppercase tracking-wider">Keep in mind</div>
                                                <div class="text-txtSec/90 leading-relaxed prose prose-sm max-w-none">
                                                    ${renderMd(node.solutionBlock.solutionDetails.keepInMind)}
                                                </div>
                                            </div>
                                        ` : ''}

                                        <!-- Formulas used -->
                                        ${node.solutionBlock.solutionDetails.formulasUsed ? `
                                            <div class="mb-sm text-sm">
                                                <div class="font-bold text-txtSec mb-1 text-xs uppercase tracking-wider">Formulas used</div>
                                                <div class="text-txtSec/90 leading-relaxed prose prose-sm max-w-none font-mono text-xs">
                                                    ${renderMd(node.solutionBlock.solutionDetails.formulasUsed)}
                                                </div>
                                            </div>
                                        ` : ''}

                                        <!-- Working (Primary) -->
                                        ${node.solutionBlock.solutionDetails.working ? `
                                            <div class="mb-sm">
                                                <div class="font-bold text-txtSec mb-2 text-xs uppercase tracking-wider">Working</div>
                                                <div class="text-txtPri/90 leading-relaxed prose prose-neutral max-w-none">
                                                    ${renderMd(node.solutionBlock.solutionDetails.working)}
                                                </div>
                                            </div>
                                        ` : ''}

                                        <!-- Alternative working -->
                                        ${node.solutionBlock.solutionDetails.alternativeWorking && Array.isArray(node.solutionBlock.solutionDetails.alternativeWorking) ? 
                                            node.solutionBlock.solutionDetails.alternativeWorking.map(alt => `
                                                <div class="mt-sm pt-sm border-t border-hairline/50">
                                                    <div class="font-bold text-txtSec mb-2 text-xs uppercase tracking-wider">Alternative working</div>
                                                    <div class="text-txtPri/90 leading-relaxed prose prose-neutral max-w-none">
                                                        ${renderMd(alt)}
                                                    </div>
                                                </div>
                                            `).join('')
                                         : ''}
                                        
                                    </div>
                                </div>
                            ` : ''}
                        </div>
                    ` : ''}

                    <!-- Children -->
                    ${node.children && node.children.length > 0 ? `
                        <div class="mt-sm">
                            ${renderQuestionList(node.children, depth + 1)}
                        </div>
                    ` : ''}
                </div>
            `;
        }

        // --- Interaction Handlers ---
        window.toggleSolution = (id) => {
            state.expandedMap[id] = !state.expandedMap[id];
            // Re-render only keeps scroll pos roughly stable because we render the whole list.
            // In a real app we'd diff or just toggle DOM classes. 
            // For prototype stress-test, full re-render is safe enough provided we restore scroll.
            // However, full re-render breaks scroll position badly.
            // Let's implement DOM-only toggle for stability.
            
            const btn = document.querySelector(`button[onclick="toggleSolution('${id}')"]`);
            const region = document.getElementById(`sd-${id}`);
            const svg = btn.querySelector('svg');
            const span = btn.querySelector('span');

            const isNowExpanded = state.expandedMap[id];

            if (isNowExpanded) {
                region.classList.remove('hidden');
                region.classList.add('block');
                svg.classList.add('rotate-180');
                span.textContent = 'Hide working';
                btn.setAttribute('aria-expanded', 'true');
            } else {
                region.classList.remove('block');
                region.classList.add('hidden');
                svg.classList.remove('rotate-180');
                span.textContent = 'Show working';
                btn.setAttribute('aria-expanded', 'false');
            }
        };

        // --- Navigation Rendering ---
        function renderNavigation() {
            const paper = state.currentPaperData;
            
            // Shared generator for desktop/mobile
            const generateList = () => {
                let html = '';
                
                const renderItem = (q, isSub) => {
                    // Stage 5.4.5: Hierarchy via type scale only. Flat list.
                    // Sub-questions slightly smaller/quieter.
                    const sizeClass = isSub ? 'text-xs text-txtSec' : 'text-sm text-txtPri';
                    const hoverClass = 'hover:text-accent hover:bg-black/5 rounded transition-colors';
                    const activeClass = ''; // Logic handled by scrollspy later
                    
                    let itemHtml = `
                        <a href="#q-${q.id}" class="block py-1 px-2 ${sizeClass} ${hoverClass} nav-item" data-target="q-${q.id}">
                            ${q.id}
                        </a>
                    `;

                    if (q.children) {
                        q.children.forEach(child => {
                            itemHtml += renderItem(child, true);
                        });
                    }
                    return itemHtml;
                };

                if (paper.sections) {
                    paper.sections.forEach(s => {
                        if (s.label && s.label.trim()) {
                            // Non-clickable Section Header
                            html += `
                                <div class="mt-4 mb-1 px-2 text-xs font-bold text-txtSec uppercase tracking-wider opacity-60 cursor-default">
                                    ${s.label}
                                </div>
                            `;
                        }
                        s.questions.forEach(q => html += renderItem(q, false));
                    });
                } else {
                    paper.questions.forEach(q => html += renderItem(q, false));
                }
                return html;
            };

            const navHtml = generateList();
            els.desktopNavList.innerHTML = navHtml;
            els.mobileNavList.innerHTML = navHtml;

            setupScrollSpy();
        }

        // --- ScrollSpy & Nav Interaction ---
        function setupScrollSpy() {
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        highlightNav(entry.target.id);
                    }
                });
            }, { rootMargin: '-10% 0px -80% 0px' });

            document.querySelectorAll('.question-node').forEach(node => observer.observe(node));
            
            // Add click intercept for smooth scroll
            document.querySelectorAll('.nav-item').forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const targetId = link.getAttribute('href').substring(1);
                    const target = document.getElementById(targetId);
                    if (target) {
                        // Offset for sticky header
                        const headerOffset = 80;
                        const elementPosition = target.getBoundingClientRect().top;
                        const offsetPosition = elementPosition + window.pageYOffset - headerOffset;
                        
                        window.scrollTo({
                            top: offsetPosition,
                            behavior: 'smooth'
                        });
                        
                        closeDrawer();
                    }
                });
            });
        }

        function highlightNav(questionId) {
            // Remove active style from all
            document.querySelectorAll('.nav-item').forEach(el => {
                el.classList.remove('font-bold', 'text-accent');
                if (el.classList.contains('text-sm')) el.classList.add('text-txtPri'); // Reset top level
                if (el.classList.contains('text-xs')) el.classList.add('text-txtSec'); // Reset sub level
            });

            // Add active style (Bold + Accent) - Stage 5.4.3 Override allows Accent for Nav
            const activeLinks = document.querySelectorAll(`.nav-item[data-target="${questionId}"]`);
            activeLinks.forEach(el => {
                el.classList.remove('text-txtPri', 'text-txtSec');
                el.classList.add('font-bold', 'text-accent');
            });
        }

        // --- Drawer Logic ---
        function openDrawer() {
            els.drawerBackdrop.classList.remove('hidden');
            // small delay to allow display:block to apply before opacity transition
            setTimeout(() => {
                els.drawerBackdrop.classList.remove('opacity-0');
                els.drawerPanel.classList.remove('-translate-x-full');
            }, 10);
            document.body.style.overflow = 'hidden';
        }

        function closeDrawer() {
            els.drawerBackdrop.classList.add('opacity-0');
            els.drawerPanel.classList.add('-translate-x-full');
            setTimeout(() => {
                els.drawerBackdrop.classList.add('hidden');
                document.body.style.overflow = '';
            }, 300);
        }

        els.mobileJumpTrigger.addEventListener('click', openDrawer);
        els.drawerClose.addEventListener('click', closeDrawer);
        els.drawerBackdrop.addEventListener('click', closeDrawer);

        // --- Run ---
        init();

    </script>
</body>
</html>

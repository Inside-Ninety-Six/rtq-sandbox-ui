```html
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RTQ - Maths Paper Solution Viewer (Prototype)</title>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"
        integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV" crossorigin="anonymous">

    <style>
        /* * RESET & BASE 
         */
        *,
        *::before,
        *::after {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: #ffffff;
            color: #333333;
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
        }

        /* * LAYOUT SHELL 
         */
        .app-shell {
            max-width: 1024px;
            margin: 0 auto;
            padding: 0 1.5rem;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        /* * TOP CONTROLS 
         */
        .top-controls {
            padding: 2rem 0;
            margin-bottom: 2rem;
            border-bottom: 1px solid #eee;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .paper-selector-label {
            font-weight: 600;
            font-size: 0.9rem;
            margin-right: 1rem;
            color: #666;
        }

        select.paper-select {
            padding: 0.5rem 1rem;
            font-size: 1rem;
            border: 1px solid #ccc;
            border-radius: 4px;
            background: #fff;
            color: #333;
            cursor: pointer;
        }

        /* * MAIN CONTENT GRID 
         */
        .content-grid {
            display: grid;
            grid-template-columns: 180px 1fr;
            /* Nav | Content */
            gap: 4rem;
            align-items: start;
            padding-bottom: 10rem;
        }

        /* * NAVIGATION RAIL (Desktop)
         */
        .nav-rail {
            position: sticky;
            top: 2rem;
            max-height: calc(100vh - 4rem);
            overflow-y: auto;
            padding-right: 1rem;
            /* Space for hidden scrollbar area */

            /* Hide Scrollbar */
            scrollbar-width: none;
            /* Firefox */
            -ms-overflow-style: none;
            /* IE/Edge */
        }

        .nav-rail::-webkit-scrollbar {
            display: none;
            /* Chrome/Safari/Opera */
        }

        .nav-list {
            list-style: none;
            padding: 0;
            margin: 0;
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }

        .nav-section-label {
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: #999;
            margin-top: 1.5rem;
            margin-bottom: 0.5rem;
            font-weight: 600;
            padding-left: 0.5rem;
        }

        .nav-item {
            display: block;
            padding: 0.4rem 0.5rem;
            text-decoration: none;
            color: #666;
            font-size: 0.9rem;
            border-radius: 4px;
            transition: background-color 0.2s, color 0.2s;
        }

        .nav-item:hover {
            background-color: #f4f4f4;
            color: #111;
        }

        .nav-item.sub-item {
            padding-left: 1.5rem;
            font-size: 0.85rem;
        }

        /* * PAPER CONTENT 
         */
        .paper-content {
            min-width: 0;
            /* Prevents flex/grid blowout */
        }

        /* * QUESTION STRUCTURE 
         */
        .question-block {
            margin-bottom: 5rem;
            /* Large vertical rhythm */
            scroll-margin-top: 2rem;
            position: relative;
        }

        .question-header {
            display: flex;
            align-items: baseline;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .q-number {
            font-weight: 700;
            font-size: 1.1rem;
            color: #999;
            flex-shrink: 0;
            width: 2rem;
        }

        .q-prompt {
            font-size: 1.15rem;
            color: #111;
            flex-grow: 1;
        }

        .q-diagram {
            margin: 1.5rem 0;
            display: block;
            max-width: 100%;
        }

        /* Indentation for nested questions */
        .question-block.nested-level-1 {
            margin-left: 2rem;
            margin-bottom: 3rem;
        }

        .question-block.nested-level-2 {
            margin-left: 4rem;
            margin-bottom: 2rem;
        }

        /* * ANSWER COMPONENT 
         */
        .answer-block {
            margin-top: 1.5rem;
            margin-left: 3rem;
            /* Align with text, offset from number */
            padding-left: 1rem;
            border-left: 3px solid #eee;
        }

        .answer-label {
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: #666;
            margin-bottom: 0.25rem;
            display: block;
        }

        .answer-value {
            font-weight: 600;
            font-size: 1.1rem;
            color: #000;
        }

        /* * WORKING COMPONENT 
         */
        .working-container {
            margin-top: 1rem;
            margin-left: 3rem;
        }

        .working-toggle {
            background: none;
            border: none;
            padding: 0;
            font-size: 0.9rem;
            color: #666;
            cursor: pointer;
            text-decoration: underline;
            text-underline-offset: 4px;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .working-toggle:hover {
            color: #111;
        }

        .working-content {
            margin-top: 1rem;
            padding-left: 1rem;
            border-left: 1px dashed #ddd;
            color: #444;
            display: none;
            /* Default collapsed */
            font-size: 1rem;
        }

        .working-content.expanded {
            display: block;
            animation: fadeIn 0.3s ease-out;
        }

        /* * KATEX & MATH HANDLING 
         */
        .katex-display {
            overflow-x: auto;
            overflow-y: hidden;
            padding: 0.5rem 0;
            max-width: 100%;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: thin;
        }

        /* Ensure math fonts scale nicely */
        .katex {
            font-size: 1.1em;
        }

        /* * MOBILE / TABLET OVERRIDES 
         */
        .mobile-nav-trigger {
            display: none;
        }

        @media (max-width: 800px) {
            .content-grid {
                grid-template-columns: 1fr;
                gap: 2rem;
            }

            .nav-rail {
                display: none;
                /* Switch to mobile nav */
            }

            .mobile-nav-trigger {
                display: block;
                width: 100%;
                margin-bottom: 1.5rem;
                padding: 0.75rem;
                background: #f9f9f9;
                border: 1px solid #ddd;
                border-radius: 4px;
                font-size: 1rem;
            }

            .question-block.nested-level-1 {
                margin-left: 1rem;
            }

            .question-block.nested-level-2 {
                margin-left: 2rem;
            }

            .answer-block,
            .working-container {
                margin-left: 0;
                /* Reset indentation on mobile for width */
                border-left-width: 3px;
            }

            .q-number {
                margin-bottom: 0.5rem;
            }

            .question-header {
                flex-direction: column;
                gap: 0;
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(-5px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Utility for screen readers */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            border: 0;
        }
    </style>
</head>

<body>

    <div class="app-shell">
        <header class="top-controls">
            <div style="display: flex; align-items: center;">
                <label for="paper-select" class="paper-selector-label">Select Paper:</label>
                <select id="paper-select" class="paper-select">
                    <option value="short">Short Paper (6 Qs)</option>
                    <option value="standard">Standard Paper (35 Qs)</option>
                    <option value="diagram">Diagram-Heavy (20 Qs)</option>
                    <option value="sectioned">Sectioned (A/B/C)</option>
                    <option value="standard_exp">Standard (Workings Expanded)</option>
                </select>
            </div>
        </header>

        <select id="mobile-jump-nav" class="mobile-nav-trigger" aria-label="Jump to question">
            <option value="" disabled selected>Jump to Question...</option>
        </select>

        <div class="content-grid">

            <nav class="nav-rail" aria-label="Paper Navigation">
                <ul id="nav-list" class="nav-list">
                </ul>
            </nav>

            <main id="paper-container" class="paper-content" role="main">
            </main>

        </div>
    </div>

    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"
        integrity="sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8"
        crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"
        integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05"
        crossorigin="anonymous"></script>

    <script>
        document.addEventListener("DOMContentLoaded", () => {

            // --- STATE & DATA GENERATION ---

            const paperSelect = document.getElementById('paper-select');
            const mobileJump = document.getElementById('mobile-jump-nav');
            const navList = document.getElementById('nav-list');
            const paperContainer = document.getElementById('paper-container');

            // SVG Templates (Inline strings)
            const SVGS = {
                geometry: `<svg viewBox="0 0 200 150" width="200" height="150" class="q-diagram"><path d="M20,130 L100,20 L180,130 Z" fill="none" stroke="#666" stroke-width="2"/><circle cx="100" cy="85" r="30" fill="none" stroke="#999" stroke-dasharray="4 2"/><text x="100" y="145" text-anchor="middle" fill="#666" font-size="12">12cm</text><text x="50" y="70" text-anchor="middle" fill="#666" font-size="12">x</text></svg>`,
                bar: `<svg viewBox="0 0 300 100" width="300" height="100" class="q-diagram"><rect x="0" y="20" width="300" height="1" fill="#ddd"/><rect x="0" y="80" width="300" height="1" fill="#ddd"/><rect x="20" y="20" width="40" height="60" fill="#bbb"/><rect x="80" y="30" width="40" height="50" fill="#bbb"/><rect x="140" y="10" width="40" height="70" fill="#999"/><text x="40" y="95" text-anchor="middle" font-size="10" fill="#666">A</text><text x="100" y="95" text-anchor="middle" font-size="10" fill="#666">B</text><text x="160" y="95" text-anchor="middle" font-size="10" fill="#666">C</text></svg>`,
                grid: `<svg viewBox="0 0 200 200" width="200" height="200" class="q-diagram"><defs><pattern id="grid" width="20" height="20" patternUnits="userSpaceOnUse"><path d="M 20 0 L 0 0 0 20" fill="none" stroke="#eee" stroke-width="1"/></pattern></defs><rect width="200" height="200" fill="url(#grid)" /><line x1="100" y1="0" x2="100" y2="200" stroke="#999" stroke-width="2"/><line x1="0" y1="100" x2="200" y2="100" stroke="#999" stroke-width="2"/><path d="M20,180 Q100,20 180,180" fill="none" stroke="#333" stroke-width="2"/></svg>`,
                table: `<svg viewBox="0 0 300 100" width="300" height="80" class="q-diagram"><rect x="0" y="0" width="300" height="80" fill="none" stroke="#ccc"/><line x1="0" y1="40" x2="300" y2="40" stroke="#ccc"/><line x1="100" y1="0" x2="100" y2="80" stroke="#ccc"/><text x="50" y="25" text-anchor="middle" fill="#666" font-size="12">Input</text><text x="200" y="25" text-anchor="middle" fill="#666" font-size="12">Output</text><text x="50" y="65" text-anchor="middle" fill="#333" font-size="12">x</text><text x="200" y="65" text-anchor="middle" fill="#333" font-size="12">2x + 5</text></svg>`
            };

            // Helper to generate extreme length working
            function generateLongMath(lines) {
                let s = "";
                for (let i = 0; i < lines; i++) {
                    s += `x_{${i}} = \\frac{\\sqrt{${i}^2 + 4ac}}{2a} \\\\ `;
                }
                return s;
            }

            // Data Generators
            function generatePaper(type) {
                let questions = [];
                let expandedDefault = (type === 'standard_exp');

                // Helper to create a Q
                const createQ = (num, text, ans, work, level = 0, diag = null, sub = []) => ({
                    id: `q-${num.toString().replace(/\./g, '-')}`,
                    num, text, ans, work, level, diag, sub
                });

                if (type === 'short') {
                    questions.push(createQ(1, "Calculate $12 + 4 \\times 5$.", "$32$", "$12 + 20 = 32$"));
                    questions.push(createQ(2, "Solve for $x$: $3x - 5 = 10$.", "$x = 5$", "$3x = 15 \\\\ x = 5$"));
                    questions.push(createQ(3, "Find the area.", "$60\\text{cm}^2$", "$A = \\frac{1}{2}bh \\\\ A = \\frac{1}{2}(10)(12) = 60$", 0, SVGS.geometry));
                    questions.push(createQ(4, "Simplify.", "$2a + 3b$", "$5a - 3a + 2b + b = 2a + 3b$"));
                    // Nested
                    questions.push(createQ(5, "A train leaves at 14:00.", "", "", 0, null, [
                        createQ("5a", "How long until 15:30?", "90 mins", "$15:30 - 14:00 = 1:30 = 90\\text{m}$", 1),
                        createQ("5b", "Distance at 60km/h?", "90 km", "$D = S \\times T \\\\ D = 60 \\times 1.5 = 90$", 1)
                    ]));
                    questions.push(createQ(6, "Final Check.", "$100$", "$10^2 = 100$"));
                }
                else if (type === 'standard' || type === 'standard_exp') {
                    for (let i = 1; i <= 35; i++) {
                        let isLong = i >= 26;
                        let work = isLong ? generateLongMath(i === 35 ? 50 : 15) : "$x = " + i + "$";
                        let txt = isLong ? "Solve the following complex algebraic equation derived from the mechanics of the system." : `Question prompt for number ${i}.`;

                        if (i === 10) {
                            // Nested example
                            questions.push(createQ(i, "Multi-part question about ratios.", "", "", 0, null, [
                                createQ("10a", "Find ratio A:B", "1:2", "$50:100 = 1:2$", 1),
                                createQ("10b", "Find total", "150", "$50+100=150$", 1, null, [
                                    createQ("10b(i)", "If doubled?", "300", "$150 \\times 2 = 300$", 2)
                                ])
                            ]));
                        } else {
                            questions.push(createQ(i, txt, `$${i * 2}$`, work));
                        }
                    }
                }
                else if (type === 'diagram') {
                    for (let i = 1; i <= 20; i++) {
                        let diag = null;
                        if (i % 4 === 0) diag = SVGS.geometry;
                        if (i % 4 === 1) diag = SVGS.bar;
                        if (i % 4 === 2) diag = SVGS.grid;
                        if (i % 4 === 3) diag = SVGS.table;
                        questions.push(createQ(i, `Interpret the diagram below to find $x$.`, `$x=${i}$`, `$\\text{Analysis of diagram} \\\\ x = ${i}$`, 0, diag));
                    }
                }
                else if (type === 'sectioned') {
                    // We structure this linearly but will inject section headers in UI
                    questions.push({ type: 'section', label: 'Section A' });
                    for (let i = 1; i <= 35; i++) questions.push(createQ(i, "Section A Question", "Ans", "Work"));
                    questions.push({ type: 'section', label: 'Section B' });
                    for (let i = 1; i <= 8; i++) questions.push(createQ(`B${i}`, "Section B Question", "Ans", "Work", 0, SVGS.geometry));
                    questions.push({ type: 'section', label: 'Section C' });
                    for (let i = 1; i <= 6; i++) questions.push(createQ(`C${i}`, "Extremely Long Derivation", "Ans", generateLongMath(55)));
                }

                return { questions, expandedDefault };
            }

            // --- RENDERING ---

            function render() {
                const type = paperSelect.value;
                const data = generatePaper(type);

                // Clear existing
                paperContainer.innerHTML = '';
                navList.innerHTML = '';
                mobileJump.innerHTML = '<option value="" disabled selected>Jump to Question...</option>';

                // Process function
                function processItem(item) {
                    if (item.type === 'section') {
                        // Render Section Header in Nav only (as separator)
                        const li = document.createElement('li');
                        li.className = 'nav-section-label';
                        li.textContent = item.label;
                        navList.appendChild(li);

                        // Optional: Section header in paper? Brief says "No artificial sectioning... beyond what exists".
                        // We will add a subtle spacer/header in paper to match original structure
                        const div = document.createElement('div');
                        div.style.cssText = "margin-top: 4rem; margin-bottom: 2rem; border-bottom: 1px solid #ddd; padding-bottom: 0.5rem; font-weight:bold; color:#666;";
                        div.textContent = item.label;
                        paperContainer.appendChild(div);
                        return;
                    }

                    // Render Question
                    const el = document.createElement('article');
                    el.className = `question-block nested-level-${item.level}`;
                    el.id = item.id;

                    // Diagram
                    const diagHTML = item.diag ? item.diag : '';

                    // State for button
                    const isExpanded = data.expandedDefault;
                    const btnText = isExpanded ? "Hide working" : "Show working";
                    const displayStyle = isExpanded ? "block" : "none";
                    const expandedClass = isExpanded ? "expanded" : "";

                    el.innerHTML = `
                        <div class="question-header">
                            <span class="q-number">${item.num}</span>
                            <div class="q-prompt">
                                <div>${item.text}</div>
                                ${diagHTML}
                            </div>
                        </div>
                        
                        <div class="answer-block">
                            <span class="answer-label">Answer</span>
                            <div class="answer-value">${item.ans}</div>
                        </div>

                        ${item.work ? `
                        <div class="working-container">
                            <button class="working-toggle" aria-expanded="${isExpanded}" aria-controls="work-${item.id}">
                                <span class="toggle-icon">${isExpanded ? '−' : '+'}</span>
                                <span class="toggle-text">${btnText}</span>
                            </button>
                            <div id="work-${item.id}" class="working-content ${expandedClass}" style="display: ${displayStyle}">
                                $$ ${item.work} $$
                            </div>
                        </div>
                        ` : ''}
                    `;

                    paperContainer.appendChild(el);

                    // Add to Nav
                    const navLi = document.createElement('li');
                    const navLink = document.createElement('a');
                    navLink.href = `#${item.id}`;
                    navLink.className = `nav-item ${item.level > 0 ? 'sub-item' : ''}`;
                    navLink.textContent = item.num;
                    navLink.onclick = (e) => {
                        e.preventDefault();
                        document.getElementById(item.id).scrollIntoView({ behavior: 'smooth' });
                    };
                    navLi.appendChild(navLink);
                    navList.appendChild(navLi);

                    // Add to Mobile Jump
                    const opt = document.createElement('option');
                    opt.value = item.id;
                    let prefix = "";
                    if (item.level > 0) prefix = "\u00A0\u00A0"; // Indent
                    if (item.level > 1) prefix = "\u00A0\u00A0\u00A0\u00A0";
                    opt.textContent = `${prefix}${item.num}`;
                    mobileJump.appendChild(opt);

                    // Process Subs
                    if (item.sub && item.sub.length > 0) {
                        item.sub.forEach(sub => processItem(sub));
                    }
                }

                data.questions.forEach(processItem);

                // Render KaTeX
                if (window.renderMathInElement) {
                    renderMathInElement(document.body, {
                        delimiters: [
                            { left: "$$", right: "$$", display: true },
                            { left: "$", right: "$", display: false }
                        ],
                        throwOnError: false
                    });
                }

                // Attach Event Listeners for Toggles (Delegation)
                // Note: We re-attach logic dynamically or just use global delegation below.
            }

            // Global Event Delegation for Toggles
            paperContainer.addEventListener('click', (e) => {
                const btn = e.target.closest('.working-toggle');
                if (!btn) return;

                const container = btn.parentElement;
                const content = container.querySelector('.working-content');
                const isExpanded = btn.getAttribute('aria-expanded') === 'true';

                if (isExpanded) {
                    // Collapse
                    content.style.display = 'none';
                    content.classList.remove('expanded');
                    btn.setAttribute('aria-expanded', 'false');
                    btn.querySelector('.toggle-text').textContent = "Show working";
                    btn.querySelector('.toggle-icon').textContent = "+";
                } else {
                    // Expand
                    content.style.display = 'block';
                    // Force reflow for animation
                    void content.offsetWidth;
                    content.classList.add('expanded');
                    btn.setAttribute('aria-expanded', 'true');
                    btn.querySelector('.toggle-text').textContent = "Hide working";
                    btn.querySelector('.toggle-icon').textContent = "−";
                }
            });

            // Mobile Jump Handler
            mobileJump.addEventListener('change', (e) => {
                if (e.target.value) {
                    const target = document.getElementById(e.target.value);
                    if (target) {
                        target.scrollIntoView({ behavior: 'smooth' });
                    }
                }
            });

            // Initial Render
            paperSelect.addEventListener('change', render);
            render(); // Boot
        });
    </script>
</body>

</html>

```